(()=>{var e={5265:function(e,t,r){"use strict";var n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const i=n(r(6917)),o=r(4570);function s(e,t,r){const n=new a(e,t,r);process.stdout.write(n.toString()+i.EOL)}t.issueCommand=s,t.issue=function(e,t=""){s(e,{},t)};class a{constructor(e,t,r){e||(e="missing.command"),this.command=e,this.properties=t,this.message=r}toString(){let e="::"+this.command;if(this.properties&&Object.keys(this.properties).length>0){e+=" ";let r=!0;for(const n in this.properties)if(this.properties.hasOwnProperty(n)){const i=this.properties[n];i&&(r?r=!1:e+=",",e+=`${n}=${t=i,o.toCommandValue(t).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A").replace(/:/g,"%3A").replace(/,/g,"%2C")}`)}}var t;return e+=`::${function(e){return o.toCommandValue(e).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A")}(this.message)}`,e}}},2225:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{f(n.next(e))}catch(e){o(e)}}function a(e){try{f(n.throw(e))}catch(e){o(e)}}function f(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}f((n=n.apply(e,t||[])).next())}))},i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const o=r(5265),s=r(3108),a=r(4570),f=i(r(6917)),u=i(r(6190));var c;function h(e){o.issue("error",e instanceof Error?e.toString():e)}function l(e){o.issue("group",e)}function p(){o.issue("endgroup")}!function(e){e[e.Success=0]="Success",e[e.Failure=1]="Failure"}(c=t.ExitCode||(t.ExitCode={})),t.exportVariable=function(e,t){const r=a.toCommandValue(t);if(process.env[e]=r,process.env.GITHUB_ENV){const t="_GitHubActionsFileCommandDelimeter_",n=`${e}<<${t}${f.EOL}${r}${f.EOL}${t}`;s.issueCommand("ENV",n)}else o.issueCommand("set-env",{name:e},r)},t.setSecret=function(e){o.issueCommand("add-mask",{},e)},t.addPath=function(e){process.env.GITHUB_PATH?s.issueCommand("PATH",e):o.issueCommand("add-path",{},e),process.env.PATH=`${e}${u.delimiter}${process.env.PATH}`},t.getInput=function(e,t){const r=process.env[`INPUT_${e.replace(/ /g,"_").toUpperCase()}`]||"";if(t&&t.required&&!r)throw new Error(`Input required and not supplied: ${e}`);return r.trim()},t.setOutput=function(e,t){o.issueCommand("set-output",{name:e},t)},t.setCommandEcho=function(e){o.issue("echo",e?"on":"off")},t.setFailed=function(e){process.exitCode=c.Failure,h(e)},t.isDebug=function(){return"1"===process.env.RUNNER_DEBUG},t.debug=function(e){o.issueCommand("debug",{},e)},t.error=h,t.warning=function(e){o.issue("warning",e instanceof Error?e.toString():e)},t.info=function(e){process.stdout.write(e+f.EOL)},t.startGroup=l,t.endGroup=p,t.group=function(e,t){return n(this,void 0,void 0,(function*(){let r;l(e);try{r=yield t()}finally{p()}return r}))},t.saveState=function(e,t){o.issueCommand("save-state",{name:e},t)},t.getState=function(e){return process.env[`STATE_${e}`]||""}},3108:function(e,t,r){"use strict";var n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const i=n(r(3015)),o=n(r(6917)),s=r(4570);t.issueCommand=function(e,t){const r=process.env[`GITHUB_${e}`];if(!r)throw new Error(`Unable to find environment variable for file command ${e}`);if(!i.existsSync(r))throw new Error(`Missing file at path: ${r}`);i.appendFileSync(r,`${s.toCommandValue(t)}${o.EOL}`,{encoding:"utf8"})}},4570:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toCommandValue=function(e){return null==e?"":"string"==typeof e||e instanceof String?e:JSON.stringify(e)}},3407:e=>{e.exports={newInvalidAsn1Error:function(e){var t=new Error;return t.name="InvalidAsn1Error",t.message=e||"",t}}},279:(e,t,r)=>{var n=r(3407),i=r(4478),o=r(4578),s=r(3609);for(var a in e.exports={Reader:o,Writer:s},i)i.hasOwnProperty(a)&&(e.exports[a]=i[a]);for(var f in n)n.hasOwnProperty(f)&&(e.exports[f]=n[f])},4578:(e,t,r)=>{var n=r(2137),i=r(2399).Buffer,o=r(4478),s=r(3407).newInvalidAsn1Error;function a(e){if(!e||!i.isBuffer(e))throw new TypeError("data must be a node Buffer");this._buf=e,this._size=e.length,this._len=0,this._offset=0}Object.defineProperty(a.prototype,"length",{enumerable:!0,get:function(){return this._len}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){return this._offset}}),Object.defineProperty(a.prototype,"remain",{get:function(){return this._size-this._offset}}),Object.defineProperty(a.prototype,"buffer",{get:function(){return this._buf.slice(this._offset)}}),a.prototype.readByte=function(e){if(this._size-this._offset<1)return null;var t=255&this._buf[this._offset];return e||(this._offset+=1),t},a.prototype.peek=function(){return this.readByte(!0)},a.prototype.readLength=function(e){if(void 0===e&&(e=this._offset),e>=this._size)return null;var t=255&this._buf[e++];if(null===t)return null;if(128==(128&t)){if(0==(t&=127))throw s("Indefinite length not supported");if(t>4)throw s("encoding too long");if(this._size-e<t)return null;this._len=0;for(var r=0;r<t;r++)this._len=(this._len<<8)+(255&this._buf[e++])}else this._len=t;return e},a.prototype.readSequence=function(e){var t=this.peek();if(null===t)return null;if(void 0!==e&&e!==t)throw s("Expected 0x"+e.toString(16)+": got 0x"+t.toString(16));var r=this.readLength(this._offset+1);return null===r?null:(this._offset=r,t)},a.prototype.readInt=function(){return this._readTag(o.Integer)},a.prototype.readBoolean=function(){return 0!==this._readTag(o.Boolean)},a.prototype.readEnumeration=function(){return this._readTag(o.Enumeration)},a.prototype.readString=function(e,t){e||(e=o.OctetString);var r=this.peek();if(null===r)return null;if(r!==e)throw s("Expected 0x"+e.toString(16)+": got 0x"+r.toString(16));var n=this.readLength(this._offset+1);if(null===n)return null;if(this.length>this._size-n)return null;if(this._offset=n,0===this.length)return t?i.alloc(0):"";var a=this._buf.slice(this._offset,this._offset+this.length);return this._offset+=this.length,t?a:a.toString("utf8")},a.prototype.readOID=function(e){e||(e=o.OID);var t=this.readString(e,!0);if(null===t)return null;for(var r=[],n=0,i=0;i<t.length;i++){var s=255&t[i];n<<=7,n+=127&s,0==(128&s)&&(r.push(n),n=0)}return n=r.shift(),r.unshift(n%40),r.unshift(n/40>>0),r.join(".")},a.prototype._readTag=function(e){n.ok(void 0!==e);var t=this.peek();if(null===t)return null;if(t!==e)throw s("Expected 0x"+e.toString(16)+": got 0x"+t.toString(16));var r=this.readLength(this._offset+1);if(null===r)return null;if(this.length>4)throw s("Integer too long: "+this.length);if(this.length>this._size-r)return null;this._offset=r;for(var i=this._buf[this._offset],o=0,a=0;a<this.length;a++)o<<=8,o|=255&this._buf[this._offset++];return 128==(128&i)&&4!==a&&(o-=1<<8*a),o>>0},e.exports=a},4478:e=>{e.exports={EOC:0,Boolean:1,Integer:2,BitString:3,OctetString:4,Null:5,OID:6,ObjectDescriptor:7,External:8,Real:9,Enumeration:10,PDV:11,Utf8String:12,RelativeOID:13,Sequence:16,Set:17,NumericString:18,PrintableString:19,T61String:20,VideotexString:21,IA5String:22,UTCTime:23,GeneralizedTime:24,GraphicString:25,VisibleString:26,GeneralString:28,UniversalString:29,CharacterString:30,BMPString:31,Constructor:32,Context:128}},3609:(e,t,r)=>{var n=r(2137),i=r(2399).Buffer,o=r(4478),s=r(3407).newInvalidAsn1Error,a={size:1024,growthFactor:8};function f(e){var t,r;t=a,r=e||{},n.ok(t),n.equal(typeof t,"object"),n.ok(r),n.equal(typeof r,"object"),Object.getOwnPropertyNames(t).forEach((function(e){if(!r[e]){var n=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(r,e,n)}})),e=r,this._buf=i.alloc(e.size||1024),this._size=this._buf.length,this._offset=0,this._options=e,this._seq=[]}Object.defineProperty(f.prototype,"buffer",{get:function(){if(this._seq.length)throw s(this._seq.length+" unended sequence(s)");return this._buf.slice(0,this._offset)}}),f.prototype.writeByte=function(e){if("number"!=typeof e)throw new TypeError("argument must be a Number");this._ensure(1),this._buf[this._offset++]=e},f.prototype.writeInt=function(e,t){if("number"!=typeof e)throw new TypeError("argument must be a Number");"number"!=typeof t&&(t=o.Integer);for(var r=4;(0==(4286578688&e)||-8388608==(4286578688&e))&&r>1;)r--,e<<=8;if(r>4)throw s("BER ints cannot be > 0xffffffff");for(this._ensure(2+r),this._buf[this._offset++]=t,this._buf[this._offset++]=r;r-- >0;)this._buf[this._offset++]=(4278190080&e)>>>24,e<<=8},f.prototype.writeNull=function(){this.writeByte(o.Null),this.writeByte(0)},f.prototype.writeEnumeration=function(e,t){if("number"!=typeof e)throw new TypeError("argument must be a Number");return"number"!=typeof t&&(t=o.Enumeration),this.writeInt(e,t)},f.prototype.writeBoolean=function(e,t){if("boolean"!=typeof e)throw new TypeError("argument must be a Boolean");"number"!=typeof t&&(t=o.Boolean),this._ensure(3),this._buf[this._offset++]=t,this._buf[this._offset++]=1,this._buf[this._offset++]=e?255:0},f.prototype.writeString=function(e,t){if("string"!=typeof e)throw new TypeError("argument must be a string (was: "+typeof e+")");"number"!=typeof t&&(t=o.OctetString);var r=i.byteLength(e);this.writeByte(t),this.writeLength(r),r&&(this._ensure(r),this._buf.write(e,this._offset),this._offset+=r)},f.prototype.writeBuffer=function(e,t){if("number"!=typeof t)throw new TypeError("tag must be a number");if(!i.isBuffer(e))throw new TypeError("argument must be a buffer");this.writeByte(t),this.writeLength(e.length),this._ensure(e.length),e.copy(this._buf,this._offset,0,e.length),this._offset+=e.length},f.prototype.writeStringArray=function(e){if(!e instanceof Array)throw new TypeError("argument must be an Array[String]");var t=this;e.forEach((function(e){t.writeString(e)}))},f.prototype.writeOID=function(e,t){if("string"!=typeof e)throw new TypeError("argument must be a string");if("number"!=typeof t&&(t=o.OID),!/^([0-9]+\.){3,}[0-9]+$/.test(e))throw new Error("argument is not a valid OID string");var r=e.split("."),n=[];n.push(40*parseInt(r[0],10)+parseInt(r[1],10)),r.slice(2).forEach((function(e){!function(e,t){t<128?e.push(t):t<16384?(e.push(t>>>7|128),e.push(127&t)):t<2097152?(e.push(t>>>14|128),e.push(255&(t>>>7|128)),e.push(127&t)):t<268435456?(e.push(t>>>21|128),e.push(255&(t>>>14|128)),e.push(255&(t>>>7|128)),e.push(127&t)):(e.push(255&(t>>>28|128)),e.push(255&(t>>>21|128)),e.push(255&(t>>>14|128)),e.push(255&(t>>>7|128)),e.push(127&t))}(n,parseInt(e,10))}));var i=this;this._ensure(2+n.length),this.writeByte(t),this.writeLength(n.length),n.forEach((function(e){i.writeByte(e)}))},f.prototype.writeLength=function(e){if("number"!=typeof e)throw new TypeError("argument must be a Number");if(this._ensure(4),e<=127)this._buf[this._offset++]=e;else if(e<=255)this._buf[this._offset++]=129,this._buf[this._offset++]=e;else if(e<=65535)this._buf[this._offset++]=130,this._buf[this._offset++]=e>>8,this._buf[this._offset++]=e;else{if(!(e<=16777215))throw s("Length too long (> 4 bytes)");this._buf[this._offset++]=131,this._buf[this._offset++]=e>>16,this._buf[this._offset++]=e>>8,this._buf[this._offset++]=e}},f.prototype.startSequence=function(e){"number"!=typeof e&&(e=o.Sequence|o.Constructor),this.writeByte(e),this._seq.push(this._offset),this._ensure(3),this._offset+=3},f.prototype.endSequence=function(){var e=this._seq.pop(),t=e+3,r=this._offset-t;if(r<=127)this._shift(t,r,-2),this._buf[e]=r;else if(r<=255)this._shift(t,r,-1),this._buf[e]=129,this._buf[e+1]=r;else if(r<=65535)this._buf[e]=130,this._buf[e+1]=r>>8,this._buf[e+2]=r;else{if(!(r<=16777215))throw s("Sequence too long");this._shift(t,r,1),this._buf[e]=131,this._buf[e+1]=r>>16,this._buf[e+2]=r>>8,this._buf[e+3]=r}},f.prototype._shift=function(e,t,r){n.ok(void 0!==e),n.ok(void 0!==t),n.ok(r),this._buf.copy(this._buf,e+r,e,e+t),this._offset+=r},f.prototype._ensure=function(e){if(n.ok(e),this._size-this._offset<e){var t=this._size*this._options.growthFactor;t-this._offset<e&&(t+=e);var r=i.alloc(t);this._buf.copy(r,0,0,this._offset),this._buf=r,this._size=t}},e.exports=f},476:(e,t,r)=>{var n=r(279);e.exports={Ber:n,BerReader:n.Reader,BerWriter:n.Writer}},2703:(e,t,r)=>{"use strict";var n=r(780).lowlevel.crypto_hash,i=0,o=function(){this.S=[new Uint32Array([3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946]),new Uint32Array([1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055]),new Uint32Array([3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504]),new Uint32Array([976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462])],this.P=new Uint32Array([608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731])};function s(e,t,r){return(e[0][t[r+3]]+e[1][t[r+2]]^e[2][t[r+1]])+e[3][t[r]]}function a(e,t){var r,n=0;for(r=0;r<4;r++,i++)i>=t&&(i=0),n=n<<8|e[i];return n}function f(e,t,r){var n,i=new o,s=new Uint32Array(8),f=new Uint8Array([79,120,121,99,104,114,111,109,97,116,105,99,66,108,111,119,102,105,115,104,83,119,97,116,68,121,110,97,109,105,116,101]);for(i.expandstate(t,64,e,64),n=0;n<64;n++)i.expand0state(t,64),i.expand0state(e,64);for(n=0;n<8;n++)s[n]=a(f,f.byteLength);for(n=0;n<64;n++)i.enc(s,s.byteLength/8);for(n=0;n<8;n++)r[4*n+3]=s[n]>>>24,r[4*n+2]=s[n]>>>16,r[4*n+1]=s[n]>>>8,r[4*n+0]=s[n]}o.prototype.encipher=function(e,t){void 0===t&&(t=new Uint8Array(e.buffer),0!==e.byteOffset&&(t=t.subarray(e.byteOffset))),e[0]^=this.P[0];for(var r=1;r<16;r+=2)e[1]^=s(this.S,t,0)^this.P[r],e[0]^=s(this.S,t,4)^this.P[r+1];var n=e[0];e[0]=e[1]^this.P[17],e[1]=n},o.prototype.decipher=function(e){var t=new Uint8Array(e.buffer);0!==e.byteOffset&&(t=t.subarray(e.byteOffset)),e[0]^=this.P[17];for(var r=16;r>0;r-=2)e[1]^=s(this.S,t,0)^this.P[r],e[0]^=s(this.S,t,4)^this.P[r-1];var n=e[0];e[0]=e[1]^this.P[0],e[1]=n},o.prototype.expand0state=function(e,t){var r,n,o=new Uint32Array(2),s=new Uint8Array(o.buffer);for(r=0,i=0;r<18;r++)this.P[r]^=a(e,t);for(i=0,r=0;r<18;r+=2)this.encipher(o,s),this.P[r]=o[0],this.P[r+1]=o[1];for(r=0;r<4;r++)for(n=0;n<256;n+=2)this.encipher(o,s),this.S[r][n]=o[0],this.S[r][n+1]=o[1]},o.prototype.expandstate=function(e,t,r,n){var o,s,f=new Uint32Array(2);for(o=0,i=0;o<18;o++)this.P[o]^=a(r,n);for(o=0,i=0;o<18;o+=2)f[0]^=a(e,t),f[1]^=a(e,t),this.encipher(f),this.P[o]=f[0],this.P[o+1]=f[1];for(o=0;o<4;o++)for(s=0;s<256;s+=2)f[0]^=a(e,t),f[1]^=a(e,t),this.encipher(f),this.S[o][s]=f[0],this.S[o][s+1]=f[1];i=0},o.prototype.enc=function(e,t){for(var r=0;r<t;r++)this.encipher(e.subarray(2*r))},o.prototype.dec=function(e,t){for(var r=0;r<t;r++)this.decipher(e.subarray(2*r))},e.exports={BLOCKS:8,HASHSIZE:32,hash:f,pbkdf:function(e,t,r,i,o,s,a){var u,c,h,l,p,d,E=new Uint8Array(64),g=new Uint8Array(64),m=new Uint8Array(32),v=new Uint8Array(32),y=new Uint8Array(i+4),_=s;if(a<1)return-1;if(0===t||0===i||0===s||s>m.byteLength*m.byteLength||i>1<<20)return-1;for(l=Math.floor((s+m.byteLength-1)/m.byteLength),h=Math.floor((s+l-1)/l),u=0;u<i;u++)y[u]=r[u];for(n(E,e,t),d=1;s>0;d++){for(y[i+0]=d>>>24,y[i+1]=d>>>16,y[i+2]=d>>>8,y[i+3]=d,n(g,y,i+4),f(E,g,v),u=m.byteLength;u--;)m[u]=v[u];for(u=1;u<a;u++)for(n(g,v,v.byteLength),f(E,g,v),c=0;c<m.byteLength;c++)m[c]^=v[c];for(h=Math.min(h,s),u=0;u<h&&!((p=u*l+(d-1))>=_);u++)o[p]=m[u];s-=u}return 0}}},7187:e=>{"use strict";var t,r="object"==typeof Reflect?Reflect:null,n=r&&"function"==typeof r.apply?r.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};t=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!=e};function o(){o.init.call(this)}e.exports=o,e.exports.once=function(e,t){return new Promise((function(r,n){function i(r){e.removeListener(t,o),n(r)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),r([].slice.call(arguments))}E(e,t,o,{once:!0}),"error"!==t&&function(e,t,r){"function"==typeof e.on&&E(e,"error",t,{once:!0})}(e,i)}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var s=10;function a(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function f(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function u(e,t,r,n){var i,o,s,u;if(a(r),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),s=o[t]),void 0===s)s=o[t]=r,++e._eventsCount;else if("function"==typeof s?s=o[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),(i=f(e))>0&&s.length>i&&!s.warned){s.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=s.length,u=c,console&&console.warn&&console.warn(u)}return e}function c(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=c.bind(n);return i.listener=r,n.wrapFn=i,i}function l(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(i):d(i,i.length)}function p(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function d(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function E(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){n.once&&e.removeEventListener(t,i),r(o)}))}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return f(this)},o.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var i="error"===e,o=this._events;if(void 0!==o)i=i&&void 0===o.error;else if(!i)return!1;if(i){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var f=o[e];if(void 0===f)return!1;if("function"==typeof f)n(f,this,t);else{var u=f.length,c=d(f,u);for(r=0;r<u;++r)n(c[r],this,t)}return!0},o.prototype.addListener=function(e,t){return u(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return u(this,e,t,!0)},o.prototype.once=function(e,t){return a(t),this.on(e,h(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,h(this,e,t)),this},o.prototype.removeListener=function(e,t){var r,n,i,o,s;if(a(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===t||r[o].listener===t){s=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var i,o=Object.keys(r);for(n=0;n<o.length;++n)"removeListener"!==(i=o[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},o.prototype.listeners=function(e){return l(this,e,!0)},o.prototype.rawListeners=function(e){return l(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},o.prototype.listenerCount=p,o.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},789:(e,t,r)=>{"use strict";const n=r(1247),i=r(7276),{promisify:o}=r(1377),s=r(6625).satisfies(process.version,">=10.12.0"),a=e=>{if("win32"===process.platform&&/[<>:"|?*]/.test(e.replace(i.parse(e).root,""))){const t=new Error(`Path contains invalid characters: ${e}`);throw t.code="EINVAL",t}},f=e=>({mode:511,fs:n,...e}),u=e=>{const t=new Error(`operation not permitted, mkdir '${e}'`);return t.code="EPERM",t.errno=-4048,t.path=e,t.syscall="mkdir",t};e.exports=async(e,t)=>{a(e),t=f(t);const r=o(t.fs.mkdir),c=o(t.fs.stat);if(s&&t.fs.mkdir===n.mkdir){const n=i.resolve(e);return await r(n,{mode:t.mode,recursive:!0}),n}const h=async e=>{try{return await r(e,t.mode),e}catch(t){if("EPERM"===t.code)throw t;if("ENOENT"===t.code){if(i.dirname(e)===e)throw u(e);if(t.message.includes("null bytes"))throw t;return await h(i.dirname(e)),h(e)}try{if(!(await c(e)).isDirectory())throw new Error("The path is not a directory")}catch(e){throw t}return e}};return h(i.resolve(e))},e.exports.sync=(e,t)=>{if(a(e),t=f(t),s&&t.fs.mkdirSync===n.mkdirSync){const r=i.resolve(e);return n.mkdirSync(r,{mode:t.mode,recursive:!0}),r}const r=e=>{try{t.fs.mkdirSync(e,t.mode)}catch(n){if("EPERM"===n.code)throw n;if("ENOENT"===n.code){if(i.dirname(e)===e)throw u(e);if(n.message.includes("null bytes"))throw n;return r(i.dirname(e)),r(e)}try{if(!t.fs.statSync(e).isDirectory())throw new Error("The path is not a directory")}catch(e){throw n}}return e};return r(i.resolve(e))}},7921:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.NodeSSH=t.SSHError=void 0;const a=s(r(5046)),f=s(r(8086)),u=s(r(789)),c=s(r(2995)),h=s(r(1889)),l=r(9612),p=o(r(527)),d=s(r(2353)),E=e=>!f.default.basename(e).startsWith("."),g=()=>{};class m extends Error{constructor(e,t=null){super(e),this.code=t}}function v(e){return e.includes("\\")?e.split("\\").join("/"):e}t.SSHError=m;const y=/Error: (E[\S]+): /;t.NodeSSH=class{constructor(){this.connection=null}getConnection(){const{connection:e}=this;if(null==e)throw new Error("Not connected to server");return e}async connect(e){p.default(null!=e&&"object"==typeof e,"config must be a valid object");const t={...e};if(p.default(null!=t.username&&"string"==typeof t.username,"config.username must be a valid string"),null!=t.host)p.default("string"==typeof t.host,"config.host must be a valid string");else{if(null==t.sock)throw new p.AssertionError({message:"Either config.host or config.sock must be provided"});p.default("object"==typeof t.sock,"config.sock must be a valid object")}if(null!=t.privateKey){if(p.default("string"==typeof t.privateKey,"config.privateKey must be a valid string"),p.default(null==t.passphrase||"string"==typeof t.passphrase,"config.passphrase must be a valid string"),!(t.privateKey.includes("BEGIN")&&t.privateKey.includes("KEY")||t.privateKey.includes("PuTTY-User-Key-File-2")))try{t.privateKey=await async function(e){return new Promise(((t,r)=>{a.default.readFile(e,"utf8",((e,n)=>{e?r(e):t(n)}))}))}(t.privateKey)}catch(e){if(null!=e&&"ENOENT"===e.code)throw new p.AssertionError({message:"config.privateKey does not exist at given fs path"});throw e}}else null!=t.password&&p.default("string"==typeof t.password,"config.password must be a valid string");if(null!=t.tryKeyboard&&p.default("boolean"==typeof t.tryKeyboard,"config.tryKeyboard must be a valid boolean"),t.tryKeyboard){const{password:e}=t;null!=t.onKeyboardInteractive?p.default("function"==typeof t.onKeyboardInteractive,"config.onKeyboardInteractive must be a valid function"):null!=e&&(t.onKeyboardInteractive=(t,r,n,i,o)=>{i.length>0&&i[0].prompt.toLowerCase().includes("password")&&o([e])})}const r=new d.default.Client;return this.connection=r,await new Promise(((e,n)=>{r.on("error",n),t.onKeyboardInteractive&&r.on("keyboard-interactive",t.onKeyboardInteractive),r.on("ready",(()=>{r.removeListener("error",n),e()})),r.on("end",(()=>{this.connection===r&&(this.connection=null)})),r.on("close",(()=>{this.connection===r&&(this.connection=null),n(new m("No response from server","ETIMEDOUT"))})),r.connect(t)})),this}isConnected(){return null!=this.connection}async requestShell(e){const t=this.getConnection();return new Promise(((r,n)=>{const i=(e,t)=>{e?n(e):r(t)};null==e?t.shell(i):t.shell(e,i)}))}async withShell(e,t){p.default("function"==typeof e,"callback must be a valid function");const r=await this.requestShell(t);try{await e(r)}finally{r.close()||r.destroy()}}async requestSFTP(){const e=this.getConnection();return new Promise(((t,r)=>{e.sftp(((e,n)=>{e?r(e):t(n)}))}))}async withSFTP(e){p.default("function"==typeof e,"callback must be a valid function");const t=await this.requestSFTP();try{await e(t)}finally{t.end()}}async execCommand(e,t={}){p.default("string"==typeof e,"command must be a valid string"),p.default(null!=t&&"object"==typeof t,"options must be a valid object"),p.default(null==t.cwd||"string"==typeof t.cwd,"options.cwd must be a valid string"),p.default(null==t.stdin||"string"==typeof t.stdin,"options.stdin must be a valid string"),p.default(null==t.execOptions||"object"==typeof t.execOptions,"options.execOptions must be a valid object"),p.default(null==t.encoding||"string"==typeof t.encoding,"options.encoding must be a valid string"),p.default(null==t.onChannel||"function"==typeof t.onChannel,"options.onChannel must be a valid function"),p.default(null==t.onStdout||"function"==typeof t.onStdout,"options.onStdout must be a valid function"),p.default(null==t.onStderr||"function"==typeof t.onStderr,"options.onStderr must be a valid function");let r=e;t.cwd&&(r=`cd ${c.default([t.cwd])} ; ${r}`);const n=this.getConnection(),i={stdout:[],stderr:[]};return new Promise(((e,o)=>{n.exec(r,null!=t.execOptions?t.execOptions:{},((r,n)=>{if(r)return void o(r);t.onChannel&&t.onChannel(n),n.on("data",(e=>{t.onStdout&&t.onStdout(e),i.stdout.push(e.toString(t.encoding))})),n.stderr.on("data",(e=>{t.onStderr&&t.onStderr(e),i.stderr.push(e.toString(t.encoding))})),t.stdin&&n.write(t.stdin),n.end();let s=null,a=null;n.on("exit",((e,t)=>{s=e||null,a=t||null})),n.on("close",(()=>{e({code:null!=s?s:null,signal:null!=a?a:null,stdout:i.stdout.join("").trim(),stderr:i.stderr.join("").trim()})}))}))}))}async exec(e,t,r={}){p.default("string"==typeof e,"command must be a valid string"),p.default(Array.isArray(t),"parameters must be a valid array"),p.default(null!=r&&"object"==typeof r,"options must be a valid object"),p.default(null==r.stream||["both","stdout","stderr"].includes(r.stream),"options.stream must be one of both, stdout, stderr");for(let e=0,{length:r}=t;e<r;e+=1)p.default("string"==typeof t[e],`parameters[${e}] must be a valid string`);const n=`${e} ${c.default(t)}`,i=await this.execCommand(n,r);if(null==r.stream||"stdout"===r.stream){if(i.stderr)throw new Error(i.stderr);return i.stdout}return"stderr"===r.stream?i.stderr:i}async mkdir(e,t="sftp",r=null){if(p.default("string"==typeof e,"path must be a valid string"),p.default("string"==typeof t&&("sftp"===t||"exec"===t),"method must be either sftp or exec"),p.default(null==r||"object"==typeof r,"sftp must be a valid object"),"exec"===t)return void await this.exec("mkdir",["-p",v(e)]);const n=r||await this.requestSFTP(),i=async t=>async function(e,t){let r=null;try{r=await new Promise(((r,n)=>{t.stat(e,((e,t)=>{e?n(e):r(t)}))}))}catch(e){}if(r){if(r.isDirectory())return;throw new Error("mkdir() failed, target already exists and is not a directory")}try{await new Promise(((r,n)=>{t.mkdir(e,(e=>{e?n(e):r()}))}))}catch(e){if(null!=e&&"string"==typeof e.stack){const t=y.exec(e.stack);if(null!=t)throw new m(e.message,t[1]);throw e}}}(v(e),n).catch((async r=>{if(!t||null==r||"No such file"!==r.message&&"ENOENT"!==r.code)throw r;await this.mkdir(f.default.dirname(e),"sftp",n),await i(!1)}));try{await i(!0)}finally{r||n.end()}}async getFile(e,t,r=null,n=null){p.default("string"==typeof e,"localFile must be a valid string"),p.default("string"==typeof t,"remoteFile must be a valid string"),p.default(null==r||"object"==typeof r,"sftp must be a valid object"),p.default(null==n||"object"==typeof n,"transferOptions must be a valid object");const i=r||await this.requestSFTP();try{await new Promise(((r,o)=>{i.fastGet(v(t),e,n||{},(e=>{e?o(e):r()}))}))}finally{r||i.end()}}async putFile(e,t,r=null,n=null){p.default("string"==typeof e,"localFile must be a valid string"),p.default("string"==typeof t,"remoteFile must be a valid string"),p.default(null==r||"object"==typeof r,"sftp must be a valid object"),p.default(null==n||"object"==typeof n,"transferOptions must be a valid object"),p.default(await new Promise((t=>{a.default.access(e,a.default.constants.R_OK,(e=>{t(null===e)}))})),`localFile does not exist at ${e}`);const i=r||await this.requestSFTP(),o=r=>new Promise(((s,a)=>{i.fastPut(e,v(t),n||{},(e=>{null!=e?"No such file"===e.message&&r?s(this.mkdir(f.default.dirname(t),"sftp",i).then((()=>o(!1)))):a(e):s()}))}));try{await o(!0)}finally{r||i.end()}}async putFiles(e,{concurrency:t=1,sftp:r=null,transferOptions:n={}}={}){p.default(Array.isArray(e),"files must be an array");for(let t=0,{length:r}=e;t<r;t+=1){const r=e[t];p.default(r,"files items must be valid objects"),p.default(r.local&&"string"==typeof r.local,`files[${t}].local must be a string`),p.default(r.remote&&"string"==typeof r.remote,`files[${t}].remote must be a string`)}const i=[],o=r||await this.requestSFTP(),s=new l.PromiseQueue({concurrency:t});try{await new Promise(((t,r)=>{e.forEach((e=>{s.add((async()=>{await this.putFile(e.local,e.remote,o,n),i.push(e)})).catch(r)})),s.waitTillIdle().then(t)}))}catch(e){throw null!=e&&(e.transferred=i),e}finally{r||o.end()}}async putDirectory(e,t,{concurrency:r=1,sftp:n=null,transferOptions:i={},recursive:o=!0,tick:s=g,validate:u=E}={}){p.default("string"==typeof e&&e,"localDirectory must be a string"),p.default("string"==typeof t&&t,"remoteDirectory must be a string");const c=await new Promise((t=>{a.default.stat(e,((e,r)=>{t(r||null)}))}));p.default(null!=c,`localDirectory does not exist at ${e}`),p.default(c.isDirectory(),`localDirectory is not a directory at ${e}`);const d=n||await this.requestSFTP(),m=await h.default(e,{recursive:o,validate:u}),v=m.files.map((t=>f.default.relative(e,t))),y=m.directories.map((t=>f.default.relative(e,t)));y.sort(((e,t)=>e.length-t.length));let _=!1;try{await new Promise(((e,n)=>{const i=new l.PromiseQueue({concurrency:r});y.forEach((e=>{i.add((async()=>{await this.mkdir(f.default.join(t,e),"sftp",d)})).catch(n)})),e(i.waitTillIdle())})),await new Promise(((n,o)=>{const a=new l.PromiseQueue({concurrency:r});v.forEach((r=>{a.add((async()=>{const n=f.default.join(e,r),o=f.default.join(t,r);try{await this.putFile(n,o,d,i),s(n,o,null)}catch(e){_=!0,s(n,o,e)}})).catch(o)})),n(a.waitTillIdle())}))}finally{n||d.end()}return!_}async getDirectory(e,t,{concurrency:r=1,sftp:n=null,transferOptions:i={},recursive:o=!0,tick:s=g,validate:c=E}={}){p.default("string"==typeof e&&e,"localDirectory must be a string"),p.default("string"==typeof t&&t,"remoteDirectory must be a string");const d=await new Promise((t=>{a.default.stat(e,((e,r)=>{t(r||null)}))}));p.default(null!=d,`localDirectory does not exist at ${e}`),p.default(d.isDirectory(),`localDirectory is not a directory at ${e}`);const m=n||await this.requestSFTP(),v=await h.default(t,{recursive:o,validate:c,concurrency:r,fileSystem:{basename:e=>f.default.posix.basename(e),join:(e,t)=>f.default.posix.join(e,t),readdir:e=>new Promise(((t,r)=>{m.readdir(e,((e,n)=>{e?r(e):t(n.map((e=>e.filename)))}))})),stat:e=>new Promise(((t,r)=>{m.stat(e,((e,n)=>{e?r(e):t(n)}))}))}}),y=v.files.map((e=>f.default.relative(t,e))),_=v.directories.map((e=>f.default.relative(t,e)));_.sort(((e,t)=>e.length-t.length));let w=!1;try{await new Promise(((t,n)=>{const i=new l.PromiseQueue({concurrency:r});_.forEach((t=>{i.add((async()=>{await u.default(f.default.join(e,t))})).catch(n)})),t(i.waitTillIdle())})),await new Promise(((n,o)=>{const a=new l.PromiseQueue({concurrency:r});y.forEach((r=>{a.add((async()=>{const n=f.default.join(e,r),o=f.default.join(t,r);try{await this.getFile(n,o,m,i),s(n,o,null)}catch(e){w=!0,s(n,o,e)}})).catch(o)})),n(a.waitTillIdle())}))}finally{n||m.end()}return!w}dispose(){this.connection&&(this.connection.end(),this.connection=null)}}},2399:(e,t,r)=>{"use strict";var n,i=r(4029),o=i.Buffer,s={};for(n in i)i.hasOwnProperty(n)&&"SlowBuffer"!==n&&"Buffer"!==n&&(s[n]=i[n]);var a=s.Buffer={};for(n in o)o.hasOwnProperty(n)&&"allocUnsafe"!==n&&"allocUnsafeSlow"!==n&&(a[n]=o[n]);if(s.Buffer.prototype=o.prototype,a.from&&a.from!==Uint8Array.from||(a.from=function(e,t,r){if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type '+typeof e);if(e&&void 0===e.length)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);return o(e,t,r)}),a.alloc||(a.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError('The "size" argument must be of type number. Received type '+typeof e);if(e<0||e>=2*(1<<30))throw new RangeError('The value "'+e+'" is invalid for option "size"');var n=o(e);return t&&0!==t.length?"string"==typeof r?n.fill(t,r):n.fill(t):n.fill(0),n}),!s.kStringMaxLength)try{s.kStringMaxLength=process.binding("buffer").kStringMaxLength}catch(e){}s.constants||(s.constants={MAX_LENGTH:s.kMaxLength},s.kStringMaxLength&&(s.constants.MAX_STRING_LENGTH=s.kStringMaxLength)),e.exports=s},9612:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){var t=(void 0===e?{}:e).concurrency,r=void 0===t?1:t;this.options={concurrency:r},this.running=0,this.queue=[],this.idleCallbacks=[]}return e.prototype.clear=function(){this.queue=[]},e.prototype.onIdle=function(e){var t=this;return this.idleCallbacks.push(e),function(){var r=t.idleCallbacks.indexOf(e);-1!==r&&t.idleCallbacks.splice(r,1)}},e.prototype.waitTillIdle=function(){var e=this;return new Promise((function(t){if(0!==e.running)var r=e.onIdle((function(){r(),t()}));else t()}))},e.prototype.add=function(e){var t=this;return new Promise((function(r,n){var i=function(){t.running+=1;try{Promise.resolve(e()).then((function(e){r(e),t.processNext()}),(function(e){n(e),t.processNext()}))}catch(e){n(e),t.processNext()}};t.running>=t.options.concurrency?t.queue.push(i):i()}))},e.prototype.processNext=function(){this.running-=1;var e=this.queue.shift();e?e():0===this.running&&this.idleCallbacks.forEach((function(e){return e()}))},e}();t.PromiseQueue=r},1889:function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},i=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{f(n.next(e))}catch(e){o(e)}}function a(e){try{f(n.throw(e))}catch(e){o(e)}}function f(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}f((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.defaultFilesystem=void 0;var a=s(r(2276)),f=s(r(7473)),u=s(r(3854)),c=r(9612);function h(e){var t=e.path,r=e.recursive,n=e.validate,s=e.result,a=e.fileSystem,f=e.queue,u=e.reject;return i(this,void 0,void 0,(function(){var e;return o(this,(function(i){switch(i.label){case 0:return[4,a.stat(t)];case 1:return(e=i.sent()).isFile()?s.files.push(t):e.isDirectory()&&s.directories.push(t),e.isDirectory()&&"none"!==r?[4,a.readdir(t)]:[2];case 2:return i.sent().forEach((function(e){var i=a.join(t,e);n(i)&&f.add((function(){return h({path:i,recursive:"shallow"===r?"none":"deep",validate:n,result:s,fileSystem:a,queue:f,reject:u})})).catch(u)})),[2]}}))}))}t.defaultFilesystem={join:function(e,t){return f.default.join(e,t)},basename:function(e){return f.default.basename(e)},stat:function(e){return new Promise((function(t,r){a.default.stat(e,(function(e,n){e?r(e):t(n)}))}))},readdir:function(e){return new Promise((function(t,r){a.default.readdir(e,(function(e,n){e?r(e):t(n)}))}))}},t.default=function(e,r){var s=void 0===r?{}:r,a=s.recursive,f=void 0===a||a,l=s.validate,p=void 0===l?null:l,d=s.concurrency,E=void 0===d?1/0:d,g=s.fileSystem,m=void 0===g?t.defaultFilesystem:g;return i(this,void 0,void 0,(function(){var r,i,s;return o(this,(function(o){switch(o.label){case 0:return u.default(e&&"string"==typeof e,"path must be a valid string"),u.default("boolean"==typeof f,"options.recursive must be a valid boolean"),u.default(null===p||"function"==typeof p,"options.validate must be a valid function"),u.default("number"==typeof E,"options.concurrency must be a valid number"),u.default(null!==m&&"object"==typeof m,"options.fileSystem must be a valid object"),r=new c.PromiseQueue({concurrency:E}),i={files:[],directories:[]},s=n(n({},t.defaultFilesystem),m),[4,new Promise((function(t,n){h({path:e,recursive:f?"deep":"shallow",validate:null!=p?p:function(e){return"."!==s.basename(e).slice(0,1)},result:i,fileSystem:s,queue:r,reject:n}).then((function(){return r.waitTillIdle()})).then(t,n)}))];case 1:return o.sent(),[2,i]}}))}))}},6625:(e,t)=>{var r;t=e.exports=h,r="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?function(){var e=Array.prototype.slice.call(arguments,0);e.unshift("SEMVER"),console.log.apply(console,e)}:function(){},t.SEMVER_SPEC_VERSION="2.0.0";var n=Number.MAX_SAFE_INTEGER||9007199254740991,i=t.re=[],o=t.src=[],s=t.tokens={},a=0;function f(e){s[e]=a++}f("NUMERICIDENTIFIER"),o[s.NUMERICIDENTIFIER]="0|[1-9]\\d*",f("NUMERICIDENTIFIERLOOSE"),o[s.NUMERICIDENTIFIERLOOSE]="[0-9]+",f("NONNUMERICIDENTIFIER"),o[s.NONNUMERICIDENTIFIER]="\\d*[a-zA-Z-][a-zA-Z0-9-]*",f("MAINVERSION"),o[s.MAINVERSION]="("+o[s.NUMERICIDENTIFIER]+")\\.("+o[s.NUMERICIDENTIFIER]+")\\.("+o[s.NUMERICIDENTIFIER]+")",f("MAINVERSIONLOOSE"),o[s.MAINVERSIONLOOSE]="("+o[s.NUMERICIDENTIFIERLOOSE]+")\\.("+o[s.NUMERICIDENTIFIERLOOSE]+")\\.("+o[s.NUMERICIDENTIFIERLOOSE]+")",f("PRERELEASEIDENTIFIER"),o[s.PRERELEASEIDENTIFIER]="(?:"+o[s.NUMERICIDENTIFIER]+"|"+o[s.NONNUMERICIDENTIFIER]+")",f("PRERELEASEIDENTIFIERLOOSE"),o[s.PRERELEASEIDENTIFIERLOOSE]="(?:"+o[s.NUMERICIDENTIFIERLOOSE]+"|"+o[s.NONNUMERICIDENTIFIER]+")",f("PRERELEASE"),o[s.PRERELEASE]="(?:-("+o[s.PRERELEASEIDENTIFIER]+"(?:\\."+o[s.PRERELEASEIDENTIFIER]+")*))",f("PRERELEASELOOSE"),o[s.PRERELEASELOOSE]="(?:-?("+o[s.PRERELEASEIDENTIFIERLOOSE]+"(?:\\."+o[s.PRERELEASEIDENTIFIERLOOSE]+")*))",f("BUILDIDENTIFIER"),o[s.BUILDIDENTIFIER]="[0-9A-Za-z-]+",f("BUILD"),o[s.BUILD]="(?:\\+("+o[s.BUILDIDENTIFIER]+"(?:\\."+o[s.BUILDIDENTIFIER]+")*))",f("FULL"),f("FULLPLAIN"),o[s.FULLPLAIN]="v?"+o[s.MAINVERSION]+o[s.PRERELEASE]+"?"+o[s.BUILD]+"?",o[s.FULL]="^"+o[s.FULLPLAIN]+"$",f("LOOSEPLAIN"),o[s.LOOSEPLAIN]="[v=\\s]*"+o[s.MAINVERSIONLOOSE]+o[s.PRERELEASELOOSE]+"?"+o[s.BUILD]+"?",f("LOOSE"),o[s.LOOSE]="^"+o[s.LOOSEPLAIN]+"$",f("GTLT"),o[s.GTLT]="((?:<|>)?=?)",f("XRANGEIDENTIFIERLOOSE"),o[s.XRANGEIDENTIFIERLOOSE]=o[s.NUMERICIDENTIFIERLOOSE]+"|x|X|\\*",f("XRANGEIDENTIFIER"),o[s.XRANGEIDENTIFIER]=o[s.NUMERICIDENTIFIER]+"|x|X|\\*",f("XRANGEPLAIN"),o[s.XRANGEPLAIN]="[v=\\s]*("+o[s.XRANGEIDENTIFIER]+")(?:\\.("+o[s.XRANGEIDENTIFIER]+")(?:\\.("+o[s.XRANGEIDENTIFIER]+")(?:"+o[s.PRERELEASE]+")?"+o[s.BUILD]+"?)?)?",f("XRANGEPLAINLOOSE"),o[s.XRANGEPLAINLOOSE]="[v=\\s]*("+o[s.XRANGEIDENTIFIERLOOSE]+")(?:\\.("+o[s.XRANGEIDENTIFIERLOOSE]+")(?:\\.("+o[s.XRANGEIDENTIFIERLOOSE]+")(?:"+o[s.PRERELEASELOOSE]+")?"+o[s.BUILD]+"?)?)?",f("XRANGE"),o[s.XRANGE]="^"+o[s.GTLT]+"\\s*"+o[s.XRANGEPLAIN]+"$",f("XRANGELOOSE"),o[s.XRANGELOOSE]="^"+o[s.GTLT]+"\\s*"+o[s.XRANGEPLAINLOOSE]+"$",f("COERCE"),o[s.COERCE]="(^|[^\\d])(\\d{1,16})(?:\\.(\\d{1,16}))?(?:\\.(\\d{1,16}))?(?:$|[^\\d])",f("COERCERTL"),i[s.COERCERTL]=new RegExp(o[s.COERCE],"g"),f("LONETILDE"),o[s.LONETILDE]="(?:~>?)",f("TILDETRIM"),o[s.TILDETRIM]="(\\s*)"+o[s.LONETILDE]+"\\s+",i[s.TILDETRIM]=new RegExp(o[s.TILDETRIM],"g"),f("TILDE"),o[s.TILDE]="^"+o[s.LONETILDE]+o[s.XRANGEPLAIN]+"$",f("TILDELOOSE"),o[s.TILDELOOSE]="^"+o[s.LONETILDE]+o[s.XRANGEPLAINLOOSE]+"$",f("LONECARET"),o[s.LONECARET]="(?:\\^)",f("CARETTRIM"),o[s.CARETTRIM]="(\\s*)"+o[s.LONECARET]+"\\s+",i[s.CARETTRIM]=new RegExp(o[s.CARETTRIM],"g"),f("CARET"),o[s.CARET]="^"+o[s.LONECARET]+o[s.XRANGEPLAIN]+"$",f("CARETLOOSE"),o[s.CARETLOOSE]="^"+o[s.LONECARET]+o[s.XRANGEPLAINLOOSE]+"$",f("COMPARATORLOOSE"),o[s.COMPARATORLOOSE]="^"+o[s.GTLT]+"\\s*("+o[s.LOOSEPLAIN]+")$|^$",f("COMPARATOR"),o[s.COMPARATOR]="^"+o[s.GTLT]+"\\s*("+o[s.FULLPLAIN]+")$|^$",f("COMPARATORTRIM"),o[s.COMPARATORTRIM]="(\\s*)"+o[s.GTLT]+"\\s*("+o[s.LOOSEPLAIN]+"|"+o[s.XRANGEPLAIN]+")",i[s.COMPARATORTRIM]=new RegExp(o[s.COMPARATORTRIM],"g"),f("HYPHENRANGE"),o[s.HYPHENRANGE]="^\\s*("+o[s.XRANGEPLAIN]+")\\s+-\\s+("+o[s.XRANGEPLAIN]+")\\s*$",f("HYPHENRANGELOOSE"),o[s.HYPHENRANGELOOSE]="^\\s*("+o[s.XRANGEPLAINLOOSE]+")\\s+-\\s+("+o[s.XRANGEPLAINLOOSE]+")\\s*$",f("STAR"),o[s.STAR]="(<|>)?=?\\s*\\*";for(var u=0;u<a;u++)r(u,o[u]),i[u]||(i[u]=new RegExp(o[u]));function c(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof h)return e;if("string"!=typeof e)return null;if(e.length>256)return null;if(!(t.loose?i[s.LOOSE]:i[s.FULL]).test(e))return null;try{return new h(e,t)}catch(e){return null}}function h(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof h){if(e.loose===t.loose)return e;e=e.version}else if("string"!=typeof e)throw new TypeError("Invalid Version: "+e);if(e.length>256)throw new TypeError("version is longer than 256 characters");if(!(this instanceof h))return new h(e,t);r("SemVer",e,t),this.options=t,this.loose=!!t.loose;var o=e.trim().match(t.loose?i[s.LOOSE]:i[s.FULL]);if(!o)throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+o[1],this.minor=+o[2],this.patch=+o[3],this.major>n||this.major<0)throw new TypeError("Invalid major version");if(this.minor>n||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>n||this.patch<0)throw new TypeError("Invalid patch version");o[4]?this.prerelease=o[4].split(".").map((function(e){if(/^[0-9]+$/.test(e)){var t=+e;if(t>=0&&t<n)return t}return e})):this.prerelease=[],this.build=o[5]?o[5].split("."):[],this.format()}t.parse=c,t.valid=function(e,t){var r=c(e,t);return r?r.version:null},t.clean=function(e,t){var r=c(e.trim().replace(/^[=v]+/,""),t);return r?r.version:null},t.SemVer=h,h.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},h.prototype.toString=function(){return this.version},h.prototype.compare=function(e){return r("SemVer.compare",this.version,this.options,e),e instanceof h||(e=new h(e,this.options)),this.compareMain(e)||this.comparePre(e)},h.prototype.compareMain=function(e){return e instanceof h||(e=new h(e,this.options)),p(this.major,e.major)||p(this.minor,e.minor)||p(this.patch,e.patch)},h.prototype.comparePre=function(e){if(e instanceof h||(e=new h(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;var t=0;do{var n=this.prerelease[t],i=e.prerelease[t];if(r("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return p(n,i)}while(++t)},h.prototype.compareBuild=function(e){e instanceof h||(e=new h(e,this.options));var t=0;do{var n=this.build[t],i=e.build[t];if(r("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return p(n,i)}while(++t)},h.prototype.inc=function(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var r=this.prerelease.length;--r>=0;)"number"==typeof this.prerelease[r]&&(this.prerelease[r]++,r=-2);-1===r&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this.raw=this.version,this},t.inc=function(e,t,r,n){"string"==typeof r&&(n=r,r=void 0);try{return new h(e,r).inc(t,n).version}catch(e){return null}},t.diff=function(e,t){if(m(e,t))return null;var r=c(e),n=c(t),i="";if(r.prerelease.length||n.prerelease.length){i="pre";var o="prerelease"}for(var s in r)if(("major"===s||"minor"===s||"patch"===s)&&r[s]!==n[s])return i+s;return o},t.compareIdentifiers=p;var l=/^[0-9]+$/;function p(e,t){var r=l.test(e),n=l.test(t);return r&&n&&(e=+e,t=+t),e===t?0:r&&!n?-1:n&&!r?1:e<t?-1:1}function d(e,t,r){return new h(e,r).compare(new h(t,r))}function E(e,t,r){return d(e,t,r)>0}function g(e,t,r){return d(e,t,r)<0}function m(e,t,r){return 0===d(e,t,r)}function v(e,t,r){return 0!==d(e,t,r)}function y(e,t,r){return d(e,t,r)>=0}function _(e,t,r){return d(e,t,r)<=0}function w(e,t,r,n){switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e===r;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e!==r;case"":case"=":case"==":return m(e,r,n);case"!=":return v(e,r,n);case">":return E(e,r,n);case">=":return y(e,r,n);case"<":return g(e,r,n);case"<=":return _(e,r,n);default:throw new TypeError("Invalid operator: "+t)}}function b(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof b){if(e.loose===!!t.loose)return e;e=e.value}if(!(this instanceof b))return new b(e,t);r("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===S?this.value="":this.value=this.operator+this.semver.version,r("comp",this)}t.rcompareIdentifiers=function(e,t){return p(t,e)},t.major=function(e,t){return new h(e,t).major},t.minor=function(e,t){return new h(e,t).minor},t.patch=function(e,t){return new h(e,t).patch},t.compare=d,t.compareLoose=function(e,t){return d(e,t,!0)},t.compareBuild=function(e,t,r){var n=new h(e,r),i=new h(t,r);return n.compare(i)||n.compareBuild(i)},t.rcompare=function(e,t,r){return d(t,e,r)},t.sort=function(e,r){return e.sort((function(e,n){return t.compareBuild(e,n,r)}))},t.rsort=function(e,r){return e.sort((function(e,n){return t.compareBuild(n,e,r)}))},t.gt=E,t.lt=g,t.eq=m,t.neq=v,t.gte=y,t.lte=_,t.cmp=w,t.Comparator=b;var S={};function A(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof A)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new A(e.raw,t);if(e instanceof b)return new A(e.value,t);if(!(this instanceof A))return new A(e,t);if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map((function(e){return this.parseRange(e.trim())}),this).filter((function(e){return e.length})),!this.set.length)throw new TypeError("Invalid SemVer Range: "+e);this.format()}function T(e,t){for(var r=!0,n=e.slice(),i=n.pop();r&&n.length;)r=n.every((function(e){return i.intersects(e,t)})),i=n.pop();return r}function R(e){return!e||"x"===e.toLowerCase()||"*"===e}function N(e,t,r,n,i,o,s,a,f,u,c,h,l){return((t=R(r)?"":R(n)?">="+r+".0.0":R(i)?">="+r+"."+n+".0":">="+t)+" "+(a=R(f)?"":R(u)?"<"+(+f+1)+".0.0":R(c)?"<"+f+"."+(+u+1)+".0":h?"<="+f+"."+u+"."+c+"-"+h:"<="+a)).trim()}function I(e,t,n){for(var i=0;i<e.length;i++)if(!e[i].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(i=0;i<e.length;i++)if(r(e[i].semver),e[i].semver!==S&&e[i].semver.prerelease.length>0){var o=e[i].semver;if(o.major===t.major&&o.minor===t.minor&&o.patch===t.patch)return!0}return!1}return!0}function O(e,t,r){try{t=new A(t,r)}catch(e){return!1}return t.test(e)}function k(e,t,r,n){var i,o,s,a,f;switch(e=new h(e,n),t=new A(t,n),r){case">":i=E,o=_,s=g,a=">",f=">=";break;case"<":i=g,o=y,s=E,a="<",f="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(O(e,t,n))return!1;for(var u=0;u<t.set.length;++u){var c=t.set[u],l=null,p=null;if(c.forEach((function(e){e.semver===S&&(e=new b(">=0.0.0")),l=l||e,p=p||e,i(e.semver,l.semver,n)?l=e:s(e.semver,p.semver,n)&&(p=e)})),l.operator===a||l.operator===f)return!1;if((!p.operator||p.operator===a)&&o(e,p.semver))return!1;if(p.operator===f&&s(e,p.semver))return!1}return!0}b.prototype.parse=function(e){var t=this.options.loose?i[s.COMPARATORLOOSE]:i[s.COMPARATOR],r=e.match(t);if(!r)throw new TypeError("Invalid comparator: "+e);this.operator=void 0!==r[1]?r[1]:"","="===this.operator&&(this.operator=""),r[2]?this.semver=new h(r[2],this.options.loose):this.semver=S},b.prototype.toString=function(){return this.value},b.prototype.test=function(e){if(r("Comparator.test",e,this.options.loose),this.semver===S||e===S)return!0;if("string"==typeof e)try{e=new h(e,this.options)}catch(e){return!1}return w(e,this.operator,this.semver,this.options)},b.prototype.intersects=function(e,t){if(!(e instanceof b))throw new TypeError("a Comparator is required");var r;if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),""===this.operator)return""===this.value||(r=new A(e.value,t),O(this.value,r,t));if(""===e.operator)return""===e.value||(r=new A(this.value,t),O(e.semver,r,t));var n=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),i=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),o=this.semver.version===e.semver.version,s=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),a=w(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),f=w(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return n||i||o&&s||a||f},t.Range=A,A.prototype.format=function(){return this.range=this.set.map((function(e){return e.join(" ").trim()})).join("||").trim(),this.range},A.prototype.toString=function(){return this.range},A.prototype.parseRange=function(e){var t=this.options.loose;e=e.trim();var n=t?i[s.HYPHENRANGELOOSE]:i[s.HYPHENRANGE];e=e.replace(n,N),r("hyphen replace",e),e=e.replace(i[s.COMPARATORTRIM],"$1$2$3"),r("comparator trim",e,i[s.COMPARATORTRIM]),e=(e=(e=e.replace(i[s.TILDETRIM],"$1~")).replace(i[s.CARETTRIM],"$1^")).split(/\s+/).join(" ");var o=t?i[s.COMPARATORLOOSE]:i[s.COMPARATOR],a=e.split(" ").map((function(e){return function(e,t){return r("comp",e,t),e=function(e,t){return e.trim().split(/\s+/).map((function(e){return function(e,t){r("caret",e,t);var n=t.loose?i[s.CARETLOOSE]:i[s.CARET];return e.replace(n,(function(t,n,i,o,s){var a;return r("caret",e,t,n,i,o,s),R(n)?a="":R(i)?a=">="+n+".0.0 <"+(+n+1)+".0.0":R(o)?a="0"===n?">="+n+"."+i+".0 <"+n+"."+(+i+1)+".0":">="+n+"."+i+".0 <"+(+n+1)+".0.0":s?(r("replaceCaret pr",s),a="0"===n?"0"===i?">="+n+"."+i+"."+o+"-"+s+" <"+n+"."+i+"."+(+o+1):">="+n+"."+i+"."+o+"-"+s+" <"+n+"."+(+i+1)+".0":">="+n+"."+i+"."+o+"-"+s+" <"+(+n+1)+".0.0"):(r("no pr"),a="0"===n?"0"===i?">="+n+"."+i+"."+o+" <"+n+"."+i+"."+(+o+1):">="+n+"."+i+"."+o+" <"+n+"."+(+i+1)+".0":">="+n+"."+i+"."+o+" <"+(+n+1)+".0.0"),r("caret return",a),a}))}(e,t)})).join(" ")}(e,t),r("caret",e),e=function(e,t){return e.trim().split(/\s+/).map((function(e){return function(e,t){var n=t.loose?i[s.TILDELOOSE]:i[s.TILDE];return e.replace(n,(function(t,n,i,o,s){var a;return r("tilde",e,t,n,i,o,s),R(n)?a="":R(i)?a=">="+n+".0.0 <"+(+n+1)+".0.0":R(o)?a=">="+n+"."+i+".0 <"+n+"."+(+i+1)+".0":s?(r("replaceTilde pr",s),a=">="+n+"."+i+"."+o+"-"+s+" <"+n+"."+(+i+1)+".0"):a=">="+n+"."+i+"."+o+" <"+n+"."+(+i+1)+".0",r("tilde return",a),a}))}(e,t)})).join(" ")}(e,t),r("tildes",e),e=function(e,t){return r("replaceXRanges",e,t),e.split(/\s+/).map((function(e){return function(e,t){e=e.trim();var n=t.loose?i[s.XRANGELOOSE]:i[s.XRANGE];return e.replace(n,(function(n,i,o,s,a,f){r("xRange",e,n,i,o,s,a,f);var u=R(o),c=u||R(s),h=c||R(a),l=h;return"="===i&&l&&(i=""),f=t.includePrerelease?"-0":"",u?n=">"===i||"<"===i?"<0.0.0-0":"*":i&&l?(c&&(s=0),a=0,">"===i?(i=">=",c?(o=+o+1,s=0,a=0):(s=+s+1,a=0)):"<="===i&&(i="<",c?o=+o+1:s=+s+1),n=i+o+"."+s+"."+a+f):c?n=">="+o+".0.0"+f+" <"+(+o+1)+".0.0"+f:h&&(n=">="+o+"."+s+".0"+f+" <"+o+"."+(+s+1)+".0"+f),r("xRange return",n),n}))}(e,t)})).join(" ")}(e,t),r("xrange",e),e=function(e,t){return r("replaceStars",e,t),e.trim().replace(i[s.STAR],"")}(e,t),r("stars",e),e}(e,this.options)}),this).join(" ").split(/\s+/);return this.options.loose&&(a=a.filter((function(e){return!!e.match(o)}))),a.map((function(e){return new b(e,this.options)}),this)},A.prototype.intersects=function(e,t){if(!(e instanceof A))throw new TypeError("a Range is required");return this.set.some((function(r){return T(r,t)&&e.set.some((function(e){return T(e,t)&&r.every((function(r){return e.every((function(e){return r.intersects(e,t)}))}))}))}))},t.toComparators=function(e,t){return new A(e,t).set.map((function(e){return e.map((function(e){return e.value})).join(" ").trim().split(" ")}))},A.prototype.test=function(e){if(!e)return!1;if("string"==typeof e)try{e=new h(e,this.options)}catch(e){return!1}for(var t=0;t<this.set.length;t++)if(I(this.set[t],e,this.options))return!0;return!1},t.satisfies=O,t.maxSatisfying=function(e,t,r){var n=null,i=null;try{var o=new A(t,r)}catch(e){return null}return e.forEach((function(e){o.test(e)&&(n&&-1!==i.compare(e)||(i=new h(n=e,r)))})),n},t.minSatisfying=function(e,t,r){var n=null,i=null;try{var o=new A(t,r)}catch(e){return null}return e.forEach((function(e){o.test(e)&&(n&&1!==i.compare(e)||(i=new h(n=e,r)))})),n},t.minVersion=function(e,t){e=new A(e,t);var r=new h("0.0.0");if(e.test(r))return r;if(r=new h("0.0.0-0"),e.test(r))return r;r=null;for(var n=0;n<e.set.length;++n)e.set[n].forEach((function(e){var t=new h(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":r&&!E(r,t)||(r=t);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+e.operator)}}));return r&&e.test(r)?r:null},t.validRange=function(e,t){try{return new A(e,t).range||"*"}catch(e){return null}},t.ltr=function(e,t,r){return k(e,t,"<",r)},t.gtr=function(e,t,r){return k(e,t,">",r)},t.outside=k,t.prerelease=function(e,t){var r=c(e,t);return r&&r.prerelease.length?r.prerelease:null},t.intersects=function(e,t,r){return e=new A(e,r),t=new A(t,r),e.intersects(t)},t.coerce=function(e,t){if(e instanceof h)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;var r=null;if((t=t||{}).rtl){for(var n;(n=i[s.COERCERTL].exec(e))&&(!r||r.index+r[0].length!==e.length);)r&&n.index+n[0].length===r.index+r[0].length||(r=n),i[s.COERCERTL].lastIndex=n.index+n[1].length+n[2].length;i[s.COERCERTL].lastIndex=-1}else r=e.match(i[s.COERCE]);return null===r?null:c(r[2]+"."+(r[3]||"0")+"."+(r[4]||"0"),t)}},2995:e=>{e.exports=function(e){var t=[];return e.forEach((function(e){/^[A-Za-z0-9_\/-]+$/.test(e)||(e=(e="'"+e.replace(/'/g,"'\\''")+"'").replace(/^(?:'')+/g,"").replace(/\\'''/g,"\\'")),t.push(e)})),t.join(" ")}},816:(e,t,r)=>{e.exports={SFTPStream:r(829),SSH2Stream:r(4184),utils:r(8013),constants:r(1399)}},33:e=>{e.exports={readUInt32BE:function(e,t){return 16777216*e[t++]+65536*e[t++]+256*e[t++]+e[t]},writeUInt32BE:function(e,t,r){return e[r++]=t>>>24,e[r++]=t>>>16,e[r++]=t>>>8,e[r++]=t,r},writeUInt32LE:function(e,t,r){return e[r++]=t,e[r++]=t>>>8,e[r++]=t>>>16,e[r++]=t>>>24,r}}},1399:(e,t,r)=>{var n,i,o,s=r(6663),a=function(){if("function"==typeof s.sign&&"function"==typeof s.verify){var e,t,r="-----BEGIN PRIVATE KEY-----\r\nMC4CAQAwBQYDK2VwBCIEIHKj+sVa9WcD/q2DJUJaf43Kptc8xYuUQA4bOFj9vC8T\r\n-----END PRIVATE KEY-----",n=Buffer.from("a");try{e=s.sign(null,n,r),t=s.verify(null,n,r,e)}catch(e){}return Buffer.isBuffer(e)&&64===e.length&&!0===t}return!1}(),f="function"==typeof s.diffieHellman&&"function"==typeof s.generateKeyPairSync&&"function"==typeof s.createPublicKey,u=t.MESSAGE={DISCONNECT:1,IGNORE:2,UNIMPLEMENTED:3,DEBUG:4,SERVICE_REQUEST:5,SERVICE_ACCEPT:6,KEXINIT:20,NEWKEYS:21,USERAUTH_REQUEST:50,USERAUTH_FAILURE:51,USERAUTH_SUCCESS:52,USERAUTH_BANNER:53,GLOBAL_REQUEST:80,REQUEST_SUCCESS:81,REQUEST_FAILURE:82,CHANNEL_OPEN:90,CHANNEL_OPEN_CONFIRMATION:91,CHANNEL_OPEN_FAILURE:92,CHANNEL_WINDOW_ADJUST:93,CHANNEL_DATA:94,CHANNEL_EXTENDED_DATA:95,CHANNEL_EOF:96,CHANNEL_CLOSE:97,CHANNEL_REQUEST:98,CHANNEL_SUCCESS:99,CHANNEL_FAILURE:100};for(n=0,o=(i=Object.keys(u)).length;n<o;++n)u[u[i[n]]]=i[n];u.KEXDH_INIT=30,u.KEXDH_REPLY=31,u.KEXDH_GEX_REQUEST=34,u.KEXDH_GEX_GROUP=31,u.KEXDH_GEX_INIT=32,u.KEXDH_GEX_REPLY=33,u.KEXECDH_INIT=30,u.KEXECDH_REPLY=31,u.USERAUTH_PASSWD_CHANGEREQ=60,u.USERAUTH_PK_OK=60,u.USERAUTH_INFO_REQUEST=60,u.USERAUTH_INFO_RESPONSE=61;var c=t.DYNAMIC_KEXDH_MESSAGE={};c[u.KEXDH_GEX_GROUP]="KEXDH_GEX_GROUP",c[u.KEXDH_GEX_REPLY]="KEXDH_GEX_REPLY";var h=t.KEXDH_MESSAGE={};h[u.KEXDH_INIT]="KEXDH_INIT",h[u.KEXDH_REPLY]="KEXDH_REPLY";var l=t.DISCONNECT_REASON={HOST_NOT_ALLOWED_TO_CONNECT:1,PROTOCOL_ERROR:2,KEY_EXCHANGE_FAILED:3,RESERVED:4,MAC_ERROR:5,COMPRESSION_ERROR:6,SERVICE_NOT_AVAILABLE:7,PROTOCOL_VERSION_NOT_SUPPORTED:8,HOST_KEY_NOT_VERIFIABLE:9,CONNECTION_LOST:10,BY_APPLICATION:11,TOO_MANY_CONNECTIONS:12,AUTH_CANCELED_BY_USER:13,NO_MORE_AUTH_METHODS_AVAILABLE:14,ILLEGAL_USER_NAME:15};for(n=0,o=(i=Object.keys(l)).length;n<o;++n)l[l[i[n]]]=i[n];var p=t.CHANNEL_OPEN_FAILURE={ADMINISTRATIVELY_PROHIBITED:1,CONNECT_FAILED:2,UNKNOWN_CHANNEL_TYPE:3,RESOURCE_SHORTAGE:4};for(n=0,o=(i=Object.keys(p)).length;n<o;++n)p[p[i[n]]]=i[n];var d=t.TERMINAL_MODE={TTY_OP_END:0,VINTR:1,VQUIT:2,VERASE:3,VKILL:4,VEOF:5,VEOL:6,VEOL2:7,VSTART:8,VSTOP:9,VSUSP:10,VDSUSP:11,VREPRINT:12,VWERASE:13,VLNEXT:14,VFLUSH:15,VSWTCH:16,VSTATUS:17,VDISCARD:18,IGNPAR:30,PARMRK:31,INPCK:32,ISTRIP:33,INLCR:34,IGNCR:35,ICRNL:36,IUCLC:37,IXON:38,IXANY:39,IXOFF:40,IMAXBEL:41,ISIG:50,ICANON:51,XCASE:52,ECHO:53,ECHOE:54,ECHOK:55,ECHONL:56,NOFLSH:57,TOSTOP:58,IEXTEN:59,ECHOCTL:60,ECHOKE:61,PENDIN:62,OPOST:70,OLCUC:71,ONLCR:72,OCRNL:73,ONOCR:74,ONLRET:75,CS7:90,CS8:91,PARENB:92,PARODD:93,TTY_OP_ISPEED:128,TTY_OP_OSPEED:129};for(n=0,o=(i=Object.keys(d)).length;n<o;++n)d[d[i[n]]]=i[n];var E=t.CHANNEL_EXTENDED_DATATYPE={STDERR:1};for(n=0,o=(i=Object.keys(E)).length;n<o;++n)E[E[i[n]]]=i[n];t.SIGNALS=["ABRT","ALRM","FPE","HUP","ILL","INT","QUIT","SEGV","TERM","USR1","USR2","KILL","PIPE"];var g=["ecdh-sha2-nistp256","ecdh-sha2-nistp384","ecdh-sha2-nistp521","diffie-hellman-group-exchange-sha256","diffie-hellman-group14-sha256","diffie-hellman-group16-sha512","diffie-hellman-group18-sha512","diffie-hellman-group14-sha1"];f&&(g.unshift("curve25519-sha256"),g.unshift("curve25519-sha256@libssh.org"));var m=["diffie-hellman-group-exchange-sha1","diffie-hellman-group1-sha1"],v=Buffer.from(g.join(","),"ascii");m=g.concat(m);var y=["ecdsa-sha2-nistp256","ecdsa-sha2-nistp384","ecdsa-sha2-nistp521","ssh-rsa"];a&&y.unshift("ssh-ed25519");var _=["ssh-dss"],w=Buffer.from(y.join(","),"ascii");_=y.concat(_);var b=["aes128-ctr","aes192-ctr","aes256-ctr","aes128-gcm","aes128-gcm@openssh.com","aes256-gcm","aes256-gcm@openssh.com"],S=["aes256-cbc","aes192-cbc","aes128-cbc","blowfish-cbc","3des-cbc","arcfour256","arcfour128","cast128-cbc","arcfour"],A=Buffer.from(b.join(","),"ascii");S=b.concat(S);var T=["hmac-sha2-256","hmac-sha2-512","hmac-sha1"],R=["hmac-md5","hmac-sha2-256-96","hmac-sha2-512-96","hmac-ripemd160","hmac-sha1-96","hmac-md5-96"],N=Buffer.from(T.join(","),"ascii");R=T.concat(R);var I=["none","zlib@openssh.com","zlib"],O=[],k=Buffer.from(I.join(","),"ascii");function U(e,t,r,n,i,o){return{blockLen:e,keyLen:t,ivLen:0===r?e:r,authLen:n,discardLen:i,stream:o}}function B(e,t){return{len:e,actualLen:t}}O=I.concat(O),t.CIPHER_INFO={"aes128-gcm":U(16,16,12,16,0,!1),"aes256-gcm":U(16,32,12,16,0,!1),"aes128-gcm@openssh.com":U(16,16,12,16,0,!1),"aes256-gcm@openssh.com":U(16,32,12,16,0,!1),"aes128-cbc":U(16,16,0,0,0,!1),"aes192-cbc":U(16,24,0,0,0,!1),"aes256-cbc":U(16,32,0,0,0,!1),"rijndael-cbc@lysator.liu.se":U(16,32,0,0,0,!1),"3des-cbc":U(8,24,0,0,0,!1),"blowfish-cbc":U(8,16,0,0,0,!1),"idea-cbc":U(8,16,0,0,0,!1),"cast128-cbc":U(8,16,0,0,0,!1),"camellia128-cbc":U(16,16,0,0,0,!1),"camellia192-cbc":U(16,24,0,0,0,!1),"camellia256-cbc":U(16,32,0,0,0,!1),"camellia128-cbc@openssh.com":U(16,16,0,0,0,!1),"camellia192-cbc@openssh.com":U(16,24,0,0,0,!1),"camellia256-cbc@openssh.com":U(16,32,0,0,0,!1),"aes128-ctr":U(16,16,0,0,0,!1),"aes192-ctr":U(16,24,0,0,0,!1),"aes256-ctr":U(16,32,0,0,0,!1),"3des-ctr":U(8,24,0,0,0,!1),"blowfish-ctr":U(8,16,0,0,0,!1),"cast128-ctr":U(8,16,0,0,0,!1),"camellia128-ctr":U(16,16,0,0,0,!1),"camellia192-ctr":U(16,24,0,0,0,!1),"camellia256-ctr":U(16,32,0,0,0,!1),"camellia128-ctr@openssh.com":U(16,16,0,0,0,!1),"camellia192-ctr@openssh.com":U(16,24,0,0,0,!1),"camellia256-ctr@openssh.com":U(16,32,0,0,0,!1),arcfour:U(8,16,0,0,1536,!0),arcfour128:U(8,16,0,0,1536,!0),arcfour256:U(8,32,0,0,1536,!0),arcfour512:U(8,64,0,0,1536,!0)},t.HMAC_INFO={"hmac-md5":B(16,16),"hmac-md5-96":B(16,12),"hmac-ripemd160":B(20,20),"hmac-sha1":B(20,20),"hmac-sha1-96":B(20,12),"hmac-sha2-256":B(32,32),"hmac-sha2-256-96":B(32,12),"hmac-sha2-512":B(64,64),"hmac-sha2-512-96":B(64,12)},t.ALGORITHMS={KEX:g,KEX_BUF:v,SUPPORTED_KEX:m,SERVER_HOST_KEY:y,SERVER_HOST_KEY_BUF:w,SUPPORTED_SERVER_HOST_KEY:_,CIPHER:b,CIPHER_BUF:A,SUPPORTED_CIPHER:S,HMAC:T,HMAC_BUF:N,SUPPORTED_HMAC:R,COMPRESS:I,COMPRESS_BUF:k,SUPPORTED_COMPRESS:O},t.SSH_TO_OPENSSL={"ecdh-sha2-nistp256":"prime256v1","ecdh-sha2-nistp384":"secp384r1","ecdh-sha2-nistp521":"secp521r1","aes128-gcm":"aes-128-gcm","aes256-gcm":"aes-256-gcm","aes128-gcm@openssh.com":"aes-128-gcm","aes256-gcm@openssh.com":"aes-256-gcm","3des-cbc":"des-ede3-cbc","blowfish-cbc":"bf-cbc","aes256-cbc":"aes-256-cbc","aes192-cbc":"aes-192-cbc","aes128-cbc":"aes-128-cbc","idea-cbc":"idea-cbc","cast128-cbc":"cast-cbc","rijndael-cbc@lysator.liu.se":"aes-256-cbc",arcfour128:"rc4",arcfour256:"rc4",arcfour512:"rc4",arcfour:"rc4","camellia128-cbc":"camellia-128-cbc","camellia192-cbc":"camellia-192-cbc","camellia256-cbc":"camellia-256-cbc","camellia128-cbc@openssh.com":"camellia-128-cbc","camellia192-cbc@openssh.com":"camellia-192-cbc","camellia256-cbc@openssh.com":"camellia-256-cbc","3des-ctr":"des-ede3","blowfish-ctr":"bf-ecb","aes256-ctr":"aes-256-ctr","aes192-ctr":"aes-192-ctr","aes128-ctr":"aes-128-ctr","cast128-ctr":"cast5-ecb","camellia128-ctr":"camellia-128-ecb","camellia192-ctr":"camellia-192-ecb","camellia256-ctr":"camellia-256-ecb","camellia128-ctr@openssh.com":"camellia-128-ecb","camellia192-ctr@openssh.com":"camellia-192-ecb","camellia256-ctr@openssh.com":"camellia-256-ecb","hmac-sha1-96":"sha1","hmac-sha1":"sha1","hmac-sha2-256":"sha256","hmac-sha2-256-96":"sha256","hmac-sha2-512":"sha512","hmac-sha2-512-96":"sha512","hmac-md5-96":"md5","hmac-md5":"md5","hmac-ripemd160":"ripemd160"};var L=t.BUGS={BAD_DHGEX:1,OLD_EXIT:2,DYN_RPORT_BUG:4};t.BUGGY_IMPLS=[["Cisco-1.25",L.BAD_DHGEX],[/^[0-9.]+$/,L.OLD_EXIT],[/^OpenSSH_5\.\d+/,L.DYN_RPORT_BUG]],t.EDDSA_SUPPORTED=a,t.CURVE25519_SUPPORTED=f},6053:e=>{function t(e,t,r){null!=e&&("number"==typeof e?this.fromNumber(e,t,r):null==t&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,t))}function r(){return new t(null)}t.prototype.am=function(e,t,r,n,i,o){for(var s=16383&t,a=t>>14;--o>=0;){var f=16383&this[e],u=this[e++]>>14,c=a*f+u*s;i=((f=s*f+((16383&c)<<14)+r[n]+i)>>28)+(c>>14)+a*u,r[n++]=268435455&f}return i},t.prototype.DB=28,t.prototype.DM=268435455,t.prototype.DV=1<<28,t.prototype.FV=Math.pow(2,52),t.prototype.F1=24,t.prototype.F2=4;var n,i,o=new Array;for(n="0".charCodeAt(0),i=0;i<=9;++i)o[n++]=i;for(n="a".charCodeAt(0),i=10;i<36;++i)o[n++]=i;for(n="A".charCodeAt(0),i=10;i<36;++i)o[n++]=i;function s(e){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(e)}function a(e,t){var r=o[e.charCodeAt(t)];return null==r?-1:r}function f(e){var t=r();return t.fromInt(e),t}function u(e){var t,r=1;return 0!=(t=e>>>16)&&(e=t,r+=16),0!=(t=e>>8)&&(e=t,r+=8),0!=(t=e>>4)&&(e=t,r+=4),0!=(t=e>>2)&&(e=t,r+=2),0!=(t=e>>1)&&(e=t,r+=1),r}function c(e){this.m=e}function h(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function l(e,t){return e&t}function p(e,t){return e|t}function d(e,t){return e^t}function E(e,t){return e&~t}function g(e){if(0==e)return-1;var t=0;return 0==(65535&e)&&(e>>=16,t+=16),0==(255&e)&&(e>>=8,t+=8),0==(15&e)&&(e>>=4,t+=4),0==(3&e)&&(e>>=2,t+=2),0==(1&e)&&++t,t}function m(e){for(var t=0;0!=e;)e&=e-1,++t;return t}function v(){}function y(e){return e}function _(e){this.r2=r(),this.q3=r(),t.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}c.prototype.convert=function(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e},c.prototype.revert=function(e){return e},c.prototype.reduce=function(e){e.divRemTo(this.m,null,e)},c.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},c.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},h.prototype.convert=function(e){var n=r();return e.abs().dlShiftTo(this.m.t,n),n.divRemTo(this.m,null,n),e.s<0&&n.compareTo(t.ZERO)>0&&this.m.subTo(n,n),n},h.prototype.revert=function(e){var t=r();return e.copyTo(t),this.reduce(t),t},h.prototype.reduce=function(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=32767&e[t],n=r*this.mpl+((r*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(e[r=t+this.m.t]+=this.m.am(0,n,e,t,0,this.m.t);e[r]>=e.DV;)e[r]-=e.DV,e[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)},h.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},h.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},t.prototype.copyTo=function(e){for(var t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s},t.prototype.fromInt=function(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+this.DV:this.t=0},t.prototype.fromString=function(e,r){var n;if(16==r)n=4;else if(8==r)n=3;else if(256==r)n=8;else if(2==r)n=1;else if(32==r)n=5;else{if(4!=r)return void this.fromRadix(e,r);n=2}this.t=0,this.s=0;for(var i=e.length,o=!1,s=0;--i>=0;){var f=8==n?255&e[i]:a(e,i);f<0?"-"==e.charAt(i)&&(o=!0):(o=!1,0==s?this[this.t++]=f:s+n>this.DB?(this[this.t-1]|=(f&(1<<this.DB-s)-1)<<s,this[this.t++]=f>>this.DB-s):this[this.t-1]|=f<<s,(s+=n)>=this.DB&&(s-=this.DB))}8==n&&0!=(128&e[0])&&(this.s=-1,s>0&&(this[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),o&&t.ZERO.subTo(this,this)},t.prototype.clamp=function(){for(var e=this.s&this.DM;this.t>0&&this[this.t-1]==e;)--this.t},t.prototype.dlShiftTo=function(e,t){var r;for(r=this.t-1;r>=0;--r)t[r+e]=this[r];for(r=e-1;r>=0;--r)t[r]=0;t.t=this.t+e,t.s=this.s},t.prototype.drShiftTo=function(e,t){for(var r=e;r<this.t;++r)t[r-e]=this[r];t.t=Math.max(this.t-e,0),t.s=this.s},t.prototype.lShiftTo=function(e,t){var r,n=e%this.DB,i=this.DB-n,o=(1<<i)-1,s=Math.floor(e/this.DB),a=this.s<<n&this.DM;for(r=this.t-1;r>=0;--r)t[r+s+1]=this[r]>>i|a,a=(this[r]&o)<<n;for(r=s-1;r>=0;--r)t[r]=0;t[s]=a,t.t=this.t+s+1,t.s=this.s,t.clamp()},t.prototype.rShiftTo=function(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t)t.t=0;else{var n=e%this.DB,i=this.DB-n,o=(1<<n)-1;t[0]=this[r]>>n;for(var s=r+1;s<this.t;++s)t[s-r-1]|=(this[s]&o)<<i,t[s-r]=this[s]>>n;n>0&&(t[this.t-r-1]|=(this.s&o)<<i),t.t=this.t-r,t.clamp()}},t.prototype.subTo=function(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this[r]-e[r],t[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this[r],t[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e[r],t[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t[r++]=this.DV+n:n>0&&(t[r++]=n),t.t=r,t.clamp()},t.prototype.multiplyTo=function(e,r){var n=this.abs(),i=e.abs(),o=n.t;for(r.t=o+i.t;--o>=0;)r[o]=0;for(o=0;o<i.t;++o)r[o+n.t]=n.am(0,i[o],r,o,0,n.t);r.s=0,r.clamp(),this.s!=e.s&&t.ZERO.subTo(r,r)},t.prototype.squareTo=function(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t[r],e,2*r,0,1);(e[r+t.t]+=t.am(r+1,2*t[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e[r+t.t]-=t.DV,e[r+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(r,t[r],e,2*r,0,1)),e.s=0,e.clamp()},t.prototype.divRemTo=function(e,n,i){var o=e.abs();if(!(o.t<=0)){var s=this.abs();if(s.t<o.t)return null!=n&&n.fromInt(0),void(null!=i&&this.copyTo(i));null==i&&(i=r());var a=r(),f=this.s,c=e.s,h=this.DB-u(o[o.t-1]);h>0?(o.lShiftTo(h,a),s.lShiftTo(h,i)):(o.copyTo(a),s.copyTo(i));var l=a.t,p=a[l-1];if(0!=p){var d=p*(1<<this.F1)+(l>1?a[l-2]>>this.F2:0),E=this.FV/d,g=(1<<this.F1)/d,m=1<<this.F2,v=i.t,y=v-l,_=null==n?r():n;for(a.dlShiftTo(y,_),i.compareTo(_)>=0&&(i[i.t++]=1,i.subTo(_,i)),t.ONE.dlShiftTo(l,_),_.subTo(a,a);a.t<l;)a[a.t++]=0;for(;--y>=0;){var w=i[--v]==p?this.DM:Math.floor(i[v]*E+(i[v-1]+m)*g);if((i[v]+=a.am(0,w,i,y,0,l))<w)for(a.dlShiftTo(y,_),i.subTo(_,i);i[v]<--w;)i.subTo(_,i)}null!=n&&(i.drShiftTo(l,n),f!=c&&t.ZERO.subTo(n,n)),i.t=l,i.clamp(),h>0&&i.rShiftTo(h,i),f<0&&t.ZERO.subTo(i,i)}}},t.prototype.invDigit=function(){if(this.t<1)return 0;var e=this[0];if(0==(1&e))return 0;var t=3&e;return(t=(t=(t=(t=t*(2-(15&e)*t)&15)*(2-(255&e)*t)&255)*(2-((65535&e)*t&65535))&65535)*(2-e*t%this.DV)%this.DV)>0?this.DV-t:-t},t.prototype.isEven=function(){return 0==(this.t>0?1&this[0]:this.s)},t.prototype.exp=function(e,n){if(e>4294967295||e<1)return t.ONE;var i=r(),o=r(),s=n.convert(this),a=u(e)-1;for(s.copyTo(i);--a>=0;)if(n.sqrTo(i,o),(e&1<<a)>0)n.mulTo(o,s,i);else{var f=i;i=o,o=f}return n.revert(i)},t.prototype.toString=function(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(16==e)t=4;else if(8==e)t=3;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return this.toRadix(e);t=2}var r,n=(1<<t)-1,i=!1,o="",a=this.t,f=this.DB-a*this.DB%t;if(a-- >0)for(f<this.DB&&(r=this[a]>>f)>0&&(i=!0,o=s(r));a>=0;)f<t?(r=(this[a]&(1<<f)-1)<<t-f,r|=this[--a]>>(f+=this.DB-t)):(r=this[a]>>(f-=t)&n,f<=0&&(f+=this.DB,--a)),r>0&&(i=!0),i&&(o+=s(r));return i?o:"0"},t.prototype.negate=function(){var e=r();return t.ZERO.subTo(this,e),e},t.prototype.abs=function(){return this.s<0?this.negate():this},t.prototype.compareTo=function(e){var t=this.s-e.s;if(0!=t)return t;var r=this.t;if(0!=(t=r-e.t))return this.s<0?-t:t;for(;--r>=0;)if(0!=(t=this[r]-e[r]))return t;return 0},t.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+u(this[this.t-1]^this.s&this.DM)},t.prototype.mod=function(e){var n=r();return this.abs().divRemTo(e,null,n),this.s<0&&n.compareTo(t.ZERO)>0&&e.subTo(n,n),n},t.prototype.modPowInt=function(e,t){var r;return r=e<256||t.isEven()?new c(t):new h(t),this.exp(e,r)},t.ZERO=f(0),t.ONE=f(1),v.prototype.convert=y,v.prototype.revert=y,v.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r)},v.prototype.sqrTo=function(e,t){e.squareTo(t)},_.prototype.convert=function(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=r();return e.copyTo(t),this.reduce(t),t},_.prototype.revert=function(e){return e},_.prototype.reduce=function(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)},_.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},_.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)};var w=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],b=(1<<26)/w[w.length-1];t.prototype.chunkSize=function(e){return Math.floor(Math.LN2*this.DB/Math.log(e))},t.prototype.toRadix=function(e){if(null==e&&(e=10),0==this.signum()||e<2||e>36)return"0";var t=this.chunkSize(e),n=Math.pow(e,t),i=f(n),o=r(),s=r(),a="";for(this.divRemTo(i,o,s);o.signum()>0;)a=(n+s.intValue()).toString(e).substr(1)+a,o.divRemTo(i,o,s);return s.intValue().toString(e)+a},t.prototype.fromRadix=function(e,r){this.fromInt(0),null==r&&(r=10);for(var n=this.chunkSize(r),i=Math.pow(r,n),o=!1,s=0,f=0,u=0;u<e.length;++u){var c=a(e,u);c<0?"-"==e.charAt(u)&&0==this.signum()&&(o=!0):(f=r*f+c,++s>=n&&(this.dMultiply(i),this.dAddOffset(f,0),s=0,f=0))}s>0&&(this.dMultiply(Math.pow(r,s)),this.dAddOffset(f,0)),o&&t.ZERO.subTo(this,this)},t.prototype.fromNumber=function(e,r,n){if("number"==typeof r)if(e<2)this.fromInt(1);else for(this.fromNumber(e,n),this.testBit(e-1)||this.bitwiseTo(t.ONE.shiftLeft(e-1),p,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(r);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(t.ONE.shiftLeft(e-1),this);else{var i=new Array,o=7&e;i.length=1+(e>>3),r.nextBytes(i),o>0?i[0]&=(1<<o)-1:i[0]=0,this.fromString(i,256)}},t.prototype.bitwiseTo=function(e,t,r){var n,i,o=Math.min(e.t,this.t);for(n=0;n<o;++n)r[n]=t(this[n],e[n]);if(e.t<this.t){for(i=e.s&this.DM,n=o;n<this.t;++n)r[n]=t(this[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=o;n<e.t;++n)r[n]=t(i,e[n]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()},t.prototype.changeBit=function(e,r){var n=t.ONE.shiftLeft(e);return this.bitwiseTo(n,r,n),n},t.prototype.addTo=function(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this[r]+e[r],t[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this[r],t[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e[r],t[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,n>0?t[r++]=n:n<-1&&(t[r++]=this.DV+n),t.t=r,t.clamp()},t.prototype.dMultiply=function(e){this[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()},t.prototype.dAddOffset=function(e,t){if(0!=e){for(;this.t<=t;)this[this.t++]=0;for(this[t]+=e;this[t]>=this.DV;)this[t]-=this.DV,++t>=this.t&&(this[this.t++]=0),++this[t]}},t.prototype.multiplyLowerTo=function(e,t,r){var n,i=Math.min(this.t+e.t,t);for(r.s=0,r.t=i;i>0;)r[--i]=0;for(n=r.t-this.t;i<n;++i)r[i+this.t]=this.am(0,e[i],r,i,0,this.t);for(n=Math.min(e.t,t);i<n;++i)this.am(0,e[i],r,i,0,t-i);r.clamp()},t.prototype.multiplyUpperTo=function(e,t,r){--t;var n=r.t=this.t+e.t-t;for(r.s=0;--n>=0;)r[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r[this.t+n-t]=this.am(t-n,e[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)},t.prototype.modInt=function(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(0==t)r=this[0]%e;else for(var n=this.t-1;n>=0;--n)r=(t*r+this[n])%e;return r},t.prototype.millerRabin=function(e){var n=this.subtract(t.ONE),i=n.getLowestSetBit();if(i<=0)return!1;var o=n.shiftRight(i);(e=e+1>>1)>w.length&&(e=w.length);for(var s=r(),a=0;a<e;++a){s.fromInt(w[Math.floor(Math.random()*w.length)]);var f=s.modPow(o,this);if(0!=f.compareTo(t.ONE)&&0!=f.compareTo(n)){for(var u=1;u++<i&&0!=f.compareTo(n);)if(0==(f=f.modPowInt(2,this)).compareTo(t.ONE))return!1;if(0!=f.compareTo(n))return!1}}return!0},t.prototype.clone=function(){var e=r();return this.copyTo(e),e},t.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},t.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},t.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},t.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},t.prototype.toByteArray=function(){var e=this.t,t=new Array;t[0]=this.s;var r,n=this.DB-e*this.DB%8,i=0;if(e-- >0)for(n<this.DB&&(r=this[e]>>n)!=(this.s&this.DM)>>n&&(t[i++]=r|this.s<<this.DB-n);e>=0;)n<8?(r=(this[e]&(1<<n)-1)<<8-n,r|=this[--e]>>(n+=this.DB-8)):(r=this[e]>>(n-=8)&255,n<=0&&(n+=this.DB,--e)),0!=(128&r)&&(r|=-256),0==i&&(128&this.s)!=(128&r)&&++i,(i>0||r!=this.s)&&(t[i++]=r);return t},t.prototype.equals=function(e){return 0==this.compareTo(e)},t.prototype.min=function(e){return this.compareTo(e)<0?this:e},t.prototype.max=function(e){return this.compareTo(e)>0?this:e},t.prototype.and=function(e){var t=r();return this.bitwiseTo(e,l,t),t},t.prototype.or=function(e){var t=r();return this.bitwiseTo(e,p,t),t},t.prototype.xor=function(e){var t=r();return this.bitwiseTo(e,d,t),t},t.prototype.andNot=function(e){var t=r();return this.bitwiseTo(e,E,t),t},t.prototype.not=function(){for(var e=r(),t=0;t<this.t;++t)e[t]=this.DM&~this[t];return e.t=this.t,e.s=~this.s,e},t.prototype.shiftLeft=function(e){var t=r();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t},t.prototype.shiftRight=function(e){var t=r();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t},t.prototype.getLowestSetBit=function(){for(var e=0;e<this.t;++e)if(0!=this[e])return e*this.DB+g(this[e]);return this.s<0?this.t*this.DB:-1},t.prototype.bitCount=function(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=m(this[r]^t);return e},t.prototype.testBit=function(e){var t=Math.floor(e/this.DB);return t>=this.t?0!=this.s:0!=(this[t]&1<<e%this.DB)},t.prototype.setBit=function(e){return this.changeBit(e,p)},t.prototype.clearBit=function(e){return this.changeBit(e,E)},t.prototype.flipBit=function(e){return this.changeBit(e,d)},t.prototype.add=function(e){var t=r();return this.addTo(e,t),t},t.prototype.subtract=function(e){var t=r();return this.subTo(e,t),t},t.prototype.multiply=function(e){var t=r();return this.multiplyTo(e,t),t},t.prototype.divide=function(e){var t=r();return this.divRemTo(e,t,null),t},t.prototype.remainder=function(e){var t=r();return this.divRemTo(e,null,t),t},t.prototype.divideAndRemainder=function(e){var t=r(),n=r();return this.divRemTo(e,t,n),new Array(t,n)},t.prototype.modPow=function(e,t){var n,i,o=e.bitLength(),s=f(1);if(o<=0)return s;n=o<18?1:o<48?3:o<144?4:o<768?5:6,i=o<8?new c(t):t.isEven()?new _(t):new h(t);var a=new Array,l=3,p=n-1,d=(1<<n)-1;if(a[1]=i.convert(this),n>1){var E=r();for(i.sqrTo(a[1],E);l<=d;)a[l]=r(),i.mulTo(E,a[l-2],a[l]),l+=2}var g,m,v=e.t-1,y=!0,w=r();for(o=u(e[v])-1;v>=0;){for(o>=p?g=e[v]>>o-p&d:(g=(e[v]&(1<<o+1)-1)<<p-o,v>0&&(g|=e[v-1]>>this.DB+o-p)),l=n;0==(1&g);)g>>=1,--l;if((o-=l)<0&&(o+=this.DB,--v),y)a[g].copyTo(s),y=!1;else{for(;l>1;)i.sqrTo(s,w),i.sqrTo(w,s),l-=2;l>0?i.sqrTo(s,w):(m=s,s=w,w=m),i.mulTo(w,a[g],s)}for(;v>=0&&0==(e[v]&1<<o);)i.sqrTo(s,w),m=s,s=w,w=m,--o<0&&(o=this.DB-1,--v)}return i.revert(s)},t.prototype.modInverse=function(e){var r=e.isEven();if(this.isEven()&&r||0==e.signum())return t.ZERO;for(var n=e.clone(),i=this.clone(),o=f(1),s=f(0),a=f(0),u=f(1);0!=n.signum();){for(;n.isEven();)n.rShiftTo(1,n),r?(o.isEven()&&s.isEven()||(o.addTo(this,o),s.subTo(e,s)),o.rShiftTo(1,o)):s.isEven()||s.subTo(e,s),s.rShiftTo(1,s);for(;i.isEven();)i.rShiftTo(1,i),r?(a.isEven()&&u.isEven()||(a.addTo(this,a),u.subTo(e,u)),a.rShiftTo(1,a)):u.isEven()||u.subTo(e,u),u.rShiftTo(1,u);n.compareTo(i)>=0?(n.subTo(i,n),r&&o.subTo(a,o),s.subTo(u,s)):(i.subTo(n,i),r&&a.subTo(o,a),u.subTo(s,u))}return 0!=i.compareTo(t.ONE)?t.ZERO:u.compareTo(e)>=0?u.subtract(e):u.signum()<0?(u.addTo(e,u),u.signum()<0?u.add(e):u):u},t.prototype.pow=function(e){return this.exp(e,new v)},t.prototype.gcd=function(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var n=t;t=r,r=n}var i=t.getLowestSetBit(),o=r.getLowestSetBit();if(o<0)return t;for(i<o&&(o=i),o>0&&(t.rShiftTo(o,t),r.rShiftTo(o,r));t.signum()>0;)(i=t.getLowestSetBit())>0&&t.rShiftTo(i,t),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return o>0&&r.lShiftTo(o,r),r},t.prototype.isProbablePrime=function(e){var t,r=this.abs();if(1==r.t&&r[0]<=w[w.length-1]){for(t=0;t<w.length;++t)if(r[0]==w[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<w.length;){for(var n=w[t],i=t+1;i<w.length&&n<b;)n*=w[i++];for(n=r.modInt(n);t<i;)if(n%w[t++]==0)return!1}return r.millerRabin(e)},t.prototype.square=function(){var e=r();return this.squareTo(e),e},t.prototype.Barrett=_,e.exports=t},8819:(e,t,r)=>{var n,i=r(6663),o=i.sign,s=i.verify,a=i.createSign,f=i.createVerify,u=i.createDecipheriv,c=i.createHash,h=i.createHmac,l=i.getCiphers(),p=r(476).Ber,d=r(2703).pbkdf,E=r(33),g=E.readUInt32BE,m=E.writeUInt32BE,v=r(1399),y=v.ALGORITHMS.SUPPORTED_CIPHER,_=v.CIPHER_INFO,w=v.SSH_TO_OPENSSL,b=v.EDDSA_SUPPORTED,S=Symbol("Hash Algorithm"),A=Symbol("Private key PEM"),T=Symbol("Public key PEM"),R=Symbol("Public key SSH"),N=Symbol("Decrypted Key"),I=Object.create(null);!function(){for(var e=Object.keys(_),t=0;t<e.length;++t){var r=w[e[t]];r&&!I[r]&&(I[r]=_[e[t]])}}();var O="function"==typeof String.prototype.trimStart?function(e){return e.trimStart()}:function(e){for(var t=0,r=0;r<e.length;++r){switch(e.charCodeAt(r)){case 32:case 9:case 13:case 10:case 12:++t;continue}break}return 0===t?e:e.slice(t)};function k(e,t){return"-----BEGIN "+e+" KEY-----\n"+(t=t.toString("base64")).replace(/.{64}/g,"$&\n")+(t.length%64?"\n":"")+"-----END "+e+" KEY-----"}function U(e,t){var r=Buffer.allocUnsafe(e.length+t.length);return e.copy(r,0),t.copy(r,e.length),r}function B(e,t){for(var r=e.length,n=e._pos||0,i=0;i<t;++i){var o=r-n;if(n>=r||o<4)return!1;var s=g(e,n);if(o<4+s)return!1;n+=4+s}return e._pos=n,!0}function L(e,t){var r=new p.Writer;return r.startSequence(),r.startSequence(),r.writeOID("1.2.840.113549.1.1.1"),r.writeNull(),r.endSequence(),r.startSequence(p.BitString),r.writeByte(0),r.startSequence(),r.writeBuffer(e,p.Integer),r.writeBuffer(t,p.Integer),r.endSequence(),r.endSequence(),r.endSequence(),k("PUBLIC",r.buffer)}function C(e,t){var r=Buffer.allocUnsafe(15+e.length+4+t.length);m(r,7,0),r.write("ssh-rsa",4,7,"ascii");var n=11;return m(r,t.length,n),t.copy(r,n+=4),m(r,e.length,n+=t.length),e.copy(r,n+4),r}var P=function(){function e(e,t,r,n,i,o,s,a){var f=new p.Writer;return f.startSequence(),f.writeInt(0,p.Integer),f.writeBuffer(e,p.Integer),f.writeBuffer(t,p.Integer),f.writeBuffer(r,p.Integer),f.writeBuffer(n,p.Integer),f.writeBuffer(i,p.Integer),f.writeBuffer(o,p.Integer),f.writeBuffer(s,p.Integer),f.writeBuffer(a,p.Integer),f.endSequence(),f.buffer}try{var t=["return function genOpenSSLRSAPriv(n, e, d, iqmp, p, q) {","  var bn_d = bigIntFromBuffer(d);","  var dmp1 = bigIntToBuffer(bn_d % (bigIntFromBuffer(p) - 1n));","  var dmq1 = bigIntToBuffer(bn_d % (bigIntFromBuffer(q) - 1n));","  return makePEM('RSA PRIVATE', genRSAASN1Buf(n, e, d, p, q, dmp1, dmq1, iqmp));","};"].join("\n");return new Function("bigIntFromBuffer, bigIntToBuffer, makePEM, genRSAASN1Buf",t)((function(e){return BigInt("0x"+e.toString("hex"))}),(function(e){var t=e.toString(16);if(0!=(1&t.length))t="0"+t;else{var r=t.charCodeAt(0);(56===r||r>=97&&r<=102)&&(t="00"+t)}return Buffer.from(t,"hex")}),k,e)}catch(t){return n=r(6053),function(t,r,i,o,s,a){var f=new n(s,256),u=new n(a,256),c=new n(i,256),h=c.mod(f.subtract(n.ONE)),l=c.mod(u.subtract(n.ONE));return k("RSA PRIVATE",e(t,r,i,s,a,Buffer.from(h.toByteArray()),Buffer.from(l.toByteArray()),o))}}var n}();function D(e,t,r,n){var i=new p.Writer;return i.startSequence(),i.startSequence(),i.writeOID("1.2.840.10040.4.1"),i.startSequence(),i.writeBuffer(e,p.Integer),i.writeBuffer(t,p.Integer),i.writeBuffer(r,p.Integer),i.endSequence(),i.endSequence(),i.startSequence(p.BitString),i.writeByte(0),i.writeBuffer(n,p.Integer),i.endSequence(),i.endSequence(),k("PUBLIC",i.buffer)}function H(e,t,r,n){var i=Buffer.allocUnsafe(15+e.length+4+t.length+4+r.length+4+n.length);m(i,7,0),i.write("ssh-dss",4,7,"ascii");var o=11;return m(i,e.length,o),e.copy(i,o+=4),m(i,t.length,o+=e.length),t.copy(i,o+=4),m(i,r.length,o+=t.length),r.copy(i,o+=4),m(i,n.length,o+=r.length),n.copy(i,o+4),i}function x(e,t,r,n,i){var o=new p.Writer;return o.startSequence(),o.writeInt(0,p.Integer),o.writeBuffer(e,p.Integer),o.writeBuffer(t,p.Integer),o.writeBuffer(r,p.Integer),o.writeBuffer(n,p.Integer),o.writeBuffer(i,p.Integer),o.endSequence(),k("DSA PRIVATE",o.buffer)}function M(e){var t=new p.Writer;return t.startSequence(),t.startSequence(),t.writeOID("1.3.101.112"),t.endSequence(),t.startSequence(p.BitString),t.writeByte(0),t._ensure(e.length),e.copy(t._buf,t._offset,0,e.length),t._offset+=e.length,t.endSequence(),t.endSequence(),k("PUBLIC",t.buffer)}function K(e){var t=Buffer.allocUnsafe(19+e.length);return m(t,11,0),t.write("ssh-ed25519",4,11,"ascii"),m(t,e.length,15),e.copy(t,19),t}function F(e,t){var r=new p.Writer;return r.startSequence(),r.startSequence(),r.writeOID("1.2.840.10045.2.1"),r.writeOID(e),r.endSequence(),r.startSequence(p.BitString),r.writeByte(0),r._ensure(t.length),t.copy(r._buf,r._offset,0,t.length),r._offset+=t.length,r.endSequence(),r.endSequence(),k("PUBLIC",r.buffer)}function G(e,t){var r;switch(e){case"1.2.840.10045.3.1.7":r="nistp256";break;case"1.3.132.0.34":r="nistp384";break;case"1.3.132.0.35":r="nistp521";break;default:return}var n=Buffer.allocUnsafe(39+t.length);return m(n,19,0),n.write("ecdsa-sha2-"+r,4,19,"ascii"),m(n,8,23),n.write(r,27,8,"ascii"),m(n,t.length,35),t.copy(n,39),n}function q(e,t,r){var n=new p.Writer;return n.startSequence(),n.writeInt(1,p.Integer),n.writeBuffer(r,p.OctetString),n.startSequence(160),n.writeOID(e),n.endSequence(),n.startSequence(161),n.startSequence(p.BitString),n.writeByte(0),n._ensure(t.length),t.copy(n._buf,n._offset,0,t.length),n._offset+=t.length,n.endSequence(),n.endSequence(),n.endSequence(),k("EC PRIVATE",n.buffer)}var X,W={sign:"function"==typeof o?function(e){var t=this[A];if(null===t)return new Error("No private key available");try{return o(this[S],e,t)}catch(e){return e}}:function(e){var t=this[A];if(null===t)return new Error("No private key available");var r=a(this[S]);return r.update(e),function(e,t){try{return e.sign(t)}catch(e){return e}}(r,t)},verify:"function"==typeof s?function(e,t){var r=this[T];if(null===r)return new Error("No public key available");try{return s(this[S],e,r,t)}catch(e){return e}}:function(e,t){var r=this[T];if(null===r)return new Error("No public key available");var n=f(this[S]);return n.update(e),function(e,t,r){try{return e.verify(t,r)}catch(e){return e}}(n,r,t)},getPrivatePEM:function(){return this[A]},getPublicPEM:function(){return this[T]},getPublicSSH:function(){return this[R]}};function j(e,t,r,n,i,o,s){this.type=e,this.comment=t,this[A]=r,this[T]=n,this[R]=i,this[S]=o,this[N]=s}function V(e,t,r,n,i,o,s){this.type=e,this.comment=t,this[A]=r,this[T]=n,this[R]=i,this[S]=o,this[N]=s}function Y(e,t,r,n,i,o,s){this.type=e,this.comment=t,this[A]=r,this[T]=n,this[R]=i,this[S]=o,this[N]=s}function Q(e,t,i,o){var s;n||(n=r(8013));var a=null,f=null;switch(t){case"ssh-rsa":var u=n.readString(e,e._pos);if(!1===u)return new Error("Malformed OpenSSH public key");var c=n.readString(e,e._pos);if(!1===c)return new Error("Malformed OpenSSH public key");a=L(c,u),f=C(c,u),s="sha1";break;case"ssh-dss":var h=n.readString(e,e._pos);if(!1===h)return new Error("Malformed OpenSSH public key");var l=n.readString(e,e._pos);if(!1===l)return new Error("Malformed OpenSSH public key");var p=n.readString(e,e._pos);if(!1===p)return new Error("Malformed OpenSSH public key");var d=n.readString(e,e._pos);if(!1===d)return new Error("Malformed OpenSSH public key");a=D(h,l,p,d),f=H(h,l,p,d),s="sha1";break;case"ssh-ed25519":var E=n.readString(e,e._pos);if(!1===E||32!==E.length)return new Error("Malformed OpenSSH public key");a=M(E),f=K(E),s=null;break;case"ecdsa-sha2-nistp256":s="sha256",oid="1.2.840.10045.3.1.7";case"ecdsa-sha2-nistp384":void 0===s&&(s="sha384",oid="1.3.132.0.34");case"ecdsa-sha2-nistp521":if(void 0===s&&(s="sha512",oid="1.3.132.0.35"),!B(e,1))return new Error("Malformed OpenSSH public key");var g=n.readString(e,e._pos);if(!1===g)return new Error("Malformed OpenSSH public key");a=F(oid,g),f=G(oid,g);break;default:return new Error("Unsupported OpenSSH public key type: "+t)}return new z(o,i,a,f,s)}function z(e,t,r,n,i){this.type=e,this.comment=t,this[A]=null,this[T]=r,this[R]=n,this[S]=i,this[N]=!1}function $(e,t,r,n,i){this.type=e,this.comment=t,this[A]=null,this[T]=r,this[R]=n,this[S]=i,this[N]=!1}j.prototype=W,X=/^-----BEGIN OPENSSH PRIVATE KEY-----(?:\r\n|\n)([\s\S]+)(?:\r\n|\n)-----END OPENSSH PRIVATE KEY-----$/,j.parse=function(e,t){var i,o=X.exec(e);if(null===o)return null;var s=Buffer.from(o[1],"base64");if(s.length<31)return new Error("Malformed OpenSSH private key");var a=s.toString("ascii",0,15);if("openssh-key-v1\0"!==a)return new Error("Unsupported OpenSSH key magic: "+a);n||(n=r(8013));var f=n.readString(s,15,"ascii");if(!1===f)return new Error("Malformed OpenSSH private key");if("none"!==f&&-1===y.indexOf(f))return new Error("Unsupported cipher for OpenSSH key: "+f);var c,h,l,E=n.readString(s,s._pos,"ascii");if(!1===E)return new Error("Malformed OpenSSH private key");if("none"!==E){if("none"===f)return new Error("Malformed OpenSSH private key");if("bcrypt"!==E)return new Error("Unsupported kdf name for OpenSSH key: "+E);if(!t)return new Error("Encrypted private OpenSSH key detected, but no passphrase given")}else if("none"!==f)return new Error("Malformed OpenSSH private key");"none"!==f&&(c=_[f]);var m=n.readString(s,s._pos);if(!1===m)return new Error("Malformed OpenSSH private key");if(m.length)switch(E){case"none":return new Error("Malformed OpenSSH private key");case"bcrypt":var v=n.readString(m,0);if(!1===v||m._pos+4>m.length)return new Error("Malformed OpenSSH private key");var S=g(m,m._pos),A=Buffer.allocUnsafe(c.keyLen+c.ivLen);if(0!==d(t,t.length,v,v.length,A,A.length,S))return new Error("Failed to generate information to decrypt key");h=A.slice(0,c.keyLen),l=A.slice(c.keyLen)}else if("none"!==E)return new Error("Malformed OpenSSH private key");var T=n.readInt(s,s._pos);if(!1===T)return new Error("Malformed OpenSSH private key");if(s._pos+=4,T>0){for(var R=0;R<T;++R){var N=n.readString(s,s._pos);if(!1===N)return new Error("Malformed OpenSSH private key");if(!1===n.readString(N,0,"ascii"))return new Error("Malformed OpenSSH private key")}var I=n.readString(s,s._pos);if(!1===I)return new Error("Malformed OpenSSH private key");if(void 0!==h){if(I.length<c.blockLen||I.length%c.blockLen!=0)return new Error("Malformed OpenSSH private key");try{var O={authTagLength:c.authLen},W=u(w[f],h,l,O);if(c.authLen>0){if(s.length-s._pos<c.authLen)return new Error("Malformed OpenSSH private key");W.setAuthTag(s.slice(s._pos,s._pos+=c.authLen))}I=U(W.update(I),W.final())}catch(e){return e}}if(s._pos!==s.length)return new Error("Malformed OpenSSH private key");i=function(e,t,r){var i,o,s,a,f=[];if(e.length<8)return new Error("Malformed OpenSSH private key");if(g(e,0)!==g(e,4))return r?new Error("OpenSSH key integrity check failed -- bad passphrase?"):new Error("OpenSSH key integrity check failed");for(e._pos=8,i=0;i<t;++i){var u=void 0,c=void 0,h=void 0,l=void 0,d=n.readString(e,e._pos,"ascii");if(!1===d)return new Error("Malformed OpenSSH private key");switch(d){case"ssh-rsa":var E=n.readString(e,e._pos);if(!1===E)return new Error("Malformed OpenSSH private key");var m=n.readString(e,e._pos);if(!1===m)return new Error("Malformed OpenSSH private key");var v=n.readString(e,e._pos);if(!1===v)return new Error("Malformed OpenSSH private key");var y=n.readString(e,e._pos);if(!1===y)return new Error("Malformed OpenSSH private key");if(!1===(_=n.readString(e,e._pos)))return new Error("Malformed OpenSSH private key");if(!1===(w=n.readString(e,e._pos)))return new Error("Malformed OpenSSH private key");h=L(E,m),l=C(E,m),c=P(E,m,v,y,_,w),u="sha1";break;case"ssh-dss":var _,w;if(!1===(_=n.readString(e,e._pos)))return new Error("Malformed OpenSSH private key");if(!1===(w=n.readString(e,e._pos)))return new Error("Malformed OpenSSH private key");var S=n.readString(e,e._pos);if(!1===S)return new Error("Malformed OpenSSH private key");var A=n.readString(e,e._pos);if(!1===A)return new Error("Malformed OpenSSH private key");var T=n.readString(e,e._pos);if(!1===T)return new Error("Malformed OpenSSH private key");h=D(_,w,S,A),l=H(_,w,S,A),c=x(_,w,S,A,T),u="sha1";break;case"ssh-ed25519":if(!b)return new Error("Unsupported OpenSSH private key type: "+d);var R=n.readString(e,e._pos);if(!1===R||32!==R.length)return new Error("Malformed OpenSSH private key");var N=n.readString(e,e._pos);if(!1===N||64!==N.length)return new Error("Malformed OpenSSH private key");h=M(R),l=K(R),s=N.slice(0,32),a=void 0,(a=new p.Writer).startSequence(),a.writeInt(0,p.Integer),a.startSequence(),a.writeOID("1.3.101.112"),a.endSequence(),a.startSequence(p.OctetString),a.writeBuffer(s,p.OctetString),a.endSequence(),a.endSequence(),c=k("PRIVATE",a.buffer),u=null;break;case"ecdsa-sha2-nistp256":u="sha256",o="1.2.840.10045.3.1.7";case"ecdsa-sha2-nistp384":void 0===u&&(u="sha384",o="1.3.132.0.34");case"ecdsa-sha2-nistp521":if(void 0===u&&(u="sha512",o="1.3.132.0.35"),!B(e,1))return new Error("Malformed OpenSSH private key");var I=n.readString(e,e._pos);if(!1===I)return new Error("Malformed OpenSSH private key");var O=n.readString(e,e._pos);if(!1===O)return new Error("Malformed OpenSSH private key");h=F(o,I),l=G(o,I),c=q(o,I,O);break;default:return new Error("Unsupported OpenSSH private key type: "+d)}var U=n.readString(e,e._pos,"utf8");if(!1===U)return new Error("Malformed OpenSSH private key");f.push(new j(d,U,c,h,l,u,r))}var X=0;for(i=e._pos;i<e.length;++i)if(e[i]!==++X%255)return new Error("Malformed OpenSSH private key");return f}(I,T,void 0!==h)}else i=[];return i},V.prototype=W,function(){var e=/^-----BEGIN (RSA|DSA|EC) PRIVATE KEY-----(?:\r\n|\n)((?:[^:]+:\s*[\S].*(?:\r\n|\n))*)([\s\S]+)(?:\r\n|\n)-----END (RSA|DSA|EC) PRIVATE KEY-----$/;V.parse=function(t,r){var n=e.exec(t);if(null===n)return null;var o,s,a,f,h,d,E=Buffer.from(n[3],"base64"),g=n[2],m=!1;if(void 0!==g){g=g.split(/\r\n|\n/g);for(var v=0;v<g.length;++v){var y=g[v],_=y.indexOf(":");if("DEK-Info"===y.slice(0,_)){var w=y.slice(_+2);if(-1===(_=w.indexOf(",")))continue;var b=w.slice(0,_).toLowerCase();if(-1===l.indexOf(b))return new Error("Cipher ("+b+") not supported for encrypted OpenSSH private key");var S=I[b];if(!S)return new Error("Cipher ("+b+") not supported for encrypted OpenSSH private key");var A=Buffer.from(w.slice(_+1),"hex");if(A.length!==S.ivLen)return new Error("Malformed encrypted OpenSSH private key");if(!r)return new Error("Encrypted OpenSSH private key detected, but no passphrase given");for(var T=c("md5").update(r).update(A.slice(0,8)).digest();T.length<S.keyLen;)T=U(T,c("md5").update(T).update(r).update(A).digest().slice(0,8));T.length>S.keyLen&&(T=T.slice(0,S.keyLen));try{var R=u(b,T,A);R.setAutoPadding(!1),E=U(R.update(E),R.final()),m=!0}catch(e){return e}}}}var N,O,B,P="Malformed OpenSSH private key";switch(m&&(P+=". Bad passphrase?"),n[1]){case"RSA":o="ssh-rsa",s=k("RSA PRIVATE",E);try{(d=new p.Reader(E)).readSequence(),d.readInt();var x=d.readString(p.Integer,!0);if(null===x)return new Error(P);var M=d.readString(p.Integer,!0);if(null===M)return new Error(P);a=L(x,M),f=C(x,M)}catch(e){return new Error(P)}h="sha1";break;case"DSA":o="ssh-dss",s=k("DSA PRIVATE",E);try{(d=new p.Reader(E)).readSequence(),d.readInt();var K=d.readString(p.Integer,!0);if(null===K)return new Error(P);var q=d.readString(p.Integer,!0);if(null===q)return new Error(P);var X=d.readString(p.Integer,!0);if(null===X)return new Error(P);var W=d.readString(p.Integer,!0);if(null===W)return new Error(P);a=D(K,q,X,W),f=H(K,q,X,W)}catch(e){return new Error(P)}h="sha1";break;case"EC":var j,Y;try{(d=new p.Reader(E)).readSequence(),d.readInt(),Y=d.readString(p.OctetString,!0),d.readByte();var Q=d.readLength();if(null===Q)return new Error(P);d._offset=Q;var z=d.readOID();if(null===z)return new Error(P);switch(z){case"1.2.840.10045.3.1.7":j="prime256v1",o="ecdsa-sha2-nistp256",h="sha256";break;case"1.3.132.0.34":j="secp384r1",o="ecdsa-sha2-nistp384",h="sha384";break;case"1.3.132.0.35":j="secp521r1",o="ecdsa-sha2-nistp521",h="sha512";break;default:return new Error("Unsupported private key EC OID: "+z)}}catch(e){return new Error(P)}s=k("EC PRIVATE",E);var $=(N=j,O=Y,(B=i.createECDH(N)).setPrivateKey(O),B.getPublicKey());a=F(z,$),f=G(z,$)}return new V(o,"",s,a,f,h,m)}}(),Y.prototype=W,function(){var e=Buffer.alloc(0),t=Buffer.from([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),i=Buffer.from([0,0,0,0]),o=Buffer.from([0,0,0,1]),s=/^PuTTY-User-Key-File-2: (ssh-(?:rsa|dss))\r?\nEncryption: (aes256-cbc|none)\r?\nComment: ([^\r\n]*)\r?\nPublic-Lines: \d+\r?\n([\s\S]+?)\r?\nPrivate-Lines: \d+\r?\n([\s\S]+?)\r?\nPrivate-MAC: ([^\r\n]+)/;Y.parse=function(a,f){var l=s.exec(a);if(null===l)return null;var p=l[2],d="none"!==p;if(d&&!f)return new Error("Encrypted PPK private key detected, but no passphrase given");var E=Buffer.from(l[5],"base64");if(d){var g=_[p],v=U(c("sha1").update(i).update(f).digest(),c("sha1").update(o).update(f).digest());v.length>g.keyLen&&(v=v.slice(0,g.keyLen));try{var y=u(w[p],v,t);y.setAutoPadding(!1),E=U(y.update(E),y.final()),decrypted=!0}catch(e){return e}}var b,S,A,T=l[1],R=l[3],N=Buffer.from(l[4],"base64"),I=l[6],O=T.length,k=p.length,M=Buffer.byteLength(R),K=N.length,F=E.length,G=Buffer.allocUnsafe(4+O+4+k+4+M+4+K+4+F);if(m(G,O,V=0),G.write(T,V+=4,O,"ascii"),m(G,k,V+=O),G.write(p,V+=4,k,"ascii"),m(G,M,V+=k),G.write(R,V+=4,M,"utf8"),m(G,K,V+=M),N.copy(G,V+=4),m(G,F,V+=K),E.copy(G,V+4),f||(f=e),h("sha1",c("sha1").update("putty-private-key-file-mac-key").update(f).digest()).update(G).digest("hex")!==I)return d?new Error("PPK private key integrity check failed -- bad passphrase?"):new Error("PPK private key integrity check failed");switch(n||(n=r(8013)),N._pos=0,B(N,1),T){case"ssh-rsa":var q=n.readString(N,N._pos);if(!1===q)return new Error("Malformed PPK public key");var X=n.readString(N,N._pos);if(!1===X)return new Error("Malformed PPK public key");var W=n.readString(E,0);if(!1===W)return new Error("Malformed PPK private key");if(!1===(V=n.readString(E,E._pos)))return new Error("Malformed PPK private key");if(!1===(Q=n.readString(E,E._pos)))return new Error("Malformed PPK private key");var j=n.readString(E,E._pos);if(!1===j)return new Error("Malformed PPK private key");b=L(X,q),S=C(X,q),A=P(X,q,W,j,V,Q);break;case"ssh-dss":var V,Q;if(!1===(V=n.readString(N,N._pos)))return new Error("Malformed PPK public key");if(!1===(Q=n.readString(N,N._pos)))return new Error("Malformed PPK public key");var z=n.readString(N,N._pos);if(!1===z)return new Error("Malformed PPK public key");var $=n.readString(N,N._pos);if(!1===$)return new Error("Malformed PPK public key");var Z=n.readString(E,0);if(!1===Z)return new Error("Malformed PPK private key");b=D(V,Q,z,$),S=H(V,Q,z,$),A=x(V,Q,z,$,Z)}return new Y(T,R,A,b,S,"sha1",d)}}(),z.prototype=W,function(){var e;e=b?/^(((?:ssh-(?:rsa|dss|ed25519))|ecdsa-sha2-nistp(?:256|384|521))(?:-cert-v0[01]@openssh.com)?) ([A-Z0-9a-z\/+=]+)(?:$|\s+([\S].*)?)$/:/^(((?:ssh-(?:rsa|dss))|ecdsa-sha2-nistp(?:256|384|521))(?:-cert-v0[01]@openssh.com)?) ([A-Z0-9a-z\/+=]+)(?:$|\s+([\S].*)?)$/,z.parse=function(t){var i=e.exec(t);if(null===i)return null;n||(n=r(8013));var o=i[1],s=i[2],a=Buffer.from(i[3],"base64"),f=i[4]||"",u=n.readString(a,a._pos,"ascii");return!1===u||0!==u.indexOf(s)?new Error("Malformed OpenSSH public key"):Q(a,s,f,o)}}(),$.prototype=W,function(){var e=/^---- BEGIN SSH2 PUBLIC KEY ----(?:\r\n|\n)((?:(?:[\x21-\x7E]+?):(?:(?:.*?\\\r?\n)*.*)(?:\r\n|\n))*)((?:[A-Z0-9a-z\/+=]+(?:\r\n|\n))+)---- END SSH2 PUBLIC KEY ----$/,t=/^([\x21-\x7E]+?):((?:.*?\\\r?\n)*.*)$/gm,i=/\\\r?\n/g;$.parse=function(o){var s=e.exec(o);if(null===s)return null;var a=s[1],f=Buffer.from(s[2],"base64"),u="";if(void 0!==a)for(;s=t.exec(a);)"comment"===s[1].toLowerCase()&&(u=O(s[2].replace(i,""))).length>1&&34===u.charCodeAt(0)&&34===u.charCodeAt(u.length-1)&&(u=u.slice(1,-1));n||(n=r(8013));var c=n.readString(f,0,"ascii");if(!1===c)return new Error("Malformed RFC4716 public key");var h=null,l=null;switch(c){case"ssh-rsa":var p=n.readString(f,f._pos);if(!1===p)return new Error("Malformed RFC4716 public key");var d=n.readString(f,f._pos);if(!1===d)return new Error("Malformed RFC4716 public key");h=L(d,p),l=C(d,p);break;case"ssh-dss":var E=n.readString(f,f._pos);if(!1===E)return new Error("Malformed RFC4716 public key");var g=n.readString(f,f._pos);if(!1===g)return new Error("Malformed RFC4716 public key");var m=n.readString(f,f._pos);if(!1===m)return new Error("Malformed RFC4716 public key");var v=n.readString(f,f._pos);if(!1===v)return new Error("Malformed RFC4716 public key");h=D(E,g,m,v),l=H(E,g,m,v);break;default:return new Error("Malformed RFC4716 public key")}return new $(c,u,h,l,"sha1")}}(),e.exports={parseDERKey:function(e,t){return Q(e,t,"",t)},parseKey:function(e,t){if(Buffer.isBuffer(e))e=e.toString("utf8").trim();else{if("string"!=typeof e)return new Error("Key data must be a Buffer or string");e=e.trim()}if(null!=t)if("string"==typeof t)t=Buffer.from(t);else if(!Buffer.isBuffer(t))return new Error("Passphrase must be a string or Buffer when supplied");var r;return null!==(r=j.parse(e,t))||null!==(r=V.parse(e,t))||null!==(r=Y.parse(e,t))||null!==(r=z.parse(e))||null!==(r=$.parse(e))?r:new Error("Unsupported key format")}}},9821:(e,t,r)=>{"use strict";var n=r(1422).inspect;function i(e,t){if(!e)throw new ERR_INTERNAL_ASSERTION(t)}function o(e){for(var t="",r=e.length,n="-"===e[0]?1:0;r>=n+4;r-=3)t=`_${e.slice(r-3,r)}${t}`;return`${e.slice(0,r)}${t}`}function s(e,t){if(i("string"==typeof t,"`thing` has to be of type string"),Array.isArray(e)){var r=e.length;return i(r>0,"At least one expected value needs to be specified"),e=e.map((e=>String(e))),r>2?`one of ${t} ${e.slice(0,r-1).join(", ")}, or `+e[r-1]:2===r?`one of ${t} ${e[0]} or ${e[1]}`:`of ${t} ${e[0]}`}return`of ${t} ${String(e)}`}i.fail=function(e){throw new ERR_INTERNAL_ASSERTION(e)},t.ERR_INTERNAL_ASSERTION=class e extends Error{constructor(t){super(),Error.captureStackTrace(this,e);var r="This is caused by either a bug in ssh2-streams or incorrect usage of ssh2-streams internals.\nPlease open an issue with this stack trace at https://github.com/mscdex/ssh2-streams/issues\n";this.message=void 0===t?r:`${t}\n${r}`}};var a=Math.pow(2,32),f=function(){try{return new Function("return 2n ** 32n")()}catch(e){}}();function u(e,t){emitErrorNT(e,t),c(e)}function c(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}t.ERR_OUT_OF_RANGE=class e extends RangeError{constructor(t,r,s,u){super(),Error.captureStackTrace(this,e),i(r,'Missing "range" argument');var c,h=u?t:`The value of "${t}" is out of range.`;Number.isInteger(s)&&Math.abs(s)>a?c=o(String(s)):"bigint"==typeof s?(c=String(s),(s>f||s<-f)&&(c=o(c)),c+="n"):c=n(s),h+=` It must be ${r}. Received ${c}`,this.message=h}},t.ERR_INVALID_ARG_TYPE=class e extends TypeError{constructor(t,r,n){var o,a;if(super(),Error.captureStackTrace(this,e),i("string"==typeof t,"'name' must be a string"),"string"==typeof r&&r.startsWith("not ")?(o="must not be",r=r.replace(/^not /,"")):o="must be",t.endsWith(" argument"))a=`The ${t} ${o} ${s(r,"type")}`;else{var f=t.includes(".")?"property":"argument";a=`The "${t}" ${f} ${o} ${s(r,"type")}`}a+=". Received type "+typeof n,this.message=a}},t.validateNumber=function(e,t){if("number"!=typeof e)throw new ERR_INVALID_ARG_TYPE(t,"number",e)},t.destroyImpl=function(e,t){const r=this._readableState&&this._readableState.destroyed,n=this._writableState&&this._writableState.destroyed;return r||n?(t?t(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(emitErrorNT,this,e)):process.nextTick(emitErrorNT,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(e=>{!t&&e?this._writableState?this._writableState.errorEmitted?process.nextTick(c,this):(this._writableState.errorEmitted=!0,process.nextTick(u,this,e)):process.nextTick(u,this,e):t?(process.nextTick(c,this),t(e)):process.nextTick(c,this)})),this)}},829:(e,t,r)=>{var n=r(1784).Transform,i=r(1784).Readable,o=r(1784).Writable,s=r(9998).constants||process.binding("constants"),a=r(1422),f=a.inherits,u=a.isDate,c=r(7187).EventEmitter.listenerCount,h=r(9998),l=r(8013).readString,p=r(8013).readInt,d=r(33).readUInt32BE,E=r(33).writeUInt32BE,g={OK:0,EOF:1,NO_SUCH_FILE:2,PERMISSION_DENIED:3,FAILURE:4,BAD_MESSAGE:5,NO_CONNECTION:6,CONNECTION_LOST:7,OP_UNSUPPORTED:8};Object.keys(g).forEach((function(e){g[g[e]]=e}));var m={0:"No error",1:"End of file",2:"No such file or directory",3:"Permission denied",4:"Failure",5:"Bad message",6:"No connection",7:"Connection lost",8:"Operation unsupported"};R.STATUS_CODE=g;var v={INIT:1,OPEN:3,CLOSE:4,READ:5,WRITE:6,LSTAT:7,FSTAT:8,SETSTAT:9,FSETSTAT:10,OPENDIR:11,READDIR:12,REMOVE:13,MKDIR:14,RMDIR:15,REALPATH:16,STAT:17,RENAME:18,READLINK:19,SYMLINK:20,EXTENDED:200};Object.keys(v).forEach((function(e){v[v[e]]=e}));var y={VERSION:2,STATUS:101,HANDLE:102,DATA:103,NAME:104,ATTRS:105,EXTENDED:201};Object.keys(y).forEach((function(e){y[y[e]]=e}));var _={READ:1,WRITE:2,APPEND:4,CREAT:8,TRUNC:16,EXCL:32};R.OPEN_MODE=_;var w=Math.pow(2,32)-1,b=Buffer.from([0,0,0,5,v.INIT,0,0,0,3]),S=Buffer.from([0,0,0,5,y.VERSION,0,0,0,3]),A=/^SSH-2.0-(?:OpenSSH|dropbear)/;function T(e){}function R(e,t){"string"!=typeof e||t||(t=e,e=void 0),"object"==typeof e&&e||(e={}),n.call(this,{highWaterMark:"number"==typeof e.highWaterMark?e.highWaterMark:32768}),this.debug="function"==typeof e.debug?e.debug:T,this.server=!!e.server,this._isOpenSSH=t&&A.test(t),this._needContinue=!1,this._state={status:"packet_header",writeReqid:-1,pktLeft:void 0,pktHdrBuf:Buffer.allocUnsafe(9),pktBuf:void 0,pktType:void 0,version:void 0,extensions:{},maxDataLen:this._isOpenSSH?260096:32768,requests:{}};var r=this;function i(){r.writable=!1,r._cleanup(!1)}this.on("end",(function(){r.readable=!1})).on("finish",i).on("prefinish",i),this.server||this.push(b)}function N(e,t,r,n,i,o){var s,a,f,u,c=64,l=32768;"function"==typeof i?o=i:"object"==typeof i&&null!==i&&("number"==typeof i.concurrency&&i.concurrency>0&&!isNaN(i.concurrency)&&(c=i.concurrency),"number"==typeof i.chunkSize&&i.chunkSize>0&&!isNaN(i.chunkSize)&&(l=i.chunkSize),"number"==typeof i.fileSize&&i.fileSize>0&&!isNaN(i.fileSize)&&(f=i.fileSize),"function"==typeof i.step&&(s=i.step),"string"!=typeof i.mode&&"number"!=typeof i.mode||(a=L(i.mode)));var p,d,E,g=0,m=0,v=!1,y=l*c;function _(r){if(!v){v=!0;var n,i=0;p||d?(n=function(){0==--i&&o(r)},p&&(e===h||e.writable)&&++i,d&&(t===h||t.writable)&&++i,p&&(e===h||e.writable)&&e.close(p,n),d&&(t===h||t.writable)&&t.close(d,n)):o(r)}}e.open(r,"r",(function(i,v){if(i)return _(i);function w(i,f){if(i)return e!==h?void e.stat(r,(function(e,t){if(e)return _(i);w(null,t)})):_(i);u=f.size,t.open(n,"w",(function(r,i){if(r)return _(r);if(d=i,u<=0)return _();for(;y>u;){if(1===c){y=u;break}y-=l,--c}if((E=function(e){try{return Buffer.allocUnsafe(e)}catch(e){return e}}(y))instanceof Error)return _(E);function f(r,n,i,a,f,c){if(r)return _(r);function v(r){if(r)return _(r);if(m+=n,s&&s(m,n,u),n<c)return w(f,a+n,c-n);if(m!==u){if(!(g>=u)){var i=g+l>u?u-g:l;w(f,g,i),g+=i}}else t.close(d,(function(t){if(d=void 0,t)return _(t);e.close(p,(function(e){if(p=void 0,e)return _(e);o()}))}))}f=f||0,e===h?t.writeData(d,E,f,n,a,v):t.write(d,E,f,n,a,v)}function v(e,t,r){return function(n,i,o){f(n,i,0,t,e,r)}}function w(t,r,n){e===h?e.read(p,E,t,n,r,v(t,r,n)):e.readData(p,E,t,n,r,v(t,r,n))}function b(){for(var e=0,t=0;g<u&&e<c;){var r=g+l>u?u-g:l;w(t,g,r),t+=r,g+=r,++e}}void 0!==a?t.fchmod(d,a,(function e(r){r?t.chmod(n,a,(function(t){e()})):b()})):b()}))}p=v,void 0===f?e.fstat(p,w):w(null,{size:f})}))}function I(e,t,r,n,i,o,s){var a="function"==typeof s?s:void 0;e.writeData(t,r,n,i,o,(function(s,f){if(s)return e.close(t,(function(){a&&a(s)}));f===i?e.close(t,a):I(e,t,r,n+=f,i-=f,o+=f,a)}))}function O(e,t,r,n){var i=d(e,t),o=new H;if(t+=4,1&i){var s=k(e,t,r,n);if(!1===s)return!1;o.size=s,t+=8}if(2&i){var a,f;if(!1===(a=p(e,t,this,n)))return!1;if(o.uid=a,!1===(f=p(e,t+=4,this,n)))return!1;o.gid=f,t+=4}if(4&i){var u=p(e,t,this,n);if(!1===u)return!1;o.mode=u,o.permissions=u,t+=4}if(8&i){var c,h;if(!1===(c=p(e,t,this,n)))return!1;if(o.atime=c,!1===(h=p(e,t+=4,this,n)))return!1;o.mtime=h,t+=4}if(2147483648&i){var l=p(e,t,this,n);if(!1===l)return!1;t+=4;for(var E,g=0;g<l;++g){if(!1===(E=p(e,t,this,n)))return!1;t+=4+E}}return e._pos=t,o}function k(e,t,r,n){if(e.length-t<8)return r&&r._cleanup(n),!1;for(var i=0,o=t+8;t<o;++t)i*=256,i+=e[t];return e._pos=t,i}function U(e){var t=0,r=0,n=[],i=0;if("object"!=typeof e||null===e)return{flags:t,nbytes:r,bytes:n};if("number"==typeof e.size){t|=1,r+=8;var o=new Array(8),s=e.size;for(i=7;i>=0;--i)o[i]=255&s,s/=256;n.push(o)}if("number"==typeof e.uid&&"number"==typeof e.gid&&(t|=2,r+=8,n.push([e.uid>>24&255,e.uid>>16&255,e.uid>>8&255,255&e.uid]),n.push([e.gid>>24&255,e.gid>>16&255,e.gid>>8&255,255&e.gid])),"number"==typeof e.permissions||"string"==typeof e.permissions||"number"==typeof e.mode||"string"==typeof e.mode){var a=L(e.mode||e.permissions);t|=4,r+=4,n.push([a>>24&255,a>>16&255,a>>8&255,255&a])}if(("number"==typeof e.atime||u(e.atime))&&("number"==typeof e.mtime||u(e.mtime))){var f=B(e.atime),c=B(e.mtime);t|=8,r+=8,n.push([f>>24&255,f>>16&255,f>>8&255,255&f]),n.push([c>>24&255,c>>16&255,c>>8&255,255&c])}return{flags:t,nbytes:r,bytes:n}}function B(e){if("number"==typeof e&&!isNaN(e))return e;if(u(e))return parseInt(e.getTime()/1e3,10);throw new Error("Cannot parse time: "+e)}function L(e){if("number"==typeof e&&!isNaN(e))return e;if("string"==typeof e)return L(parseInt(e,8));throw new Error("Cannot parse mode: "+e)}f(R,n),R.prototype.__read=n.prototype._read,R.prototype._read=function(e){return this._needContinue&&(this._needContinue=!1,this.emit("continue")),this.__read(e)},R.prototype.__push=n.prototype.push,R.prototype.push=function(e,t){if(!this.readable)return!1;null===e&&(this.readable=!1);var r=this.__push(e,t);return this._needContinue=!1===r,r},R.prototype._cleanup=function(e){var t=this._state;t.pktBuf=void 0;var r=t.requests,n=Object.keys(r),i=n.length;if(i){if(this.readable)for(var o,s=new Error("SFTP session ended early"),a=0;a<i;++a)(o=r[n[a]].cb)&&o(s);t.requests={}}this.readable&&this.push(null),this._readableState.endEmitted||this._readableState.flowing||this.resume(),!1!==e&&(this.debug("DEBUG[SFTP]: Parser: Malformed packet"),e&&e(new Error("Malformed packet")))},R.prototype._transform=function(e,t,r){for(var n,i,o,s=this._state,a=this.server,f=s.status,u=s.pktType,h=s.pktBuf,_=s.pktLeft,w=s.version,b=s.pktHdrBuf,A=s.requests,T=this.debug,R=e.length,N=0;;){if("discard"===f){if(!(_<=(i=R-N))){_-=i;break}N+=_,_=0,f="packet_header",n=h=void 0}else{if(void 0!==h){if(_<=(i=R-N)){e.copy(h,h.length-_,N,N+_),N+=_,_=0,n=h,h=void 0;continue}e.copy(h,h.length-_,N),_-=i;break}if("packet_header"===f)if(n){if(_=d(n,4)-1,u=n[8],a){if(void 0===w&&u!==v.INIT)return T("DEBUG[SFTP]: Parser: Unexpected packet before init"),this._cleanup(!1),r(new Error("Unexpected packet before init"));if(void 0!==w&&u===v.INIT)T("DEBUG[SFTP]: Parser: Unexpected duplicate init"),f="bad_pkt";else{if(_>34e3)return T("DEBUG[SFTP]: Parser: "+(V="Packet length ("+_+") exceeds max length (34000)")),this._cleanup(!1),r(new Error(V));u===v.EXTENDED?f="bad_pkt":void 0===v[u]&&(T("DEBUG[SFTP]: Parser: Unsupported packet type: "+u),f="discard")}}else{if(void 0===w&&u!==y.VERSION)return T("DEBUG[SFTP]: Parser: Unexpected packet before version"),this._cleanup(!1),r(new Error("Unexpected packet before version"));void 0!==w&&u===y.VERSION?(T("DEBUG[SFTP]: Parser: Unexpected duplicate version"),f="bad_pkt"):void 0===y[u]&&(f="discard")}"bad_pkt"===f?(E(b,_+1,0),b[4]=u,_=4,h=b):(h=Buffer.allocUnsafe(_),f="payload")}else _=5,h=b;else if("payload"===f){if(u===y.VERSION||u===v.INIT){if(!1===(w=s.version=p(n,0,this,r)))return;if(w<3)return this._cleanup(!1),r(new Error("Incompatible SFTP version: "+w));a&&this.push(S);var I,U,B=n.length;for(n._pos=4;n._pos<B;){if(!1===(I=l(n,n._pos,"ascii",this,r)))return;if(!1===(U=l(n,n._pos,"ascii",this,r)))return;s.extensions[I]?s.extensions[I].push(U):s.extensions[I]=[U]}this.emit("ready")}else{if(!1===(o=p(n,0,this,r)))return;var L,C,P,D;if(a){var H,x,M=v[u];if(T("DEBUG[SFTP]: Parser: Request: "+M),c(this,M)){if(u===v.OPEN){if(!1===(L=l(n,4,"utf8",this,r)))return;var K=p(n,n._pos,this,r);if(!1===K)return;if(!1===(C=O(n,n._pos+4,this,r)))return;this.emit(M,o,L,K,C)}else if(u===v.CLOSE||u===v.FSTAT||u===v.READDIR){if(!1===(P=l(n,4,this,r)))return;this.emit(M,o,P)}else if(u===v.READ){if(!1===(P=l(n,4,this,r)))return;if(!1===(H=k(n,n._pos,this,r)))return;var F=p(n,n._pos,this,r);if(!1===F)return;this.emit(M,o,P,H,F)}else if(u===v.WRITE){if(!1===(P=l(n,4,this,r)))return;if(!1===(H=k(n,n._pos,this,r)))return;if(!1===(D=l(n,n._pos,this,r)))return;this.emit(M,o,P,H,D)}else if(u===v.LSTAT||u===v.STAT||u===v.OPENDIR||u===v.REMOVE||u===v.RMDIR||u===v.REALPATH||u===v.READLINK){if(!1===(x=l(n,4,"utf8",this,r)))return;this.emit(M,o,x)}else if(u===v.SETSTAT||u===v.MKDIR){if(!1===(x=l(n,4,"utf8",this,r)))return;if(!1===(C=O(n,n._pos,this,r)))return;this.emit(M,o,x,C)}else if(u===v.FSETSTAT){if(!1===(P=l(n,4,this,r)))return;if(!1===(C=O(n,n._pos,this,r)))return;this.emit(M,o,P,C)}else if(u===v.RENAME||u===v.SYMLINK){var G,q;if(!1===(G=l(n,4,"utf8",this,r)))return;if(!1===(q=l(n,n._pos,"utf8",this,r)))return;u===v.SYMLINK&&this._isOpenSSH?this.emit(M,o,q,G):this.emit(M,o,G,q)}}else this.status(o,g.OP_UNSUPPORTED)}else{var X=A[o],W=X&&X.cb;if(T("DEBUG[SFTP]: Parser: Response: "+y[u]),X&&W)if(u===y.STATUS){var j=p(n,4,this,r);if(!1===j)return;if(j===g.OK)W();else{var V,Y="";if(n.length>=12){if(!1===(V=l(n,8,"utf8",this,r)))return;if(n._pos+4<n.length&&!1===(Y=l(n,n._pos,"ascii",this,r)))return}var Q=new Error(V||m[j]||"Unknown status");Q.code=j,Q.lang=Y,W(Q)}}else if(u===y.HANDLE){if(!1===(P=l(n,4,this,r)))return;W(void 0,P)}else if(u===y.DATA)if(X.buffer){var z=p(n,4,this,r);if(!1===z)return;var $=X.buffer.length;if(z>$&&E(n,$,4),!1===(D=l(n,4,X.buffer,this,r)))return;W(void 0,D,z)}else{if(!1===(D=l(n,4,this,r)))return;W(void 0,D)}else if(u===y.NAME){var Z=p(n,4,this,r);if(!1===Z)return;var J,ee=[];n._pos=8;for(var te=0;te<Z;++te){if(!1===(L=l(n,n._pos,"utf8",this,r)))return;if(!1===(J=l(n,n._pos,"utf8",this,r)))return;if(!1===(C=O(n,n._pos,this,r)))return;ee.push({filename:L,longname:J,attrs:C})}W(void 0,ee)}else if(u===y.ATTRS){if(!1===(C=O(n,4,this,r)))return;W(void 0,C)}else if(u===y.EXTENDED){if(X.extended)switch(X.extended){case"statvfs@openssh.com":case"fstatvfs@openssh.com":var re={f_bsize:void 0,f_frsize:void 0,f_blocks:void 0,f_bfree:void 0,f_bavail:void 0,f_files:void 0,f_ffree:void 0,f_favail:void 0,f_sid:void 0,f_flag:void 0,f_namemax:void 0};if(re.f_bsize=k(n,4,this,r),!1===re.f_bsize)return;if(re.f_frsize=k(n,12,this,r),!1===re.f_frsize)return;if(re.f_blocks=k(n,20,this,r),!1===re.f_blocks)return;if(re.f_bfree=k(n,28,this,r),!1===re.f_bfree)return;if(re.f_bavail=k(n,36,this,r),!1===re.f_bavail)return;if(re.f_files=k(n,44,this,r),!1===re.f_files)return;if(re.f_ffree=k(n,52,this,r),!1===re.f_ffree)return;if(re.f_favail=k(n,60,this,r),!1===re.f_favail)return;if(re.f_sid=k(n,68,this,r),!1===re.f_sid)return;if(re.f_flag=k(n,76,this,r),!1===re.f_flag)return;if(re.f_namemax=k(n,84,this,r),!1===re.f_namemax)return;W(void 0,re)}W()}X&&delete A[o]}}f="packet_header",n=h=void 0}else if("bad_pkt"===f){if(a&&n[4]!==v.INIT){var ne=n[4]===v.EXTENDED?g.OP_UNSUPPORTED:g.FAILURE;if(n[4]===v.INIT||n[4]===y.VERSION)return this._cleanup(r);if(!1===(o=p(n,5,this,r)))return;this.status(o,ne)}_=d(n,0)-5,f="discard"}}if(N>=R)break}s.status=f,s.pktType=u,s.pktBuf=h,s.pktLeft=_,s.version=w,r()},R.prototype.createReadStream=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");return new V(this,e,t)},R.prototype.createWriteStream=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");return new Q(this,e,t)},R.prototype.open=function(e,t,r,n){if(this.server)throw new Error("Client-only method called in server mode");var i=this._state;"function"==typeof r&&(n=r,r=void 0);var o="number"==typeof t?t:D(t);if(null===o)throw new Error("Unknown flags string: "+t);var s=0,a=0;"string"!=typeof r&&"number"!=typeof r||(r={mode:r}),"object"==typeof r&&null!==r&&(s=(r=U(r)).flags,a=r.nbytes,r=r.bytes);var f=Buffer.byteLength(e),u=9,c=Buffer.allocUnsafe(13+f+4+4+a);E(c,c.length-4,0),c[4]=v.OPEN;var h=i.writeReqid=(i.writeReqid+1)%w;if(E(c,h,5),E(c,f,u),c.write(e,u+=4,f,"utf8"),E(c,o,u+=f),E(c,s,u+=4),r&&s){u+=4;for(var l=0,p=r.length;l<p;++l)for(var d=0,g=r[l].length;d<g;++d)c[u++]=r[l][d]}return i.requests[h]={cb:n},this.debug("DEBUG[SFTP]: Outgoing: Writing OPEN"),this.push(c)},R.prototype.close=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");var r=this._state,n=e.length,i=9,o=Buffer.allocUnsafe(13+n);E(o,o.length-4,0),o[4]=v.CLOSE;var s=r.writeReqid=(r.writeReqid+1)%w;return E(o,s,5),E(o,n,i),e.copy(o,i+=4),r.requests[s]={cb:t},this.debug("DEBUG[SFTP]: Outgoing: Writing CLOSE"),this.push(o)},R.prototype.readData=function(e,t,r,n,i,o){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");if(!Buffer.isBuffer(t))throw new Error("buffer is not a Buffer");if(r>=t.length)throw new Error("offset is out of bounds");if(r+n>t.length)throw new Error("length extends beyond buffer");if(null===i)throw new Error("null position currently unsupported");var s=this._state,a=e.length,f=9,u=i,c=Buffer.allocUnsafe(13+a+8+4);E(c,c.length-4,0),c[4]=v.READ;var h=s.writeReqid=(s.writeReqid+1)%w;E(c,h,5),E(c,a,f),e.copy(c,f+=4),f+=a;for(var l=7;l>=0;--l)c[f+l]=255&u,u/=256;return E(c,n,f+=8),s.requests[h]={cb:function(e,t,r){if(e){if(o._wantEOFError||e.code!==g.EOF)return o(e)}else if(r>n)return o(new Error("Received more data than requested"));o(void 0,r||0,t,i)},buffer:t.slice(r,r+n)},this.debug("DEBUG[SFTP]: Outgoing: Writing READ"),this.push(c)},R.prototype.writeData=function(e,t,r,n,i,o){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");if(!Buffer.isBuffer(t))throw new Error("buffer is not a Buffer");if(r>t.length)throw new Error("offset is out of bounds");if(r+n>t.length)throw new Error("length extends beyond buffer");if(null===i)throw new Error("null position currently unsupported");var s=this,a=this._state;if(n){var f=n>a.maxDataLen?n-a.maxDataLen:0,u=i;f&&(n=a.maxDataLen);var c=e.length,h=9,l=Buffer.allocUnsafe(13+c+8+4+n);E(l,l.length-4,0),l[4]=v.WRITE;var p=a.writeReqid=(a.writeReqid+1)%w;E(l,p,5),E(l,c,h),e.copy(l,h+=4),h+=c;for(var d=7;d>=0;--d)l[h+d]=255&i,i/=256;return E(l,n,h+=8),t.copy(l,h+=4,r,r+n),a.requests[p]={cb:function(i){i?o&&o(i):f?s.writeData(e,t,r+n,f,u+n,o):o&&o(void 0,r+n)}},this.debug("DEBUG[SFTP]: Outgoing: Writing WRITE"),this.push(l)}o&&process.nextTick((function(){o(void 0,0)}))},R.prototype.fastGet=function(e,t,r,n){if(this.server)throw new Error("Client-only method called in server mode");N(this,h,e,t,r,n)},R.prototype.fastPut=function(e,t,r,n){if(this.server)throw new Error("Client-only method called in server mode");N(h,this,e,t,r,n)},R.prototype.readFile=function(e,t,r){if(this.server)throw new Error("Client-only method called in server mode");var n;"function"==typeof r?n=r:"function"==typeof t&&(n=t,t=void 0);var i=this;if("string"==typeof t)t={encoding:t,flag:"r"};else if(t){if("object"!=typeof t)throw new TypeError("Bad arguments")}else t={encoding:null,flag:"r"};var o,s,a,f=t.encoding;if(f&&!Buffer.isEncoding(f))throw new Error("Unknown encoding: "+f);var u,c=0,h=0,l=t.flag||"r";function p(){0===o?(s=Buffer.allocUnsafe(8192),i.readData(u,s,0,8192,h,d)):i.readData(u,s,c,o-c,h,d)}function d(e,t){var r;if(e){if(!(r=e.code===g.EOF))return i.close(u,(function(){return n&&n(e)}))}else r=!1;if(r||0===o&&0===t)return E();h+=t,c+=t,0!==o?c===o?E():p():(a.push(s.slice(0,t)),p())}function E(){i.close(u,(function(e){return 0===o?s=Buffer.concat(a,c):c<o&&(s=s.slice(0,c)),f&&(s=s.toString(f)),n&&n(e,s)}))}this.open(e,l,438,(function(t,r){if(t)return n&&n(t);u=r,i.fstat(u,(function t(r,f){if(r)i.stat(e,(function(e,o){if(e)return i.close(u,(function(){n&&n(r)}));t(null,o)}));else{if(0===(o=f.size||0))return a=[],p();s=Buffer.allocUnsafe(o),p()}}))})),d._wantEOFError=!0},R.prototype.writeFile=function(e,t,r,n){if(this.server)throw new Error("Client-only method called in server mode");var i;"function"==typeof n?i=n:"function"==typeof r&&(i=r,r=void 0);var o=this;if("string"==typeof r)r={encoding:r,mode:438,flag:"w"};else if(r){if("object"!=typeof r)throw new TypeError("Bad arguments")}else r={encoding:"utf8",mode:438,flag:"w"};if(r.encoding&&!Buffer.isEncoding(r.encoding))throw new Error("Unknown encoding: "+r.encoding);var s=r.flag||"w";this.open(e,s,r.mode,(function(n,a){if(n)i&&i(n);else{var f=Buffer.isBuffer(t)?t:Buffer.from(""+t,r.encoding||"utf8"),u=/a/.test(s)?null:0;if(null===u)return void o.fstat(a,(function t(r,n){r?o.stat(e,(function(e,n){if(e)return o.close(a,(function(){i&&i(r)}));t(null,n)})):I(o,a,f,0,f.length,n.size,i)}));I(o,a,f,0,f.length,u,i)}}))},R.prototype.appendFile=function(e,t,r,n){if(this.server)throw new Error("Client-only method called in server mode");var i;if("function"==typeof n?i=n:"function"==typeof r&&(i=r,r=void 0),"string"==typeof r)r={encoding:r,mode:438,flag:"a"};else if(r){if("object"!=typeof r)throw new TypeError("Bad arguments")}else r={encoding:"utf8",mode:438,flag:"a"};r.flag||(r=a._extend({flag:"a"},r)),this.writeFile(e,t,r,i)},R.prototype.exists=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");this.stat(e,(function(e){t&&t(!e)}))},R.prototype.unlink=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");var r=this._state,n=Buffer.byteLength(e),i=9,o=Buffer.allocUnsafe(13+n);E(o,o.length-4,0),o[4]=v.REMOVE;var s=r.writeReqid=(r.writeReqid+1)%w;return E(o,s,5),E(o,n,i),o.write(e,i+=4,n,"utf8"),r.requests[s]={cb:t},this.debug("DEBUG[SFTP]: Outgoing: Writing REMOVE"),this.push(o)},R.prototype.rename=function(e,t,r){if(this.server)throw new Error("Client-only method called in server mode");var n=this._state,i=Buffer.byteLength(e),o=Buffer.byteLength(t),s=9,a=Buffer.allocUnsafe(13+i+4+o);E(a,a.length-4,0),a[4]=v.RENAME;var f=n.writeReqid=(n.writeReqid+1)%w;return E(a,f,5),E(a,i,s),a.write(e,s+=4,i,"utf8"),E(a,o,s+=i),a.write(t,s+=4,o,"utf8"),n.requests[f]={cb:r},this.debug("DEBUG[SFTP]: Outgoing: Writing RENAME"),this.push(a)},R.prototype.mkdir=function(e,t,r){if(this.server)throw new Error("Client-only method called in server mode");var n=0,i=0,o=this._state;"function"==typeof t&&(r=t,t=void 0),"object"==typeof t&&null!==t&&(n=(t=U(t)).flags,i=t.nbytes,t=t.bytes);var s=Buffer.byteLength(e),a=9,f=Buffer.allocUnsafe(13+s+4+i);E(f,f.length-4,0),f[4]=v.MKDIR;var u=o.writeReqid=(o.writeReqid+1)%w;if(E(f,u,5),E(f,s,a),f.write(e,a+=4,s,"utf8"),E(f,n,a+=s),n){a+=4;for(var c=0,h=t.length;c<h;++c)for(var l=0,p=t[c].length;l<p;++l)f[a++]=t[c][l]}return o.requests[u]={cb:r},this.debug("DEBUG[SFTP]: Outgoing: Writing MKDIR"),this.push(f)},R.prototype.rmdir=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");var r=this._state,n=Buffer.byteLength(e),i=9,o=Buffer.allocUnsafe(13+n);E(o,o.length-4,0),o[4]=v.RMDIR;var s=r.writeReqid=(r.writeReqid+1)%w;return E(o,s,5),E(o,n,i),o.write(e,i+=4,n,"utf8"),r.requests[s]={cb:t},this.debug("DEBUG[SFTP]: Outgoing: Writing RMDIR"),this.push(o)},R.prototype.readdir=function(e,t,r){if(this.server)throw new Error("Client-only method called in server mode");var n,i=this._state;if("function"==typeof t&&(r=t,t={}),"object"==typeof t&&null!==t||(t={}),n=!t||!t.full,!Buffer.isBuffer(e)&&"string"!=typeof e)throw new Error("missing directory handle or path");if("string"==typeof e){var o=this,s=[],a=0;return this.opendir(e,(function e(n,i){if(n)return r(n);o.readdir(i,t,(function(t,n){var f=t&&t.code===g.EOF;if(t&&!f)return o.close(i,(function(){r(t)}));if(f)return o.close(i,(function(e){if(e)return r(e);r(void 0,s)}));for(var u=0,c=n.length;u<c;++u,++a)s[a]=n[u];e(void 0,i)}))}))}var f=e.length,u=9,c=Buffer.allocUnsafe(13+f);E(c,c.length-4,0),c[4]=v.READDIR;var h=i.writeReqid=(i.writeReqid+1)%w;return E(c,h,5),E(c,f,u),e.copy(c,u+=4),i.requests[h]={cb:n?function(e,t){if(e)return r(e);for(var n=t.length-1;n>=0;--n)"."!==t[n].filename&&".."!==t[n].filename||t.splice(n,1);r(void 0,t)}:r},this.debug("DEBUG[SFTP]: Outgoing: Writing READDIR"),this.push(c)},R.prototype.fstat=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");var r=this._state,n=e.length,i=9,o=Buffer.allocUnsafe(13+n);E(o,o.length-4,0),o[4]=v.FSTAT;var s=r.writeReqid=(r.writeReqid+1)%w;return E(o,s,5),E(o,n,i),e.copy(o,i+=4),r.requests[s]={cb:t},this.debug("DEBUG[SFTP]: Outgoing: Writing FSTAT"),this.push(o)},R.prototype.stat=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");var r=this._state,n=Buffer.byteLength(e),i=9,o=Buffer.allocUnsafe(13+n);E(o,o.length-4,0),o[4]=v.STAT;var s=r.writeReqid=(r.writeReqid+1)%w;return E(o,s,5),E(o,n,i),o.write(e,i+=4,n,"utf8"),r.requests[s]={cb:t},this.debug("DEBUG[SFTP]: Outgoing: Writing STAT"),this.push(o)},R.prototype.lstat=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");var r=this._state,n=Buffer.byteLength(e),i=9,o=Buffer.allocUnsafe(13+n);E(o,o.length-4,0),o[4]=v.LSTAT;var s=r.writeReqid=(r.writeReqid+1)%w;return E(o,s,5),E(o,n,i),o.write(e,i+=4,n,"utf8"),r.requests[s]={cb:t},this.debug("DEBUG[SFTP]: Outgoing: Writing LSTAT"),this.push(o)},R.prototype.opendir=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");var r=this._state,n=Buffer.byteLength(e),i=9,o=Buffer.allocUnsafe(13+n);E(o,o.length-4,0),o[4]=v.OPENDIR;var s=r.writeReqid=(r.writeReqid+1)%w;return E(o,s,5),E(o,n,i),o.write(e,i+=4,n,"utf8"),r.requests[s]={cb:t},this.debug("DEBUG[SFTP]: Outgoing: Writing OPENDIR"),this.push(o)},R.prototype.setstat=function(e,t,r){if(this.server)throw new Error("Client-only method called in server mode");var n=0,i=0,o=this._state;"object"==typeof t&&null!==t?(n=(t=U(t)).flags,i=t.nbytes,t=t.bytes):"function"==typeof t&&(r=t);var s=Buffer.byteLength(e),a=9,f=Buffer.allocUnsafe(13+s+4+i);E(f,f.length-4,0),f[4]=v.SETSTAT;var u=o.writeReqid=(o.writeReqid+1)%w;if(E(f,u,5),E(f,s,a),f.write(e,a+=4,s,"utf8"),E(f,n,a+=s),n){a+=4;for(var c=0,h=t.length;c<h;++c)for(var l=0,p=t[c].length;l<p;++l)f[a++]=t[c][l]}return o.requests[u]={cb:r},this.debug("DEBUG[SFTP]: Outgoing: Writing SETSTAT"),this.push(f)},R.prototype.fsetstat=function(e,t,r){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");var n=0,i=0,o=this._state;"object"==typeof t&&null!==t?(n=(t=U(t)).flags,i=t.nbytes,t=t.bytes):"function"==typeof t&&(r=t);var s=e.length,a=9,f=Buffer.allocUnsafe(13+s+4+i);E(f,f.length-4,0),f[4]=v.FSETSTAT;var u=o.writeReqid=(o.writeReqid+1)%w;if(E(f,u,5),E(f,s,a),e.copy(f,a+=4),E(f,n,a+=s),n){a+=4;for(var c=0,h=t.length;c<h;++c)for(var l=0,p=t[c].length;l<p;++l)f[a++]=t[c][l]}return o.requests[u]={cb:r},this.debug("DEBUG[SFTP]: Outgoing: Writing FSETSTAT"),this.push(f)},R.prototype.futimes=function(e,t,r,n){return this.fsetstat(e,{atime:B(t),mtime:B(r)},n)},R.prototype.utimes=function(e,t,r,n){return this.setstat(e,{atime:B(t),mtime:B(r)},n)},R.prototype.fchown=function(e,t,r,n){return this.fsetstat(e,{uid:t,gid:r},n)},R.prototype.chown=function(e,t,r,n){return this.setstat(e,{uid:t,gid:r},n)},R.prototype.fchmod=function(e,t,r){return this.fsetstat(e,{mode:t},r)},R.prototype.chmod=function(e,t,r){return this.setstat(e,{mode:t},r)},R.prototype.readlink=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");var r=this._state,n=Buffer.byteLength(e),i=9,o=Buffer.allocUnsafe(13+n);E(o,o.length-4,0),o[4]=v.READLINK;var s=r.writeReqid=(r.writeReqid+1)%w;return E(o,s,5),E(o,n,i),o.write(e,i+=4,n,"utf8"),r.requests[s]={cb:function(e,r){return e?t(e):r&&r.length?void t(void 0,r[0].filename):t(new Error("Response missing link info"))}},this.debug("DEBUG[SFTP]: Outgoing: Writing READLINK"),this.push(o)},R.prototype.symlink=function(e,t,r){if(this.server)throw new Error("Client-only method called in server mode");var n=this._state,i=Buffer.byteLength(t),o=Buffer.byteLength(e),s=9,a=Buffer.allocUnsafe(13+i+4+o);E(a,a.length-4,0),a[4]=v.SYMLINK;var f=n.writeReqid=(n.writeReqid+1)%w;return E(a,f,5),this._isOpenSSH?(E(a,o,s),a.write(e,s+=4,o,"utf8"),E(a,i,s+=o),a.write(t,s+=4,i,"utf8")):(E(a,i,s),a.write(t,s+=4,i,"utf8"),E(a,o,s+=i),a.write(e,s+=4,o,"utf8")),n.requests[f]={cb:r},this.debug("DEBUG[SFTP]: Outgoing: Writing SYMLINK"),this.push(a)},R.prototype.realpath=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");var r=this._state,n=Buffer.byteLength(e),i=9,o=Buffer.allocUnsafe(13+n);E(o,o.length-4,0),o[4]=v.REALPATH;var s=r.writeReqid=(r.writeReqid+1)%w;return E(o,s,5),E(o,n,i),o.write(e,i+=4,n,"utf8"),r.requests[s]={cb:function(e,r){return e?t(e):r&&r.length?void t(void 0,r[0].filename):t(new Error("Response missing path info"))}},this.debug("DEBUG[SFTP]: Outgoing: Writing REALPATH"),this.push(o)},R.prototype.ext_openssh_rename=function(e,t,r){var n=this._state;if(this.server)throw new Error("Client-only method called in server mode");if(!n.extensions["posix-rename@openssh.com"]||-1===n.extensions["posix-rename@openssh.com"].indexOf("1"))throw new Error("Server does not support this extended request");var i=Buffer.byteLength(e),o=Buffer.byteLength(t),s=9,a=Buffer.allocUnsafe(41+i+4+o);E(a,a.length-4,0),a[4]=v.EXTENDED;var f=n.writeReqid=(n.writeReqid+1)%w;return E(a,f,5),E(a,24,s),a.write("posix-rename@openssh.com",s+=4,24,"ascii"),E(a,i,s+=24),a.write(e,s+=4,i,"utf8"),E(a,o,s+=i),a.write(t,s+=4,o,"utf8"),n.requests[f]={cb:r},this.debug("DEBUG[SFTP]: Outgoing: Writing posix-rename@openssh.com"),this.push(a)},R.prototype.ext_openssh_statvfs=function(e,t){var r=this._state;if(this.server)throw new Error("Client-only method called in server mode");if(!r.extensions["statvfs@openssh.com"]||-1===r.extensions["statvfs@openssh.com"].indexOf("2"))throw new Error("Server does not support this extended request");var n=Buffer.byteLength(e),i=9,o=Buffer.allocUnsafe(36+n);E(o,o.length-4,0),o[4]=v.EXTENDED;var s=r.writeReqid=(r.writeReqid+1)%w;return E(o,s,5),E(o,19,i),o.write("statvfs@openssh.com",i+=4,19,"ascii"),E(o,n,i+=19),o.write(e,i+=4,n,"utf8"),r.requests[s]={extended:"statvfs@openssh.com",cb:t},this.debug("DEBUG[SFTP]: Outgoing: Writing statvfs@openssh.com"),this.push(o)},R.prototype.ext_openssh_fstatvfs=function(e,t){var r=this._state;if(this.server)throw new Error("Client-only method called in server mode");if(!r.extensions["fstatvfs@openssh.com"]||-1===r.extensions["fstatvfs@openssh.com"].indexOf("2"))throw new Error("Server does not support this extended request");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");var n=e.length,i=9,o=Buffer.allocUnsafe(37+n);E(o,o.length-4,0),o[4]=v.EXTENDED;var s=r.writeReqid=(r.writeReqid+1)%w;return E(o,s,5),E(o,20,i),o.write("fstatvfs@openssh.com",i+=4,20,"ascii"),E(o,n,i+=20),o.write(e,i+=4,n,"utf8"),r.requests[s]={extended:"fstatvfs@openssh.com",cb:t},this.debug("DEBUG[SFTP]: Outgoing: Writing fstatvfs@openssh.com"),this.push(o)},R.prototype.ext_openssh_hardlink=function(e,t,r){var n=this._state;if(this.server)throw new Error("Client-only method called in server mode");if(!n.extensions["hardlink@openssh.com"]||-1===n.extensions["hardlink@openssh.com"].indexOf("1"))throw new Error("Server does not support this extended request");var i=Buffer.byteLength(e),o=Buffer.byteLength(t),s=9,a=Buffer.allocUnsafe(37+i+4+o);E(a,a.length-4,0),a[4]=v.EXTENDED;var f=n.writeReqid=(n.writeReqid+1)%w;return E(a,f,5),E(a,20,s),a.write("hardlink@openssh.com",s+=4,20,"ascii"),E(a,i,s+=20),a.write(e,s+=4,i,"utf8"),E(a,o,s+=i),a.write(t,s+=4,o,"utf8"),n.requests[f]={cb:r},this.debug("DEBUG[SFTP]: Outgoing: Writing hardlink@openssh.com"),this.push(a)},R.prototype.ext_openssh_fsync=function(e,t){var r=this._state;if(this.server)throw new Error("Client-only method called in server mode");if(!r.extensions["fsync@openssh.com"]||-1===r.extensions["fsync@openssh.com"].indexOf("1"))throw new Error("Server does not support this extended request");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");var n=e.length,i=9,o=Buffer.allocUnsafe(34+n);E(o,o.length-4,0),o[4]=v.EXTENDED;var s=r.writeReqid=(r.writeReqid+1)%w;return E(o,s,5),E(o,17,i),o.write("fsync@openssh.com",i+=4,17,"ascii"),E(o,n,i+=17),o.write(e,i+=4,n,"utf8"),r.requests[s]={cb:t},this.debug("DEBUG[SFTP]: Outgoing: Writing fsync@openssh.com"),this.push(o)},R.prototype.status=function(e,t,r,n){if(!this.server)throw new Error("Server-only method called in client mode");if(!g[t]||"number"!=typeof t)throw new Error("Bad status code: "+t);r||(r=""),n||(n="");var i=Buffer.byteLength(r),o=Buffer.byteLength(n),s=Buffer.allocUnsafe(17+i+4+o);return E(s,s.length-4,0),s[4]=y.STATUS,E(s,e,5),E(s,t,9),E(s,i,13),i&&s.write(r,17,i,"utf8"),E(s,o,17+i),o&&s.write(n,17+i+4,o,"ascii"),this.debug("DEBUG[SFTP]: Outgoing: Writing STATUS"),this.push(s)},R.prototype.handle=function(e,t){if(!this.server)throw new Error("Server-only method called in client mode");if(!Buffer.isBuffer(t))throw new Error("handle is not a Buffer");var r=t.length;if(r>256)throw new Error("handle too large (> 256 bytes)");var n=Buffer.allocUnsafe(13+r);return E(n,n.length-4,0),n[4]=y.HANDLE,E(n,e,5),E(n,r,9),r&&t.copy(n,13),this.debug("DEBUG[SFTP]: Outgoing: Writing HANDLE"),this.push(n)},R.prototype.data=function(e,t,r){if(!this.server)throw new Error("Server-only method called in client mode");var n=Buffer.isBuffer(t);if(!n&&"string"!=typeof t)throw new Error("data is not a Buffer or string");n||r||(r="utf8");var i=n?t.length:Buffer.byteLength(t,r),o=Buffer.allocUnsafe(13+i);return E(o,o.length-4,0),o[4]=y.DATA,E(o,e,5),E(o,i,9),i&&(n?t.copy(o,13):o.write(t,13,i,r)),this.debug("DEBUG[SFTP]: Outgoing: Writing DATA"),this.push(o)},R.prototype.name=function(e,t){if(!this.server)throw new Error("Server-only method called in client mode");if(!Array.isArray(t)){if("object"!=typeof t||null===t)throw new Error("names is not an object or array");t=[t]}var r,n,i,o,s,a,f,u,c,h,l,p,d=t.length,g=0,m=[];for(h=0;h<d;++h)i=(n=t[h])&&n.filename&&"string"==typeof n.filename?n.filename:"",g+=4+Buffer.byteLength(i),o=n&&n.longname&&"string"==typeof n.longname?n.longname:"",g+=4+Buffer.byteLength(o),"object"==typeof n.attrs&&null!==n.attrs?(g+=4+(r=U(n.attrs)).nbytes,m.push(r)):(g+=4,m.push(null));for(u=Buffer.allocUnsafe(13+g),E(u,u.length-4,0),u[4]=y.NAME,E(u,e,5),E(u,d,9),c=13,h=0;h<d;++h)if(i=(n=t[h])&&n.filename&&"string"==typeof n.filename?n.filename:"",a=Buffer.byteLength(i),E(u,a,c),c+=4,a&&(u.write(i,c,a,"utf8"),c+=a),o=n&&n.longname&&"string"==typeof n.longname?n.longname:"",a=Buffer.byteLength(o),E(u,a,c),c+=4,a&&(u.write(o,c,a,"utf8"),c+=a),s=m[h]){if(E(u,s.flags,c),c+=4,s.flags&&s.bytes){var v=s.bytes;for(l=0,a=v.length;l<a;++l)for(p=0,f=v[l].length;p<f;++p)u[c++]=v[l][p]}}else E(u,0,c),c+=4;return this.debug("DEBUG[SFTP]: Outgoing: Writing NAME"),this.push(u)},R.prototype.attrs=function(e,t){if(!this.server)throw new Error("Server-only method called in client mode");if("object"!=typeof t||null===t)throw new Error("attrs is not an object");var r=U(t),n=Buffer.allocUnsafe(13+r.nbytes),i=13;if(E(n,n.length-4,0),n[4]=y.ATTRS,E(n,e,5),E(n,r.flags,9),r.flags&&r.bytes)for(var o=r.bytes,s=0,a=o.length;s<a;++s)for(var f=0,u=o[s].length;f<u;++f)n[i++]=o[s][f];return this.debug("DEBUG[SFTP]: Outgoing: Writing ATTRS"),this.push(n)};var C={r:_.READ,"r+":_.READ|_.WRITE,w:_.TRUNC|_.CREAT|_.WRITE,wx:_.TRUNC|_.CREAT|_.WRITE|_.EXCL,xw:_.TRUNC|_.CREAT|_.WRITE|_.EXCL,"w+":_.TRUNC|_.CREAT|_.READ|_.WRITE,"wx+":_.TRUNC|_.CREAT|_.READ|_.WRITE|_.EXCL,"xw+":_.TRUNC|_.CREAT|_.READ|_.WRITE|_.EXCL,a:_.APPEND|_.CREAT|_.WRITE,ax:_.APPEND|_.CREAT|_.WRITE|_.EXCL,xa:_.APPEND|_.CREAT|_.WRITE|_.EXCL,"a+":_.APPEND|_.CREAT|_.READ|_.WRITE,"ax+":_.APPEND|_.CREAT|_.READ|_.WRITE|_.EXCL,"xa+":_.APPEND|_.CREAT|_.READ|_.WRITE|_.EXCL},P=Object.keys(C);function D(e){var t=C[e];return void 0!==t?t:null}function H(e){this.mode=e&&e.mode,this.permissions=this.mode,this.uid=e&&e.uid,this.gid=e&&e.gid,this.size=e&&e.size,this.atime=e&&e.atime,this.mtime=e&&e.mtime}R.stringToFlags=D,R.flagsToString=function(e){for(var t=0;t<P.length;++t){var r=P[t];if(C[r]===e)return r}return null},H.prototype._checkModeProperty=function(e){return(this.mode&s.S_IFMT)===e},H.prototype.isDirectory=function(){return this._checkModeProperty(s.S_IFDIR)},H.prototype.isFile=function(){return this._checkModeProperty(s.S_IFREG)},H.prototype.isBlockDevice=function(){return this._checkModeProperty(s.S_IFBLK)},H.prototype.isCharacterDevice=function(){return this._checkModeProperty(s.S_IFCHR)},H.prototype.isSymbolicLink=function(){return this._checkModeProperty(s.S_IFLNK)},H.prototype.isFIFO=function(){return this._checkModeProperty(s.S_IFIFO)},H.prototype.isSocket=function(){return this._checkModeProperty(s.S_IFSOCK)},R.Stats=H;var x,M=r(9821),K=M.validateNumber,F=M.destroyImpl,G=M.ERR_OUT_OF_RANGE,q=M.ERR_INVALID_ARG_TYPE,X=[];function W(e,t){if(!Number.isSafeInteger(e)){if(K(e,t),!Number.isInteger(e))throw new G(t,"an integer",e);throw new G(t,">= 0 and <= 2 ** 53 - 1",e)}if(e<0)throw new G(t,">= 0 and <= 2 ** 53 - 1",e)}function j(e){return e+7&-8}function V(e,t,r){if(void 0===r)r={};else if("string"==typeof r)r={encoding:r};else{if(null===r||"object"!=typeof r)throw new TypeError('"options" argument must be a string or an object');r=Object.create(r)}if(void 0===r.highWaterMark&&(r.highWaterMark=65536),r.emitClose=!1,i.call(this,r),this.path=t,this.flags=void 0===r.flags?"r":r.flags,this.mode=void 0===r.mode?438:r.mode,this.start=r.start,this.end=r.end,this.autoClose=void 0===r.autoClose||r.autoClose,this.pos=0,this.bytesRead=0,this.closed=!1,this.handle=void 0===r.handle?null:r.handle,this.sftp=e,this._opening=!1,void 0!==this.start&&(W(this.start,"start"),this.pos=this.start),void 0===this.end)this.end=1/0;else if(this.end!==1/0&&(W(this.end,"end"),void 0!==this.start&&this.start>this.end))throw new G("start",`<= "end" (here: ${this.end})`,this.start);this.on("end",(function(){this.autoClose&&this.destroy()})),Buffer.isBuffer(this.handle)||this.open()}function Y(e,t,r){if(!e.handle)return n();function n(n){t(n=n||r),e.closed=!0,n||e.emit("close")}e.sftp.close(e.handle,n)}function Q(e,t,r){if(void 0===r)r={};else if("string"==typeof r)r={encoding:r};else{if(null===r||"object"!=typeof r)throw new TypeError('"options" argument must be a string or an object');r=Object.create(r)}r.emitClose=!1,o.call(this,r),this.path=t,this.flags=void 0===r.flags?"w":r.flags,this.mode=void 0===r.mode?438:r.mode,this.start=r.start,this.autoClose=void 0===r.autoClose||r.autoClose,this.pos=0,this.bytesWritten=0,this.closed=!1,this.handle=void 0===r.handle?null:r.handle,this.sftp=e,this._opening=!1,void 0!==this.start&&(W(this.start,"start"),this.pos=this.start),r.encoding&&this.setDefaultEncoding(r.encoding),this.on("finish",(function(){this._writableState.finalCalled||this.autoClose&&this.destroy()})),Buffer.isBuffer(this.handle)||this.open()}f(V,i),V.prototype.open=function(){this._opening||(this._opening=!0,this.sftp.open(this.path,this.flags,this.mode,((e,t)=>{if(this._opening=!1,e)return this.emit("error",e),void(this.autoClose&&this.destroy());this.handle=t,this.emit("open",t),this.emit("ready"),this.read()})))},V.prototype._read=function(e){if(!Buffer.isBuffer(this.handle))return this.once("open",(function(){this._read(e)}));if(!this.destroyed){var t;(!x||x.length-x.used<128)&&(t=this.readableHighWaterMark||this._readableState.highWaterMark,(x=X.length>0?X.pop():Buffer.allocUnsafe(t)).used=0);var r=x,n=Math.min(x.length-x.used,e),i=x.used;if(void 0!==this.end&&(n=Math.min(this.end-this.pos+1,n)),n<=0)return this.push(null);this.sftp.readData(this.handle,x,x.used,n,this.pos,((e,t)=>{if(e)return this.emit("error",e),void(this.autoClose&&this.destroy());var o=null;if(i+n===r.used&&r===x){var s=r.used+t-n;r.used=j(s)}else{var a=i+n&-8,f=j(i+t);a-f>=128&&X.push(r.slice(f,a))}t>0&&(this.bytesRead+=t,o=r.slice(i,i+t)),this.pos+=t,this.push(o)})),x.used=j(x.used+n)}},"function"!=typeof i.prototype.destroy&&(V.prototype.destroy=F),V.prototype._destroy=function(e,t){!this._opening||Buffer.isBuffer(this.handle)?(Y(this,t,e),this.handle=null,this._opening=!1):this.once("open",Y.bind(null,this,t,e))},V.prototype.close=function(e){this.destroy(null,e)},Object.defineProperty(V.prototype,"pending",{get(){return null===this.handle},configurable:!0}),f(Q,o),Q.prototype._final=function(e){this.autoClose&&this.destroy(),e()},Q.prototype.open=function(){this._opening||(this._opening=!0,this.sftp.open(this.path,this.flags,this.mode,((e,t)=>{if(this._opening=!1,e)return this.emit("error",e),void(this.autoClose&&this.destroy());this.handle=t;var r=e=>{if(e)this.sftp.chmod(this.path,this.mode,(e=>{r()}));else if("a"!==this.flags[0])this.emit("open",t),this.emit("ready");else{var n=(e,r)=>{e?this.sftp.stat(this.path,((t,r)=>{if(t)return this.destroy(),void this.emit("error",e);n(null,r)})):(this.pos=r.size,this.emit("open",t),this.emit("ready"))};this.sftp.fstat(t,n)}};this.sftp.fchmod(t,this.mode,r)})))},Q.prototype._write=function(e,t,r){if(!Buffer.isBuffer(e)){const t=new q("data","Buffer",e);return this.emit("error",t)}if(!Buffer.isBuffer(this.handle))return this.once("open",(function(){this._write(e,t,r)}));this.sftp.writeData(this.handle,e,0,e.length,this.pos,((e,t)=>{if(e)return this.autoClose&&this.destroy(),r(e);this.bytesWritten+=t,r()})),this.pos+=e.length},Q.prototype._writev=function(e,t){if(!Buffer.isBuffer(this.handle))return this.once("open",(function(){this._writev(e,t)}));for(var r=this.sftp,n=this.handle,i=e.length,o=(e,r)=>{if(e)return this.destroy(),t(e);this.bytesWritten+=r,0==--i&&t()},s=0;s<e.length;++s){var a=e[s].chunk;r.writeData(n,a,0,a.length,this.pos,o),this.pos+=a.length}},"function"!=typeof o.prototype.destroy&&(Q.prototype.destroy=V.prototype.destroy),Q.prototype._destroy=V.prototype._destroy,Q.prototype.close=function(e){if(e){if(this.closed)return void process.nextTick(e);this.on("close",e)}this.autoClose||this.on("finish",this.destroy.bind(this)),this.end()},Q.prototype.destroySoon=Q.prototype.end,Object.defineProperty(Q.prototype,"pending",{get(){return null===this.handle},configurable:!0}),e.exports=R},4184:(e,t,r)=>{var n=r(6663),i=r(8021),o=r(1784).Transform,s=r(1422).inherits,a=r(1422).inspect,f=r(1301),u=r(476).Ber,c=r(33).readUInt32BE,h=r(33).writeUInt32BE,l=r(1399),p=r(8013),d=p.iv_inc,E=p.readString,g=p.readInt,m=p.DSASigBERToBare,v=p.ECDSASigASN1ToSSH,y=p.sigSSHToASN1,_=r(8819).parseDERKey,w=l.CIPHER_INFO,b=l.HMAC_INFO,S=l.MESSAGE,A=(l.DYNAMIC_KEXDH_MESSAGE,l.KEXDH_MESSAGE,l.ALGORITHMS),T=l.DISCONNECT_REASON,R=l.CHANNEL_OPEN_FAILURE,N=l.SSH_TO_OPENSSL,I=l.TERMINAL_MODE,O=l.SIGNALS,k=(l.EDDSA_SUPPORTED,l.CURVE25519_SUPPORTED),U=l.BUGS,B=l.BUGGY_IMPLS,L=B.length,C=r(5129).i8,P=0,D=P++,H=P++,x=P++,M=P++,K=P++,F=P++,G=P++,q=P++,X=P++,W=P++,j=P++,V=4294967295,Y=i.Z_PARTIAL_FLUSH,Q={flush:Y},z=/\x00/g,$=Buffer.from("SSH-"),Z=Buffer.allocUnsafe(0),J=Buffer.allocUnsafe(9),ee=Buffer.from([S.GLOBAL_REQUEST,0,0,0,21,107,101,101,112,97,108,105,118,101,64,111,112,101,110,115,115,104,46,99,111,109,1]),te=Buffer.from([S.NEWKEYS]),re=Buffer.from([S.USERAUTH_SUCCESS]),ne=Buffer.from([S.REQUEST_SUCCESS]),ie=Buffer.from([S.REQUEST_FAILURE]),oe=Buffer.from([I.TTY_OP_END]),se=Buffer.from([S.KEXDH_GEX_REQUEST,0,0,4,0,0,0,16,0,0,0,32,0]);function ae(e){}function fe(e){"object"==typeof e&&null!==e||(e={}),o.call(this,{highWaterMark:"number"==typeof e.highWaterMark?e.highWaterMark:32768}),this._needContinue=!1,this.bytesSent=this.bytesReceived=0,this.debug="function"==typeof e.debug?e.debug:ae,this.server=!0===e.server,this.maxPacketSize="number"==typeof e.maxPacketSize?e.maxPacketSize:35e3,this.remoteBugs=0,this.server&&(this.remoteBugs=U.BAD_DHGEX),this.readable=!0;var t=this,r=e.hostKeys;if(this.server&&("object"!=typeof r||null===r))throw new Error("hostKeys must be an object keyed on host key type");if(this.config={hostKeys:r,ident:"SSH-2.0-"+(e.ident||"ssh2js"+C+(this.server?"srv":"")),algorithms:{kex:A.KEX,kexBuf:A.KEX_BUF,serverHostKey:A.SERVER_HOST_KEY,serverHostKeyBuf:A.SERVER_HOST_KEY_BUF,cipher:A.CIPHER,cipherBuf:A.CIPHER_BUF,hmac:A.HMAC,hmacBuf:A.HMAC_BUF,compress:A.COMPRESS,compressBuf:A.COMPRESS_BUF}},this.config.ident.replace(z,""),this.config.ident.length+2>255)throw new Error("ident too long");if("object"==typeof e.algorithms&&null!==e.algorithms){var i=e.algorithms;Array.isArray(i.kex)&&i.kex.length>0&&(this.config.algorithms.kex=i.kex,Buffer.isBuffer(i.kexBuf)||(i.kexBuf=Buffer.from(i.kex.join(","),"ascii")),this.config.algorithms.kexBuf=i.kexBuf),Array.isArray(i.serverHostKey)&&i.serverHostKey.length>0&&(this.config.algorithms.serverHostKey=i.serverHostKey,Buffer.isBuffer(i.serverHostKeyBuf)||(i.serverHostKeyBuf=Buffer.from(i.serverHostKey.join(","),"ascii")),this.config.algorithms.serverHostKeyBuf=i.serverHostKeyBuf),Array.isArray(i.cipher)&&i.cipher.length>0&&(this.config.algorithms.cipher=i.cipher,Buffer.isBuffer(i.cipherBuf)||(i.cipherBuf=Buffer.from(i.cipher.join(","),"ascii")),this.config.algorithms.cipherBuf=i.cipherBuf),Array.isArray(i.hmac)&&i.hmac.length>0&&(this.config.algorithms.hmac=i.hmac,Buffer.isBuffer(i.hmacBuf)||(i.hmacBuf=Buffer.from(i.hmac.join(","),"ascii")),this.config.algorithms.hmacBuf=i.hmacBuf),Array.isArray(i.compress)&&i.compress.length>0&&(this.config.algorithms.compress=i.compress,Buffer.isBuffer(i.compressBuf)||(i.compressBuf=Buffer.from(i.compress.join(","),"ascii")),this.config.algorithms.compressBuf=i.compressBuf)}this.reset(!0),this.on("end",(function(){t.readable=!1,t._state=void 0,t.reset(),t._state.outgoing.bufSeqno=void 0})),this.on("DISCONNECT",(function(e,r,n,i){!function(e,t,r,n,i){if(r!==T.BY_APPLICATION){var o=new Error(n||t);o.code=r,e.emit("error",o)}e.reset()}(t,e,r,n)})),this.on("KEXINIT",(function(e,r){!function(e,t,r){var n=e._state,i=n.outgoing;function o(){!0===function(e,t,r){var n,i,o,s,a=e._state,f=a.incoming,u=a.outgoing,c=e.debug;c("DEBUG: Comparing KEXINITs ...");var h=e.config.algorithms,l=h.kex;if(e.remoteBugs&U.BAD_DHGEX)for(var p=!1,d=l.length-1;d>=0;--d)-1!==l[d].indexOf("group-exchange")&&(p||(l=l.slice(),p=!0),l.splice(d,1));for(c("DEBUG: (local) KEX algorithms: "+l),c("DEBUG: (remote) KEX algorithms: "+t.algorithms.kex),e.server?(n=l,i=t.algorithms.kex):(n=t.algorithms.kex,i=l),s=0,o=i.length;s<o&&-1===n.indexOf(i[s]);++s);if(s===o)return c("DEBUG: No matching key exchange algorithm"),(E=new Error("Handshake failed: no matching key exchange algorithm")).level="handshake",e.emit("error",E),e.disconnect(T.KEY_EXCHANGE_FAILED),!1;var E,g=i[s];for(c("DEBUG: KEX algorithm: "+g),!r||t.algorithms.kex.length&&g===t.algorithms.kex[0]||(f.ignoreNext=!0),c("DEBUG: (local) Host key formats: "+h.serverHostKey),c("DEBUG: (remote) Host key formats: "+t.algorithms.srvHostKey),e.server?(n=h.serverHostKey,i=t.algorithms.srvHostKey):(n=t.algorithms.srvHostKey,i=h.serverHostKey),s=0,o=i.length;s<o&&-1===n.indexOf(i[s]);++s);if(s===o)return c("DEBUG: No matching host key format"),(E=new Error("Handshake failed: no matching host key format")).level="handshake",e.emit("error",E),e.disconnect(T.KEY_EXCHANGE_FAILED),!1;for(a.hostkeyFormat=i[s],c("DEBUG: Host key format: "+a.hostkeyFormat),c("DEBUG: (local) Client->Server ciphers: "+h.cipher),c("DEBUG: (remote) Client->Server ciphers: "+t.algorithms.cs.encrypt),e.server?(n=h.cipher,i=t.algorithms.cs.encrypt):(n=t.algorithms.cs.encrypt,i=h.cipher),s=0,o=i.length;s<o&&-1===n.indexOf(i[s]);++s);if(s===o)return c("DEBUG: No matching Client->Server cipher"),(E=new Error("Handshake failed: no matching client->server cipher")).level="handshake",e.emit("error",E),e.disconnect(T.KEY_EXCHANGE_FAILED),!1;for(c("DEBUG: Client->Server Cipher: "+(e.server?f.decrypt.type=i[s]:u.encrypt.type=i[s])),c("DEBUG: (local) Server->Client ciphers: "+h.cipher),c("DEBUG: (remote) Server->Client ciphers: "+t.algorithms.sc.encrypt),e.server?(n=h.cipher,i=t.algorithms.sc.encrypt):(n=t.algorithms.sc.encrypt,i=h.cipher),s=0,o=i.length;s<o&&-1===n.indexOf(i[s]);++s);if(s===o)return c("DEBUG: No matching Server->Client cipher"),(E=new Error("Handshake failed: no matching server->client cipher")).level="handshake",e.emit("error",E),e.disconnect(T.KEY_EXCHANGE_FAILED),!1;for(c("DEBUG: Server->Client Cipher: "+(e.server?u.encrypt.type=i[s]:f.decrypt.type=i[s])),c("DEBUG: (local) Client->Server HMAC algorithms: "+h.hmac),c("DEBUG: (remote) Client->Server HMAC algorithms: "+t.algorithms.cs.mac),e.server?(n=h.hmac,i=t.algorithms.cs.mac):(n=t.algorithms.cs.mac,i=h.hmac),s=0,o=i.length;s<o&&-1===n.indexOf(i[s]);++s);if(s===o)return c("DEBUG: No matching Client->Server HMAC algorithm"),(E=new Error("Handshake failed: no matching client->server HMAC")).level="handshake",e.emit("error",E),e.disconnect(T.KEY_EXCHANGE_FAILED),!1;for(c("DEBUG: Client->Server HMAC algorithm: "+(e.server?f.hmac.type=i[s]:u.hmac.type=i[s])),c("DEBUG: (local) Server->Client HMAC algorithms: "+h.hmac),c("DEBUG: (remote) Server->Client HMAC algorithms: "+t.algorithms.sc.mac),e.server?(n=h.hmac,i=t.algorithms.sc.mac):(n=t.algorithms.sc.mac,i=h.hmac),s=0,o=i.length;s<o&&-1===n.indexOf(i[s]);++s);if(s===o)return c("DEBUG: No matching Server->Client HMAC algorithm"),(E=new Error("Handshake failed: no matching server->client HMAC")).level="handshake",e.emit("error",E),e.disconnect(T.KEY_EXCHANGE_FAILED),!1;for(c("DEBUG: Server->Client HMAC algorithm: "+(e.server?u.hmac.type=i[s]:f.hmac.type=i[s])),c("DEBUG: (local) Client->Server compression algorithms: "+h.compress),c("DEBUG: (remote) Client->Server compression algorithms: "+t.algorithms.cs.compress),e.server?(n=h.compress,i=t.algorithms.cs.compress):(n=t.algorithms.cs.compress,i=h.compress),s=0,o=i.length;s<o&&-1===n.indexOf(i[s]);++s);if(s===o)return c("DEBUG: No matching Client->Server compression algorithm"),(E=new Error("Handshake failed: no matching client->server compression algorithm")).level="handshake",e.emit("error",E),e.disconnect(T.KEY_EXCHANGE_FAILED),!1;for(c("DEBUG: Client->Server compression algorithm: "+(e.server?f.decompress.type=i[s]:u.compress.type=i[s])),c("DEBUG: (local) Server->Client compression algorithms: "+h.compress),c("DEBUG: (remote) Server->Client compression algorithms: "+t.algorithms.sc.compress),e.server?(n=h.compress,i=t.algorithms.sc.compress):(n=t.algorithms.sc.compress,i=h.compress),s=0,o=i.length;s<o&&-1===n.indexOf(i[s]);++s);return s===o?(c("DEBUG: No matching Server->Client compression algorithm"),(E=new Error("Handshake failed: no matching server->client compression algorithm")).level="handshake",e.emit("error",E),e.disconnect(T.KEY_EXCHANGE_FAILED),!1):(c("DEBUG: Server->Client compression algorithm: "+(e.server?u.compress.type=i[s]:f.decompress.type=i[s])),a.kex=new Ne(g),a.kex.generateKeys(),u.pubkey=a.kex.getPublicKey(),!0)}(e,t,r)&&(e.server?n.incoming.expectedPacket=n.kex.pktInit:"groupex"===n.kex.type?function(e){e._state.incoming.expectedPacket="KEXDH_GEX_GROUP",e.debug("DEBUG: Outgoing: Writing KEXDH_GEX_REQUEST"),be(e,se,void 0,!0)}(e):ye(e))}i.status===W?(e.debug("DEBUG: Received re-key request"),i.status=j,i.kexinit=void 0,ve(e,o)):o()}(t,e,r)})),this.on("NEWKEYS",(function(){ce(t)})),this.server?this.on("KEXDH_INIT",(function(e){!function(e,t){!function(e,t){var r=e._state,i=r.outgoing,o=r.incoming,s=e.config.hostKeys[r.hostkeyFormat];Array.isArray(s)&&(s=s[0]);var a=s.getPublicSSH(),f=s.type;t=r.kex.convertPublicKey(t);var u=r.kex.computeSecret(t);if(u instanceof Error)return u.message="Error while computing DH secret ("+r.kex.type+"): "+u.message,u.level="handshake",e.emit("error",u),e.disconnect(T.KEY_EXCHANGE_FAILED),!1;var c,l,p,d,E=n.createHash(r.kex.hash),g=Buffer.byteLength(o.identRaw),m=Buffer.byteLength(e.config.ident),v=o.kexinit.length,y=i.kexinit.length,_=a.length,w=t.length,b=i.pubkey.length,A=u.length,R=g+m+v+y+_+w+b+A+32,N=r.kex.getDHParams();N&&(p=N.prime,d=N.generator,R+=12,R+=8,R+=c=p.length,R+=l=d.length);var I=0,O=Buffer.allocUnsafe(R);h(O,g,I),I+=4,O.write(o.identRaw,I,"utf8"),h(O,m,I+=g),I+=4,O.write(e.config.ident,I,"utf8"),h(O,v,I+=m),I+=4,o.kexinit.copy(O,I),I+=v,o.kexinit=void 0,h(O,y,I),I+=4,i.kexinit.copy(O,I),I+=y,i.kexinit=void 0,h(O,_,I),I+=4,a.copy(O,I),I+=_,N&&(se.slice(1).copy(O,I),h(O,c,I+=12),I+=4,p.copy(O,I),h(O,l,I+=c),I+=4,d.copy(O,I),I+=l),h(O,w,I),I+=4,t.copy(O,I),h(O,b,I+=w),I+=4,i.pubkey.copy(O,I),h(O,A,I+=b),I+=4,u.copy(O,I),i.exchangeHash=E.update(O).digest(),void 0===i.sessionId&&(i.sessionId=i.exchangeHash),i.kexsecret=u;var k=s.sign(i.exchangeHash);if(k instanceof Error)return k.message="Error while signing data with host key ("+f+"): "+k.message,k.level="handshake",e.emit("error",k),e.disconnect(T.KEY_EXCHANGE_FAILED),!1;if(!1===(k=Te(k,f)))return k.message="Error while converting handshake signature",k.level="handshake",e.emit("error",k),e.disconnect(T.KEY_EXCHANGE_FAILED),!1;var U=4+f.length+4+k.length,B=Buffer.allocUnsafe(5+_+4+b+4+U);B[I=0]=S[r.kex.pktReply],++I,h(B,_,I),I+=4,a.copy(B,I),h(B,b,I+=_),I+=4,i.pubkey.copy(B,I),h(B,U,I+=b),I+=4,h(B,f.length,I),I+=4,B.write(f,I,f.length,"ascii"),I+=f.length,h(B,k.length,I),I+=4,k.copy(B,I),r.incoming.expectedPacket="NEWKEYS",e.debug("DEBUG: Outgoing: Writing "+r.kex.pktReply),be(e,B,void 0,!0),i.sentNEWKEYS=!0,e.debug("DEBUG: Outgoing: Writing NEWKEYS"),be(e,te,void 0,!0)}(e,t)}(t,e)})):this.on("KEXDH_REPLY",(function(e){ue(t,e)})).on("KEXDH_GEX_GROUP",(function(e,r){!function(e,t,r){var n=e._state,i=n.outgoing;n.kex.setDHParams(t,r),n.kex.generateKeys(),i.pubkey=n.kex.getPublicKey(),ye(e)}(t,e,r)})),this.server&&("string"==typeof e.greeting&&e.greeting.length&&("\r\n"===e.greeting.slice(-2)?this.push(e.greeting):this.push(e.greeting+"\r\n")),"string"==typeof e.banner&&e.banner.length&&("\r\n"===e.banner.slice(-2)?this.banner=e.banner:this.banner=e.banner+"\r\n")),this.debug("DEBUG: Local ident: "+a(this.config.ident)),this.push(this.config.ident+"\r\n"),this._state.incoming.expectedPacket="KEXINIT"}function ue(e,t,r){var i=e._state,o=i.incoming,s=i.outgoing,a=e.debug;if(void 0===r){o.expectedPacket="NEWKEYS",s.sentNEWKEYS=!1,a("DEBUG: Checking host key format");var f=E(t.hostkey,0,"ascii",e);if(!1===f)return!1;if(t.hostkey_format!==i.hostkeyFormat||t.hostkey_format!==f)return a("DEBUG: Host key format mismatch"),e.disconnect(T.KEY_EXCHANGE_FAILED),e.reset(),(P=new Error("Handshake failed: host key format mismatch")).level="handshake",e.emit("error",P),!1;a("DEBUG: Checking signature format");var u=E(t.sig,0,"ascii",e);if(!1===u)return!1;if(t.sig_format!==u)return a("DEBUG: Signature format mismatch"),e.disconnect(T.KEY_EXCHANGE_FAILED),e.reset(),(P=new Error("Handshake failed: signature format mismatch")).level="handshake",e.emit("error",P),!1}if(s.status===X){if(void 0===r){a("DEBUG: Verifying host fingerprint");var c=!0,l=e.emit("fingerprint",t.hostkey,(function(n){void 0===r&&(r=!!n,c||ue(e,t,r))}));if(c=!1,l&&void 0===r)return}if(void 0===r)a("DEBUG: Host accepted by default (no verification)");else{if(!0!==r)return a("DEBUG: Host denied via fingerprint verification"),e.disconnect(T.KEY_EXCHANGE_FAILED),e.reset(),(P=new Error("Handshake failed: host fingerprint verification failed")).level="handshake",e.emit("error",P),!1;a("DEBUG: Host accepted (verified)")}}if(t.pubkey=i.kex.convertPublicKey(t.pubkey),t.secret=i.kex.computeSecret(t.pubkey),t.secret instanceof Error)return t.secret.message="Error while computing DH secret ("+i.kex.type+"): "+t.secret.message,t.secret.level="handshake",e.emit("error",t.secret),e.disconnect(T.KEY_EXCHANGE_FAILED),!1;var p,d,g,m,v=n.createHash(i.kex.hash),w=Buffer.byteLength(e.config.ident),b=Buffer.byteLength(o.identRaw),S=s.kexinit.length,A=o.kexinit.length,R=t.hostkey.length,N=s.pubkey.length,I=t.pubkey.length,O=t.secret.length,k=w+b+S+A+R+N+I+O+32,U=i.kex.getDHParams();U&&(g=U.prime,m=U.generator,k+=12,k+=8,k+=p=g.length,k+=d=m.length);var B=0,L=Buffer.allocUnsafe(k);h(L,w,B),B+=4,L.write(e.config.ident,B,"utf8"),h(L,b,B+=w),B+=4,L.write(o.identRaw,B,"utf8"),h(L,S,B+=b),B+=4,s.kexinit.copy(L,B),B+=S,s.kexinit=void 0,h(L,A,B),B+=4,o.kexinit.copy(L,B),B+=A,o.kexinit=void 0,h(L,R,B),B+=4,t.hostkey.copy(L,B),B+=R,U&&(se.slice(1).copy(L,B),h(L,p,B+=12),B+=4,g.copy(L,B),h(L,d,B+=p),B+=4,m.copy(L,B),B+=d),h(L,N,B),B+=4,s.pubkey.copy(L,B),h(L,I,B+=N),B+=4,t.pubkey.copy(L,B),h(L,O,B+=I),B+=4,t.secret.copy(L,B),s.exchangeHash=v.update(L).digest();var C=E(t.sig,t.sig._pos,e);if(!1===C||!(C=y(C,t.sig_format,e)))return!1;var P,D=_(t.hostkey,t.sig_format);return!(D instanceof Error)&&(a("DEBUG: Verifying signature"),!0!==D.verify(s.exchangeHash,C)?(a("DEBUG: Signature verification failed"),e.disconnect(T.KEY_EXCHANGE_FAILED),e.reset(),(P=new Error("Handshake failed: signature verification failed")).level="handshake",e.emit("error",P),!1):(void 0===s.sessionId&&(s.sessionId=s.exchangeHash),s.kexsecret=t.secret,a("DEBUG: Outgoing: Writing NEWKEYS"),s.status===j?be(e,te,void 0,!0):be(e,te),s.sentNEWKEYS=!0,void(void 0!==r&&void 0===o.expectedPacket&&ce(e))))}function ce(e){var t=e._state,r=t.outgoing,o=t.incoming;if(o.expectedPacket=void 0,r.sentNEWKEYS){var s,a,f=r.kexsecret.length,u=r.encrypt.info=w[r.encrypt.type],c=0,l=t.kex.hash,p=Buffer.allocUnsafe(4+f);if(t.authsQueue=[],h(p,f,c),c+=4,r.kexsecret.copy(p,c),r.kexsecret=void 0,u.stream)s=Z;else{for(s=n.createHash(l).update(p).update(r.exchangeHash).update(e.server?"B":"A","ascii").update(r.sessionId).digest();s.length<u.ivLen;)s=Buffer.concat([s,n.createHash(l).update(p).update(r.exchangeHash).update(s).digest()]);s.length>u.ivLen&&(s=s.slice(0,u.ivLen))}for(a=n.createHash(l).update(p).update(r.exchangeHash).update(e.server?"D":"C","ascii").update(r.sessionId).digest();a.length<u.keyLen;)a=Buffer.concat([a,n.createHash(l).update(p).update(r.exchangeHash).update(a).digest()]);if(a.length>u.keyLen&&(a=a.slice(0,u.keyLen)),u.authLen>0)r.encrypt.iv=s,r.encrypt.key=a,r.encrypt.instance=!0;else{var d=N[r.encrypt.type];r.encrypt.instance=n.createCipheriv(d,a,s),r.encrypt.instance.setAutoPadding(!1)}var E=o.decrypt.info=w[o.decrypt.type];if(E.stream)s=Z;else{for(s=n.createHash(l).update(p).update(r.exchangeHash).update(e.server?"A":"B","ascii").update(r.sessionId).digest();s.length<E.ivLen;)s=Buffer.concat([s,n.createHash(l).update(p).update(r.exchangeHash).update(s).digest()]);s.length>E.ivLen&&(s=s.slice(0,E.ivLen))}for(o.decrypt.buf=Buffer.allocUnsafe(E.blockLen),a=n.createHash(l).update(p).update(r.exchangeHash).update(e.server?"C":"D","ascii").update(r.sessionId).digest();a.length<E.keyLen;)a=Buffer.concat([a,n.createHash(l).update(p).update(r.exchangeHash).update(a).digest()]);a.length>E.keyLen&&(a=a.slice(0,E.keyLen));var g,m=N[o.decrypt.type];o.decrypt.instance=n.createDecipheriv(m,a,s),o.decrypt.instance.setAutoPadding(!1),o.decrypt.iv=s,o.decrypt.key=a,u.discardLen>0&&(g=Buffer.alloc(u.discardLen),r.encrypt.instance.update(g)),E.discardLen>0&&(g&&g.length===E.discardLen||(g=Buffer.alloc(u.discardLen)),o.decrypt.instance.update(g));var v=r.hmac.info=b[r.hmac.type],y=o.hmac.info=b[o.hmac.type];if(0===u.authLen){for(a=n.createHash(l).update(p).update(r.exchangeHash).update(e.server?"F":"E","ascii").update(r.sessionId).digest();a.length<v.len;)a=Buffer.concat([a,n.createHash(l).update(p).update(r.exchangeHash).update(a).digest()]);a.length>v.len&&(a=a.slice(0,v.len)),r.hmac.key=a}else r.hmac.key=void 0;if(0===E.authLen){for(a=n.createHash(l).update(p).update(r.exchangeHash).update(e.server?"E":"F","ascii").update(r.sessionId).digest();a.length<y.len;)a=Buffer.concat([a,n.createHash(l).update(p).update(r.exchangeHash).update(a).digest()]);a.length>y.len&&(a=a.slice(0,y.len)),o.hmac.key=a}else o.hmac.key=void 0;var _=E.authLen||o.hmac.info.actualLen;if(o.hmac.buf&&o.hmac.buf.length===_||(o.hmac.buf=Buffer.allocUnsafe(_)),r.exchangeHash=void 0,"zlib"===r.compress.type?(r.compress.instance=i.createDeflate(Q),r.compress.queue=[]):"none"===r.compress.type&&(r.compress.instance=!1,r.compress.queue=null),"zlib"===o.decompress.type?o.decompress.instance=i.createInflate(Q):"none"===o.decompress.type&&(o.decompress.instance=!1),e.bytesSent=e.bytesReceived=0,r.status===j){r.status=W;var S=r.rekeyQueue,A=S.length,T=0;for(r.rekeyQueue=[];T<A;++T)Buffer.isBuffer(S[T])?be(e,S[T]):be(e,S[T][0],S[T][1]);A=(S=o.rekeyQueue).length,T=0,o.rekeyQueue=[];for(var R=o.seqno;T<A;++T){if(o.seqno=S[T][0],o.payload=S[T][1],!1===le(e))return;if(o.status===D)return}o.seqno=R}else r.status=W,o.status===K&&(e.debug("DEBUG: Parser: IN_PACKETBEFORE (update) (expecting "+E.blockLen+")"),ge(e,2,E.blockLen,o.decrypt.buf)),e.emit("ready")}}function he(e,t){var r=e._state.kex;if(r)switch(t){case 30:return r.pktInit;case 31:switch(r.type){case"group":return"KEXDH_REPLY";case"groupex":return"KEXDH_GEX_GROUP";default:return"KEXECDH_REPLY"}break;case 33:if("groupex"===r.type)return"KEXDH_GEX_REPLY"}return S[t]}function le(e,t){var r,n,o,s,a,f,u,l,p,d,m,v,_,w,b=e._state.incoming,A=e._state.outgoing,N=b.payload,O=b.seqno;if(++b.seqno>V&&(b.seqno=0),b.ignoreNext)return e.debug("DEBUG: Parser: Packet ignored"),void(b.ignoreNext=!1);var k=N[0];if(void 0===k)return!1;if(A.status!==W&&he(e,k)!==b.expectedPacket&&k<1&&k>4){e.debug("DEBUG: Parser: IN_PACKETDATAAFTER, expected: "+b.expectedPacket+" but got: "+he(e,k)),e.disconnect(T.PROTOCOL_ERROR);var B=new Error("Received unexpected packet");return B.level="protocol",e.emit("error",B),!1}if(k===S.CHANNEL_DATA){if(!1===(a=g(N,1,e,t)))return!1;if(!1===(f=E(N,5,e,t,32768)))return!1;e.debug("DEBUG: Parser: IN_PACKETDATAAFTER, packet: CHANNEL_DATA ("+a+")"),e.emit("CHANNEL_DATA:"+a,f)}else if(k===S.CHANNEL_EXTENDED_DATA){if(!1===(a=g(N,1,e,t)))return!1;var L=g(N,5,e,t);if(!1===L)return!1;if(!1===(f=E(N,9,e,t)))return!1;e.debug("DEBUG: Parser: IN_PACKETDATAAFTER, packet: CHANNEL_EXTENDED_DATA ("+a+")"),e.emit("CHANNEL_EXTENDED_DATA:"+a,L,f)}else if(k===S.CHANNEL_WINDOW_ADJUST){if(!1===(a=g(N,1,e,t)))return!1;var C=g(N,5,e,t);if(!1===C)return!1;e.debug("DEBUG: Parser: IN_PACKETDATAAFTER, packet: CHANNEL_WINDOW_ADJUST ("+a+", "+C+")"),e.emit("CHANNEL_WINDOW_ADJUST:"+a,C)}else if(k===S.CHANNEL_SUCCESS){if(!1===(a=g(N,1,e,t)))return!1;e.debug("DEBUG: Parser: IN_PACKETDATAAFTER, packet: CHANNEL_SUCCESS ("+a+")"),e.emit("CHANNEL_SUCCESS:"+a)}else if(k===S.CHANNEL_FAILURE){if(!1===(a=g(N,1,e,t)))return!1;e.debug("DEBUG: Parser: IN_PACKETDATAAFTER, packet: CHANNEL_FAILURE ("+a+")"),e.emit("CHANNEL_FAILURE:"+a)}else if(k===S.CHANNEL_EOF){if(!1===(a=g(N,1,e,t)))return!1;e.debug("DEBUG: Parser: IN_PACKETDATAAFTER, packet: CHANNEL_EOF ("+a+")"),e.emit("CHANNEL_EOF:"+a)}else if(k===S.CHANNEL_OPEN){var P,D=E(N,1,"ascii",e,t);if(!1===D)return!1;if(!1===(p=g(N,N._pos,e,t)))return!1;if(!1===(d=g(N,N._pos+=4,e,t)))return!1;if(!1===(m=g(N,N._pos+=4,e,t)))return!1;if(e.debug("DEBUG: Parser: IN_PACKETDATAAFTER, packet: CHANNEL_OPEN ("+p+", "+D+")"),"forwarded-tcpip"===D||"direct-tcpip"===D){var H=E(N,N._pos+=4,"ascii",e,t);if(!1===H)return!1;var x=g(N,N._pos,e,t);if(!1===x)return!1;if(!1===(u=E(N,N._pos+=4,"ascii",e,t)))return!1;if(!1===(l=g(N,N._pos,e,t)))return!1;P={type:D,sender:p,window:d,packetSize:m,data:{destIP:H,destPort:x,srcIP:u,srcPort:l}}}else if("forwarded-streamlocal@openssh.com"===D||"direct-streamlocal@openssh.com"===D){if(!1===(w=E(N,N._pos+=4,"utf8",e,t)))return!1;P={type:D,sender:p,window:d,packetSize:m,data:{socketPath:w}}}else if("x11"===D){if(!1===(u=E(N,N._pos+=4,"ascii",e,t)))return!1;if(!1===(l=g(N,N._pos,e,t)))return!1;P={type:D,sender:p,window:d,packetSize:m,data:{srcIP:u,srcPort:l}}}else P={type:D,sender:p,window:d,packetSize:m,data:{}};e.emit("CHANNEL_OPEN",P)}else if(k===S.CHANNEL_OPEN_CONFIRMATION){if(!1===(v=g(N,1,e,t)))return!1;if(!1===(p=g(N,5,e,t)))return!1;if(!1===(d=g(N,9,e,t)))return!1;if(!1===(m=g(N,13,e,t)))return!1;s={recipient:v,sender:p,window:d,packetSize:m},N.length>17&&(s.data=N.slice(17)),e.emit("CHANNEL_OPEN_CONFIRMATION:"+s.recipient,s)}else if(k===S.CHANNEL_OPEN_FAILURE){if(!1===(v=g(N,1,e,t)))return!1;var M=g(N,5,e,t);if(!1===M)return!1;if(!1===(_=E(N,9,"utf8",e,t)))return!1;if(!1===(n=E(N,N._pos,"utf8",e,t)))return!1;N._pos=9,s={recipient:v,reasonCode:M,reason:R[M],description:_,lang:n},e.emit("CHANNEL_OPEN_FAILURE:"+s.recipient,s)}else if(k===S.CHANNEL_CLOSE){if(!1===(a=g(N,1,e,t)))return!1;e.debug("DEBUG: Parser: IN_PACKETDATAAFTER, packet: CHANNEL_CLOSE ("+a+")"),e.emit("CHANNEL_CLOSE:"+a)}else if(k===S.IGNORE);else if(k===S.DISCONNECT){var K=g(N,1,e,t);if(!1===K)return!1;var F=T[K];if(!1===(_=E(N,5,"utf8",e,t)))return!1;N._pos<N.length&&(n=E(N,N._pos,"ascii",e,t)),e.debug("DEBUG: Parser: IN_PACKETDATAAFTER, packet: DISCONNECT ("+F+")"),e.emit("DISCONNECT",F,K,_,n)}else if(k===S.DEBUG){if(!1===(o=E(N,2,"utf8",e,t)))return!1;if(!1===(n=E(N,N._pos,"ascii",e,t)))return!1;e.emit("DEBUG",o,n)}else if(k===S.NEWKEYS)e.emit("NEWKEYS");else if(k===S.SERVICE_REQUEST){if(!1===(r=E(N,1,"ascii",e,t)))return!1;e.emit("SERVICE_REQUEST",r)}else if(k===S.SERVICE_ACCEPT){if(!1===(r=E(N,1,"ascii",e,t)))return!1;e.emit("SERVICE_ACCEPT",r)}else if(k===S.USERAUTH_REQUEST){var G=E(N,1,"utf8",e,t);if(!1===G)return!1;var q=E(N,N._pos,"ascii",e,t);if(!1===q)return!1;var X,j,Y=E(N,N._pos,"ascii",e,t);if(!1===Y)return!1;if("password"===Y){if(!1===(X=E(N,N._pos+1,"utf8",e,t)))return!1}else if("publickey"===Y||"hostbased"===Y){var z,$,Z,J,ee,te,re;if("publickey"===Y){if(void 0===(z=N[N._pos++]))return!1;z=0!==z}if(!1===($=E(N,N._pos,"ascii",e,t)))return!1;if(!1===(Z=E(N,N._pos,e,t)))return!1;if(z||"hostbased"===Y){if("hostbased"===Y){if(!1===(te=E(N,N._pos,"ascii",e,t)))return!1;if(!1===(re=E(N,N._pos,"utf8",e,t)))return!1}var ne=N._pos;if(!1===(J=E(N,ne,e,t)))return!1;if(J.length>4+$.length+4&&J.toString("ascii",4,4+$.length)===$&&(J=J.slice(4+$.length+4)),!1===(J=y(J,$,e,t)))return!1;ee=Buffer.allocUnsafe(4+A.sessionId.length+ne),h(ee,A.sessionId.length,0),A.sessionId.copy(ee,4),N.copy(ee,4+A.sessionId.length,0,ne)}else j="publickey -- check";X={keyAlgo:$,key:Z,signature:J,blob:ee,localHostname:te,localUsername:re}}else if("keyboard-interactive"===Y){var ie=g(N,N._pos,e,t);if(!1===ie)return!1;if(!1===(X=E(N,N._pos+4+ie,"utf8",e,t)))return!1}else"none"!==Y&&(X=N.slice(N._pos));void 0===j&&(j=Y),e.debug("DEBUG: Parser: IN_PACKETDATAAFTER, packet: USERAUTH_REQUEST ("+j+")"),e._state.authsQueue.push(Y),e.emit("USERAUTH_REQUEST",G,q,Y,X)}else if(k===S.USERAUTH_SUCCESS)"zlib@openssh.com"===A.compress.type&&(A.compress.instance=i.createDeflate(Q),A.compress.queue=[]),"zlib@openssh.com"===b.decompress.type&&(b.decompress.instance=i.createInflate(Q)),e._state.authsQueue.shift(),e.emit("USERAUTH_SUCCESS");else if(k===S.USERAUTH_FAILURE){var oe=E(N,1,"ascii",e,t);if(!1===oe)return!1;var se=N[N._pos];if(void 0===se)return!1;se=0!==se,oe=oe.split(","),e._state.authsQueue.shift(),e.emit("USERAUTH_FAILURE",oe,se)}else if(k===S.USERAUTH_BANNER){if(!1===(o=E(N,1,"utf8",e,t)))return!1;if(!1===(n=E(N,N._pos,"utf8",e,t)))return!1;e.emit("USERAUTH_BANNER",o,n)}else if(k===S.GLOBAL_REQUEST){var ae=E(N,1,"ascii",e,t);if(!1===ae)return e.debug("DEBUG: Parser: IN_PACKETDATAAFTER, packet: GLOBAL_REQUEST"),!1;e.debug("DEBUG: Parser: IN_PACKETDATAAFTER, packet: GLOBAL_REQUEST ("+ae+")");var fe,ue=N[N._pos++];if(void 0===ue)return!1;if(ue=0!==ue,"tcpip-forward"===ae||"cancel-tcpip-forward"===ae){var ce=E(N,N._pos,"ascii",e,t);if(!1===ce)return!1;var le=g(N,N._pos,e,t);if(!1===le)return!1;fe={bindAddr:ce,bindPort:le}}else if("streamlocal-forward@openssh.com"===ae||"cancel-streamlocal-forward@openssh.com"===ae){if(!1===(w=E(N,N._pos,"utf8",e,t)))return!1;fe={socketPath:w}}else"no-more-sessions@openssh.com"===ae||(fe=N.slice(N._pos));e.emit("GLOBAL_REQUEST",ae,ue,fe)}else if(k===S.REQUEST_SUCCESS)N.length>1?e.emit("REQUEST_SUCCESS",N.slice(1)):e.emit("REQUEST_SUCCESS");else if(k===S.REQUEST_FAILURE)e.emit("REQUEST_FAILURE");else if(k===S.UNIMPLEMENTED);else{if(k===S.KEXINIT)return function(e,t){var r,n=e._state.incoming,i=n.payload,o={algorithms:{kex:void 0,srvHostKey:void 0,cs:{encrypt:void 0,mac:void 0,compress:void 0},sc:{encrypt:void 0,mac:void 0,compress:void 0}},languages:{cs:void 0,sc:void 0}};if(!1===(r=me(i,17,e,t)))return!1;if(o.algorithms.kex=r,!1===(r=me(i,i._pos,e,t)))return!1;if(o.algorithms.srvHostKey=r,!1===(r=me(i,i._pos,e,t)))return!1;if(o.algorithms.cs.encrypt=r,!1===(r=me(i,i._pos,e,t)))return!1;if(o.algorithms.sc.encrypt=r,!1===(r=me(i,i._pos,e,t)))return!1;if(o.algorithms.cs.mac=r,!1===(r=me(i,i._pos,e,t)))return!1;if(o.algorithms.sc.mac=r,!1===(r=me(i,i._pos,e,t)))return!1;if(o.algorithms.cs.compress=r,!1===(r=me(i,i._pos,e,t)))return!1;if(o.algorithms.sc.compress=r,!1===(r=me(i,i._pos,e,t)))return!1;if(o.languages.cs=r,!1===(r=me(i,i._pos,e,t)))return!1;o.languages.sc=r;var s=i._pos<i.length&&1===i[i._pos];n.kexinit=i,e.emit("KEXINIT",o,s)}(e,t);if(k===S.CHANNEL_REQUEST)return function(e,t){var r,n,i,o,s,a,f,u=e._state.incoming.payload,h=g(u,1,e,t);if(!1===h)return!1;var l=E(u,5,"ascii",e,t);if(!1===l)return!1;if("exit-status"===l){var p=g(u,++u._pos,e,t);if(!1===p)return!1;r={recipient:h,request:l,wantReply:!1,code:p}}else if("exit-signal"===l){var d;if(e.remoteBugs&U.OLD_EXIT){if(!1===(f=g(u,++u._pos,e,t)))return!1;switch(f){case 1:f="HUP";break;case 2:f="INT";break;case 3:f="QUIT";break;case 6:f="ABRT";break;case 9:f="KILL";break;case 14:f="ALRM";break;case 15:f="TERM";break;default:f="UNKNOWN ("+f+")"}d=!1}else{if(!1===(f=E(u,++u._pos,"ascii",e,t)))return!1;if(void 0===(d=u[u._pos++]))return!1;d=0!==d}var m=E(u,u._pos,"utf8",e,t);if(!1===m)return!1;var v=E(u,u._pos,"utf8",e,t);if(!1===v)return!1;r={recipient:h,request:l,wantReply:!1,signal:f,coredump:d,description:m,lang:v}}else if("pty-req"===l){if(void 0===(a=u[u._pos++]))return!1;a=0!==a;var y=E(u,u._pos,"ascii",e,t);if(!1===y)return!1;if(!1===(n=g(u,u._pos,e,t)))return!1;if(!1===(i=g(u,u._pos+=4,e,t)))return!1;if(!1===(o=g(u,u._pos+=4,e,t)))return!1;if(!1===(s=g(u,u._pos+=4,e,t)))return!1;var _=E(u,u._pos+=4,e,t);if(!1===_)return!1;r={recipient:h,request:l,wantReply:a,term:y,cols:n,rows:i,width:o,height:s,modes:_=function(e){for(var t,r={},n=0,i=e.length;n<i&&!((t=e[n])===I.TTY_OP_END||void 0===I[t]||n+5>i);n+=5)r[I[t]]=c(e,n+1);return r}(_)}}else if("window-change"===l){if(!1===(n=g(u,++u._pos,e,t)))return!1;if(!1===(i=g(u,u._pos+=4,e,t)))return!1;if(!1===(o=g(u,u._pos+=4,e,t)))return!1;if(!1===(s=g(u,u._pos+=4,e,t)))return!1;r={recipient:h,request:l,wantReply:!1,cols:n,rows:i,width:o,height:s}}else if("x11-req"===l){if(void 0===(a=u[u._pos++]))return!1;a=0!==a;var w=u[u._pos++];if(void 0===w)return!1;w=0!==w;var b=E(u,u._pos,"ascii",e,t);if(!1===b)return!1;var S=E(u,u._pos,"binary",e,t);if(!1===S)return!1;var A=g(u,u._pos,e,t);if(!1===A)return!1;r={recipient:h,request:l,wantReply:a,single:w,protocol:b,cookie:S,screen:A}}else if("env"===l){if(void 0===(a=u[u._pos++]))return!1;a=0!==a;var T=E(u,u._pos,"utf8",e,t);if(!1===T)return!1;var R=E(u,u._pos,"utf8",e,t);if(!1===R)return!1;r={recipient:h,request:l,wantReply:a,key:T,val:R}}else if("shell"===l){if(void 0===(a=u[u._pos]))return!1;r={recipient:h,request:l,wantReply:a=0!==a}}else if("exec"===l){if(void 0===(a=u[u._pos++]))return!1;a=0!==a;var N=E(u,u._pos,"utf8",e,t);if(!1===N)return!1;r={recipient:h,request:l,wantReply:a,command:N}}else if("subsystem"===l){if(void 0===(a=u[u._pos++]))return!1;a=0!==a;var O=E(u,u._pos,"utf8",e,t);if(!1===O)return!1;r={recipient:h,request:l,wantReply:a,subsystem:O}}else if("signal"===l){if(!1===(f=E(u,++u._pos,"ascii",e,t)))return!1;r={recipient:h,request:l,wantReply:!1,signal:"SIG"+f}}else if("xon-xoff"===l){var k=u[++u._pos];if(void 0===k)return!1;r={recipient:h,request:l,wantReply:!1,clientControl:k=0!==k}}else if("auth-agent-req@openssh.com"===l){if(void 0===(a=u[u._pos]))return!1;r={recipient:h,request:l,wantReply:a=0!==a}}else{if(void 0===(a=u[u._pos]))return!1;r={recipient:h,request:l,wantReply:a=0!==a}}e.debug("DEBUG: Parser: IN_PACKETDATAAFTER, packet: CHANNEL_REQUEST ("+h+", "+l+")"),e.emit("CHANNEL_REQUEST:"+h,r)}(e,t);if(k>=30&&k<=49)return function(e,t,r){var n=e._state,i=n.incoming,o=i.payload;if(n.outgoing.status===W||he(e,t)!==i.expectedPacket)return e.debug("DEBUG: Parser: IN_PACKETDATAAFTER, expected: "+i.expectedPacket+" but got: "+he(e,t)),e.disconnect(T.PROTOCOL_ERROR),(s=new Error("Received unexpected packet")).level="protocol",e.emit("error",s),!1;if("groupex"===n.kex.type){var s;if(e.server)return e.disconnect(T.PROTOCOL_ERROR),(s=new Error("DH group exchange not supported by server")).level="handshake",e.emit("error",s),!1;if(t===S.KEXDH_GEX_GROUP){var a=E(o,1,e,r);if(!1===a)return!1;var f=E(o,o._pos,e,r);if(!1===f)return!1;e.emit("KEXDH_GEX_GROUP",a,f)}else if(t===S.KEXDH_GEX_REPLY)return pe(e,r)}else if(t===S.KEXDH_INIT){var u=E(o,1,e,r);if(!1===u)return!1;e.emit("KEXDH_INIT",u)}else if(t===S.KEXDH_REPLY)return pe(e,r)}(e,k,t);if(k>=60&&k<=70)return function(e,t,r){var n,i,o,s=e._state,a=s.authsQueue[0],f=s.incoming.payload;if("password"===a){if(t===S.USERAUTH_PASSWD_CHANGEREQ){if(!1===(n=E(f,1,"utf8",e,r)))return!1;if(!1===(i=E(f,f._pos,"utf8",e,r)))return!1;e.emit("USERAUTH_PASSWD_CHANGEREQ",n,i)}}else if("keyboard-interactive"===a){if(t===S.USERAUTH_INFO_REQUEST){var u,c,h;if(!1===(u=E(f,1,"utf8",e,r)))return!1;if(!1===(c=E(f,f._pos,"utf8",e,r)))return!1;if(!1===(i=E(f,f._pos,"utf8",e,r)))return!1;if(!1===(h=g(f,f._pos,e,r)))return!1;f._pos+=4;for(var l=[],p=0;p<h;++p){if(!1===(o=E(f,f._pos,"utf8",e,r)))return!1;var d=f[f._pos++];if(void 0===d)return!1;d=0!==d,l.push({prompt:o,echo:d})}e.emit("USERAUTH_INFO_REQUEST",u,c,i,l)}else if(t===S.USERAUTH_INFO_RESPONSE){var m=g(f,1,e,r);if(!1===m)return!1;f._pos=5;for(var v=[],y=0;y<m;++y){if(!1===(o=E(f,f._pos,"utf8",e,r)))return!1;v.push(o)}e.emit("USERAUTH_INFO_RESPONSE",v)}}else if("publickey"===a){if(t===S.USERAUTH_PK_OK){var _=e._state.authsQueue;if(!_.length||"publickey"!==_[0])return;_.shift(),e.emit("USERAUTH_PK_OK")}}else if(void 0!==a){e.disconnect(T.PROTOCOL_ERROR);var w=new Error("Invalid authentication method: "+a);w.level="protocol",e.emit("error",w)}}(e,k,t);var de=Buffer.allocUnsafe(5);de[0]=S.UNIMPLEMENTED,h(de,O,1),be(e,de)}}function pe(e,t){var r=e._state.incoming.payload,n=E(r,1,e,t);if(!1===n)return!1;var i=E(r,r._pos,e,t);if(!1===i)return!1;var o=E(r,r._pos,e,t);if(!1===o)return!1;var s={hostkey:n,hostkey_format:void 0,pubkey:i,sig:o,sig_format:void 0},a=E(n,0,"ascii",e,t);if(!1===a)return!1;s.hostkey_format=a;var f=E(o,0,"ascii",e,t);if(!1===f)return!1;s.sig_format=f,e.emit("KEXDH_REPLY",s)}function de(e,t){var r=e._state.incoming,i=r.hmac;if(e.debug("DEBUG: Parser: Verifying MAC"),r.decrypt.info.authLen>0){var o=r.decrypt,s=o.instance;s.setAuthTag(t);var a=s.update(r.packet);return r.payload=a.slice(1,r.packet.length-a[0]),d(o.iv),o.instance=n.createDecipheriv(N[o.type],o.key,o.iv),o.instance.setAutoPadding(!1),!0}var f=n.createHmac(N[i.type],i.key);h(J,r.seqno,0),h(J,r.pktLen,4),J[8]=r.padLen,f.update(J),f.update(r.packet);var u=f.digest();return u.length>r.hmac.info.actualLen&&(u=u.slice(0,r.hmac.info.actualLen)),Re(u,t)}function Ee(e,t){var r=e._state.incoming.decrypt.instance;return e.debug("DEBUG: Parser: Decrypting"),r.update(t)}function ge(e,t,r,n){var i=e._state.incoming.expect;i.amount=r,i.type=t,i.ptr=0,n?i.buf=n:r&&(i.buf=Buffer.allocUnsafe(r))}function me(e,t,r,n){var i=E(e,t,"ascii",r,n);return!1!==i&&(i.length?i.split(","):[])}function ve(e,t){return function(e,t){n.randomBytes(16,(function e(r,i){if(r)return n.randomBytes(16,e);t&&t(i)}))}(0,(function(r){var n=e.config.algorithms,i=n.kexBuf;if(e.remoteBugs&U.BAD_DHGEX){for(var o=!1,s=n.kex,a=s.length-1;a>=0;--a)-1!==s[a].indexOf("group-exchange")&&(o||(s=s.slice(),o=!0),s.splice(a,1));o&&(i=Buffer.from(s.join(",")))}var f=n.serverHostKeyBuf,u=21+i.length+4+f.length+2*(4+n.cipherBuf.length)+2*(4+n.hmacBuf.length)+2*(4+n.compressBuf.length)+8+1+4,c=Buffer.allocUnsafe(u),l=17;c[0]=S.KEXINIT,!1!==r&&r.copy(c,1),h(c,i.length,l),l+=4,i.copy(c,l),l+=i.length,h(c,f.length,l),l+=4,f.copy(c,l),l+=f.length,h(c,n.cipherBuf.length,l),l+=4,n.cipherBuf.copy(c,l),l+=n.cipherBuf.length,h(c,n.cipherBuf.length,l),l+=4,n.cipherBuf.copy(c,l),l+=n.cipherBuf.length,h(c,n.hmacBuf.length,l),l+=4,n.hmacBuf.copy(c,l),l+=n.hmacBuf.length,h(c,n.hmacBuf.length,l),l+=4,n.hmacBuf.copy(c,l),l+=n.hmacBuf.length,h(c,n.compressBuf.length,l),l+=4,n.compressBuf.copy(c,l),l+=n.compressBuf.length,h(c,n.compressBuf.length,l),l+=4,n.compressBuf.copy(c,l),l+=n.compressBuf.length,c.fill(0,c.length-13),e.debug("DEBUG: Outgoing: Writing KEXINIT"),e._state.incoming.expectedPacket="KEXINIT";var p=e._state.outgoing;p.kexinit=c,p.status===W&&(p.status=j),be(e,c,t,!0)})),!0}function ye(e){var t=e._state,r=t.outgoing,n=Buffer.allocUnsafe(5+r.pubkey.length);return t.incoming.expectedPacket=t.kex.pktReply,"groupex"===t.kex.type?(n[0]=S.KEXDH_GEX_INIT,e.debug("DEBUG: Outgoing: Writing KEXDH_GEX_INIT")):(n[0]=S.KEXDH_INIT,"group"===t.kex.type?e.debug("DEBUG: Outgoing: Writing KEXDH_INIT"):e.debug("DEBUG: Outgoing: Writing KEXECDH_INIT")),h(n,r.pubkey.length,1),r.pubkey.copy(n,5),be(e,n,void 0,!0)}function _e(e,t,r){var n=e._state.outgoing.compress.instance;n.write(t),n.flush(Y,we.bind(e,r))}function we(e){if(!this._readableState.ended&&!this._writableState.ended){Se(this,this._state.outgoing.compress.instance.read(),e);var t=this._state.outgoing.compress.queue;t.shift(),t.length>0&&_e(this,t[0][0],t[0][1])}}function be(e,t,r,n){var i=e._state;if(!i)return!1;var o=i.outgoing;if(o.status===j&&!n)return"function"==typeof r?o.rekeyQueue.push([t,r]):o.rekeyQueue.push(t),!1;if(e._readableState.ended||e._writableState.ended)return!1;if(o.compress.instance){var s=o.compress.queue;return s.push([t,r]),1===s.length&&_e(e,s[0][0],s[0][1]),!0}return Se(e,t,r)}function Se(e,t,r){var i,o,s,a,f,u=e._state.outgoing,c=u.encrypt,l=u.hmac;if(i=t.length+9,!1!==c.instance)if(c.info.authLen>0){for(var p=1+t.length+4;p%c.info.blockLen!=0;)++p;o=p-1-t.length,i=4+p}else{var E=c.info.blockLen;o=(i+=(E-1)*i%E)-t.length-5}else o=(i+=7*i%8)-t.length-5;s=Buffer.allocUnsafe(i),h(s,i-4,0),s[4]=o,t.copy(s,5),Ae(s,5+t.length,o),!1!==l.type&&l.key&&(a=n.createHmac(N[l.type],l.key),h(u.bufSeqno,u.seqno,0),a.update(u.bufSeqno),a.update(s),(a=a.digest()).length>l.info.actualLen&&(a=a.slice(0,l.info.actualLen)));var g,m=0;if(!1!==c.instance)if(c.info.authLen>0){var v=n.createCipheriv(N[c.type],c.key,c.iv);v.setAutoPadding(!1);var y=s.slice(0,4);v.setAAD(y),e.push(y),m+=y,g=v.update(s.slice(4)),e.push(g),m+=g.length;var _=v.final();_.length&&(e.push(_),m+=_.length);var w=v.getAuthTag();f=e.push(w),m+=w.length,d(c.iv)}else g=c.instance.update(s),e.push(g),m+=g.length,f=e.push(a),m+=a.length;else f=e.push(s),m=s.length;return e.bytesSent+=m,++u.seqno>V&&(u.seqno=0),r&&r(),f}s(fe,o),fe.prototype.__read=o.prototype._read,fe.prototype._read=function(e){return this._needContinue&&(this._needContinue=!1,this.emit("continue")),this.__read(e)},fe.prototype.__push=o.prototype.push,fe.prototype.push=function(e,t){var r=this.__push(e,t);return this._needContinue=!1===r,r},fe.prototype._cleanup=function(e){this.reset(),this.debug("DEBUG: Parser: Malformed packet"),e&&e(new Error("Malformed packet"))},fe.prototype._transform=function(e,t,r,n){var i,o,s,u,c=!1,h=!1,l=this._state,p=l.incoming,d=l.outgoing,E=p.expect,m=p.decrypt,v=p.decompress,y=e.length,_=0,w=this.debug,b=this,A=0,R=A;for(this.bytesReceived+=y;;){if(void 0!==E.type){if(A>=y)break;if(2===E.type){_=y-A;var N=E.buf.length-E.ptr;N<=_?(e.copy(E.buf,E.ptr,A,A+N),A+=N,o=E.buf,E.buf=void 0,E.ptr=0,E.type=void 0):(e.copy(E.buf,E.ptr,A),E.ptr+=_,A+=_);continue}if(0===E.type){if(A+=p.search.push(e),void 0!==E.type)continue}else if(1===E.type){if(4+ ++E.ptr>255)return this.reset(),w("DEBUG: Parser: Identification string exceeded 255 characters"),r(new Error("Max identification string size exceeded"));if(10!==e[A]){++A===y&&R<A&&(void 0===E.buf?E.buf=e.toString("ascii",R,A):E.buf+=e.toString("ascii",R,A));continue}E.type=void 0,R<A&&(void 0===E.buf?E.buf=e.toString("ascii",R,A):E.buf+=e.toString("ascii",R,A)),o=E.buf,E.buf=void 0,++A}}if(p.status===D){if(!this.readable)return r();if(this.server)if(o){if(83!==o[0]||83!==o[1]||72!==o[2]||45!==o[3])return this.reset(),w("DEBUG: Parser: Bad identification start"),r(new Error("Bad identification start"));p.status=H,w("DEBUG: Parser: IN_INIT (waiting for rest of identification)")}else w("DEBUG: Parser: IN_INIT (waiting for identification begin)"),ge(this,2,4);else{w("DEBUG: Parser: IN_INIT");var I=p.search=new f($);I.on("info",(function e(t,r,n,i){r&&(void 0===p.greeting?p.greeting=r.toString("binary",n,i):p.greeting+=r.toString("binary",n,i)),t&&(E.type=void 0,p.search.removeListener("info",e))})),I.maxMatches=1,ge(this,0),p.status=H}}else if(p.status===H)w("DEBUG: Parser: IN_GREETING"),p.search=void 0,R=A,ge(this,1),p.status=x;else{if(p.status===x){w("DEBUG: Parser: IN_HEADER"),13===o.charCodeAt(o.length-1)&&(o=o.slice(0,-1));var O=o.indexOf("-"),k=o.indexOf(" "),U={greeting:p.greeting,identRaw:"SSH-"+o,versions:{protocol:o.substr(0,O),software:-1===k?o.substring(O+1):o.substring(O+1,k)},comments:k>-1?o.substring(k+1):void 0};if(p.greeting=void 0,"1.99"!==U.versions.protocol&&"2.0"!==U.versions.protocol)return this.reset(),w("DEBUG: Parser: protocol version not supported: "+U.versions.protocol),r(new Error("Protocol version not supported"));if(this.emit("header",U),p.status===D)return;var C=U.identRaw,P=U.versions.software;this.debug("DEBUG: Remote ident: "+a(C));for(var X,Q=0;Q<L;++Q)"string"==typeof(X=B[Q])[0]?P===X[0]&&(this.remoteBugs|=X[1]):X[0].test(P)&&(this.remoteBugs|=X[1]);return p.identRaw=C,this.bytesReceived-=y-A,ve(this,(function(){A===y?r():b._transform(e.slice(A),t,r)})),void(p.status=M)}if(p.status===M)w("DEBUG: Parser: IN_PACKETBEFORE (expecting "+(i=m.instance?m.info.blockLen:8)+")"),ge(this,2,i,m.buf),p.status=K;else if(p.status===K){if(w("DEBUG: Parser: IN_PACKET"),m.instance?((h=m.info.authLen>0)||(o=Ee(this,o)),i=m.info.blockLen):(h=!1,i=8),!1===(u=g(o,0,this,r)))return;var z,J=p.hmac.info,ee=u+4+(z=J?J.actualLen:0),te=this.maxPacketSize;if(v.instance&&(te+=5*(this.maxPacketSize/16384+1)+6),u>te||ee<16+z||(u+(h?0:4))%i!=0)return this.disconnect(T.PROTOCOL_ERROR),w("DEBUG: Parser: Bad packet length ("+ee+")"),r(new Error("Bad packet length"));p.pktLen=u;var re=p.pktLen+4-i;if(h?(m.instance.setAAD(o.slice(0,4)),w("DEBUG: Parser: pktLen:"+p.pktLen+",remainLen:"+re)):(p.padLen=o[4],w("DEBUG: Parser: pktLen:"+p.pktLen+",padLen:"+p.padLen+",remainLen:"+re)),re>0)p.pktExtra=h?o.slice(4):o.slice(5),ge(this,2,re),p.status=F;else{if(!(re<0)){c=!0,p.status=F;continue}p.status=M}}else if(p.status===F){w("DEBUG: Parser: IN_PACKETDATA"),m.instance?(h=m.info.authLen>0,c?c=!1:h||(o=Ee(this,o))):(h=!1,c=!1);var ne=p.pktLen-p.padLen-1;if(p.pktExtra?(s=Buffer.allocUnsafe(p.pktExtra.length+o.length),p.pktExtra.copy(s),o.copy(s,p.pktExtra.length),p.payload=s.slice(0,ne)):(s=h?o.slice(4):o.slice(5),p.payload=o.slice(5,5+ne)),void 0!==p.hmac.info){var ie=m.info.authLen||p.hmac.info.actualLen;w("DEBUG: Parser: HMAC size:"+ie),ge(this,2,ie,p.hmac.buf),p.status=G,p.packet=s}else p.status=q;p.pktExtra=void 0,s=void 0}else if(p.status===G){if(w("DEBUG: Parser: IN_PACKETDATAVERIFY"),!de(this,o))return this.reset(),w("DEBUG: Parser: IN_PACKETDATAVERIFY (Invalid HMAC)"),r(new Error("Invalid HMAC"));w("DEBUG: Parser: IN_PACKETDATAVERIFY (Valid HMAC)"),p.status=q,p.packet=void 0}else if(p.status===q){if(v.instance){if(!n){w("DEBUG: Parser: Decompressing"),v.instance.write(p.payload);var oe=[],se=0;return void v.instance.on("readable",(function(){for(var e;e=this.read();)oe.push(e),se+=e.length})).flush(Y,(function(){var n;v.instance.removeAllListeners("readable"),1===oe.length?p.payload=oe[0]:p.payload=Buffer.concat(oe,se),oe=null,n=A===y?Z:e.slice(A),b._transform(n,t,r,!0)}))}n=!1}this.emit("packet");var fe=p.payload[0];if(w!==ae){var ue="DEBUG: Parser: IN_PACKETDATAAFTER, packet: ",ce=l.authsQueue[0],he=null;if(d.status!==j||fe<=4||fe>=20&&fe<=49||(ue+="(enqueued) "),fe===S.KEXDH_INIT)switch(l.kex.type){case"group":he="KEXDH_INIT";break;case"groupex":he="KEXDH_GEX_REQUEST";break;default:he="KEXECDH_INIT"}else if(fe===S.KEXDH_REPLY)switch(l.kex.type){case"group":he="KEXDH_REPLY";break;case"groupex":he="KEXDH_GEX_GROUP";break;default:he="KEXECDH_REPLY"}else fe===S.KEXDH_GEX_GROUP?he="KEXDH_GEX_GROUP":fe===S.KEXDH_GEX_REPLY?he="KEXDH_GEX_REPLY":60===fe?he="password"===ce?"USERAUTH_PASSWD_CHANGEREQ":"keyboard-interactive"===ce?"USERAUTH_INFO_REQUEST":"publickey"===ce?"USERAUTH_PK_OK":"UNKNOWN PACKET 60":61===fe&&(he="keyboard-interactive"===ce?"USERAUTH_INFO_RESPONSE":"UNKNOWN PACKET 61");null===he&&(he=S[fe]),fe!==S.CHANNEL_OPEN&&fe!==S.CHANNEL_REQUEST&&fe!==S.CHANNEL_SUCCESS&&fe!==S.CHANNEL_FAILURE&&fe!==S.CHANNEL_EOF&&fe!==S.CHANNEL_CLOSE&&fe!==S.CHANNEL_DATA&&fe!==S.CHANNEL_EXTENDED_DATA&&fe!==S.CHANNEL_WINDOW_ADJUST&&fe!==S.DISCONNECT&&fe!==S.USERAUTH_REQUEST&&fe!==S.GLOBAL_REQUEST&&w(ue+he)}if(d.status===W||fe<=4||fe>=20&&fe<=49){if(!1===le(this,r))return;if(p.status===D)return}else if(d.status===j){if(50===p.rekeyQueue.length)return w("DEBUG: Parser: Max incoming re-key queue length reached"),this.disconnect(T.PROTOCOL_ERROR),r(new Error("Incoming re-key queue length limit reached"));var pe=p.seqno;++p.seqno>V&&(p.seqno=0),p.rekeyQueue.push([pe,p.payload])}p.status=M,p.payload=void 0}}void 0!==o&&(o=void 0)}r()},fe.prototype.reset=function(e){if(this._state){var t=this._state;t.incoming.status=D,t.outgoing.status=X}else this._state={authsQueue:[],hostkeyFormat:void 0,kex:void 0,incoming:{status:D,expectedPacket:void 0,search:void 0,greeting:void 0,seqno:0,pktLen:void 0,padLen:void 0,pktExtra:void 0,payload:void 0,packet:void 0,kexinit:void 0,identRaw:void 0,rekeyQueue:[],ignoreNext:!1,expect:{amount:void 0,type:void 0,ptr:0,buf:void 0},decrypt:{instance:!1,info:void 0,iv:void 0,key:void 0,buf:void 0,type:void 0},hmac:{info:void 0,key:void 0,buf:void 0,type:!1},decompress:{instance:!1,type:!1}},outgoing:{status:X,seqno:0,bufSeqno:Buffer.allocUnsafe(4),rekeyQueue:[],kexinit:void 0,kexsecret:void 0,pubkey:void 0,exchangeHash:void 0,sessionId:void 0,sentNEWKEYS:!1,encrypt:{instance:!1,info:void 0,iv:void 0,key:void 0,type:void 0},hmac:{info:void 0,key:void 0,buf:void 0,type:!1},compress:{instance:!1,type:!1,queue:null}}};e||this.readable&&this.push(null)},fe.prototype.disconnect=function(e){var t=Buffer.alloc(13);return t[0]=S.DISCONNECT,void 0===T[e]&&(e=T.BY_APPLICATION),h(t,e,1),this.debug("DEBUG: Outgoing: Writing DISCONNECT ("+T[e]+")"),be(this,t),this.reset(),!1},fe.prototype.ping=function(){return this.debug("DEBUG: Outgoing: Writing ping (GLOBAL_REQUEST: keepalive@openssh.com)"),be(this,ee)},fe.prototype.rekey=function(){var e=this._state.outgoing.status;if(e===j)throw new Error("A re-key is already in progress");if(e!==W)throw new Error("Cannot re-key yet");return this.debug("DEBUG: Outgoing: Starting re-key"),ve(this)},fe.prototype.requestSuccess=function(e){var t;return Buffer.isBuffer(e)?((t=Buffer.allocUnsafe(1+e.length))[0]=S.REQUEST_SUCCESS,e.copy(t,1)):t=ne,this.debug("DEBUG: Outgoing: Writing REQUEST_SUCCESS"),be(this,t)},fe.prototype.requestFailure=function(){return this.debug("DEBUG: Outgoing: Writing REQUEST_FAILURE"),be(this,ie)},fe.prototype.channelSuccess=function(e){var t=Buffer.allocUnsafe(5);return t[0]=S.CHANNEL_SUCCESS,h(t,e,1),this.debug("DEBUG: Outgoing: Writing CHANNEL_SUCCESS ("+e+")"),be(this,t)},fe.prototype.channelFailure=function(e){var t=Buffer.allocUnsafe(5);return t[0]=S.CHANNEL_FAILURE,h(t,e,1),this.debug("DEBUG: Outgoing: Writing CHANNEL_FAILURE ("+e+")"),be(this,t)},fe.prototype.channelEOF=function(e){var t=Buffer.allocUnsafe(5);return t[0]=S.CHANNEL_EOF,h(t,e,1),this.debug("DEBUG: Outgoing: Writing CHANNEL_EOF ("+e+")"),be(this,t)},fe.prototype.channelClose=function(e){var t=Buffer.allocUnsafe(5);return t[0]=S.CHANNEL_CLOSE,h(t,e,1),this.debug("DEBUG: Outgoing: Writing CHANNEL_CLOSE ("+e+")"),be(this,t)},fe.prototype.channelWindowAdjust=function(e,t){var r=Buffer.allocUnsafe(9);return r[0]=S.CHANNEL_WINDOW_ADJUST,h(r,e,1),h(r,t,5),this.debug("DEBUG: Outgoing: Writing CHANNEL_WINDOW_ADJUST ("+e+", "+t+")"),be(this,r)},fe.prototype.channelData=function(e,t){var r=Buffer.isBuffer(t),n=r?t.length:Buffer.byteLength(t),i=Buffer.allocUnsafe(9+n);return i[0]=S.CHANNEL_DATA,h(i,e,1),h(i,n,5),r?t.copy(i,9):i.write(t,9,n,"utf8"),this.debug("DEBUG: Outgoing: Writing CHANNEL_DATA ("+e+")"),be(this,i)},fe.prototype.channelExtData=function(e,t,r){var n=Buffer.isBuffer(t),i=n?t.length:Buffer.byteLength(t),o=Buffer.allocUnsafe(13+i);return o[0]=S.CHANNEL_EXTENDED_DATA,h(o,e,1),h(o,r,5),h(o,i,9),n?t.copy(o,13):o.write(t,13,i,"utf8"),this.debug("DEBUG: Outgoing: Writing CHANNEL_EXTENDED_DATA ("+e+")"),be(this,o)},fe.prototype.channelOpenConfirm=function(e,t,r,n){var i=Buffer.allocUnsafe(17);return i[0]=S.CHANNEL_OPEN_CONFIRMATION,h(i,e,1),h(i,t,5),h(i,r,9),h(i,n,13),this.debug("DEBUG: Outgoing: Writing CHANNEL_OPEN_CONFIRMATION (r:"+e+", l:"+t+")"),be(this,i)},fe.prototype.channelOpenFail=function(e,t,r,n){"string"!=typeof r&&(r=""),"string"!=typeof n&&(n="");var i=Buffer.byteLength(r),o=Buffer.byteLength(n),s=9,a=Buffer.allocUnsafe(13+i+4+o);return a[0]=S.CHANNEL_OPEN_FAILURE,h(a,e,1),h(a,t,5),h(a,i,s),s+=4,i&&(a.write(r,s,i,"utf8"),s+=i),h(a,o,s),o&&a.write(n,s+=4,o,"ascii"),this.debug("DEBUG: Outgoing: Writing CHANNEL_OPEN_FAILURE ("+e+")"),be(this,a)},fe.prototype.service=function(e){if(this.server)throw new Error("Client-only method called in server mode");var t=Buffer.byteLength(e),r=Buffer.allocUnsafe(5+t);return r[0]=S.SERVICE_REQUEST,h(r,t,1),r.write(e,5,t,"ascii"),this.debug("DEBUG: Outgoing: Writing SERVICE_REQUEST ("+e+")"),be(this,r)},fe.prototype.tcpipForward=function(e,t,r){if(this.server)throw new Error("Client-only method called in server mode");var n=Buffer.byteLength(e),i=Buffer.allocUnsafe(23+n+4);return i[0]=S.GLOBAL_REQUEST,h(i,13,1),i.write("tcpip-forward",5,13,"ascii"),i[18]=void 0===r||!0===r?1:0,h(i,n,19),i.write(e,23,n,"ascii"),h(i,t,23+n),this.debug("DEBUG: Outgoing: Writing GLOBAL_REQUEST (tcpip-forward)"),be(this,i)},fe.prototype.cancelTcpipForward=function(e,t,r){if(this.server)throw new Error("Client-only method called in server mode");var n=Buffer.byteLength(e),i=Buffer.allocUnsafe(30+n+4);return i[0]=S.GLOBAL_REQUEST,h(i,20,1),i.write("cancel-tcpip-forward",5,20,"ascii"),i[25]=void 0===r||!0===r?1:0,h(i,n,26),i.write(e,30,n,"ascii"),h(i,t,30+n),this.debug("DEBUG: Outgoing: Writing GLOBAL_REQUEST (cancel-tcpip-forward)"),be(this,i)},fe.prototype.openssh_streamLocalForward=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");var r=Buffer.byteLength(e),n=Buffer.allocUnsafe(41+r);return n[0]=S.GLOBAL_REQUEST,h(n,31,1),n.write("streamlocal-forward@openssh.com",5,31,"ascii"),n[36]=void 0===t||!0===t?1:0,h(n,r,37),n.write(e,41,r,"utf8"),this.debug("DEBUG: Outgoing: Writing GLOBAL_REQUEST (streamlocal-forward@openssh.com)"),be(this,n)},fe.prototype.openssh_cancelStreamLocalForward=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");var r=Buffer.byteLength(e),n=Buffer.allocUnsafe(48+r);return n[0]=S.GLOBAL_REQUEST,h(n,38,1),n.write("cancel-streamlocal-forward@openssh.com",5,38,"ascii"),n[43]=void 0===t||!0===t?1:0,h(n,r,44),n.write(e,48,r,"utf8"),this.debug("DEBUG: Outgoing: Writing GLOBAL_REQUEST (cancel-streamlocal-forward@openssh.com)"),be(this,n)},fe.prototype.directTcpip=function(e,t,r,n){if(this.server)throw new Error("Client-only method called in server mode");var i=Buffer.byteLength(n.srcIP),o=Buffer.byteLength(n.dstIP),s=29,a=Buffer.allocUnsafe(33+i+4+4+o+4);return a[0]=S.CHANNEL_OPEN,h(a,12,1),a.write("direct-tcpip",5,12,"ascii"),h(a,e,17),h(a,t,21),h(a,r,25),h(a,o,s),a.write(n.dstIP,s+=4,o,"ascii"),h(a,n.dstPort,s+=o),h(a,i,s+=4),a.write(n.srcIP,s+=4,i,"ascii"),h(a,n.srcPort,s+=i),this.debug("DEBUG: Outgoing: Writing CHANNEL_OPEN ("+e+", direct-tcpip)"),be(this,a)},fe.prototype.openssh_directStreamLocal=function(e,t,r,n){if(this.server)throw new Error("Client-only method called in server mode");var i=Buffer.byteLength(n.socketPath),o=47,s=Buffer.allocUnsafe(51+i+4+4);return s[0]=S.CHANNEL_OPEN,h(s,30,1),s.write("direct-streamlocal@openssh.com",5,30,"ascii"),h(s,e,35),h(s,t,39),h(s,r,43),h(s,i,o),s.write(n.socketPath,o+=4,i,"utf8"),s.fill(0,s.length-8),this.debug("DEBUG: Outgoing: Writing CHANNEL_OPEN ("+e+", direct-streamlocal@openssh.com)"),be(this,s)},fe.prototype.openssh_noMoreSessions=function(e){if(this.server)throw new Error("Client-only method called in server mode");var t=Buffer.allocUnsafe(34);return t[0]=S.GLOBAL_REQUEST,h(t,28,1),t.write("no-more-sessions@openssh.com",5,28,"ascii"),t[33]=void 0===e||!0===e?1:0,this.debug("DEBUG: Outgoing: Writing GLOBAL_REQUEST (no-more-sessions@openssh.com)"),be(this,t)},fe.prototype.session=function(e,t,r){if(this.server)throw new Error("Client-only method called in server mode");var n=Buffer.allocUnsafe(24);return n[0]=S.CHANNEL_OPEN,h(n,7,1),n.write("session",5,7,"ascii"),h(n,e,12),h(n,t,16),h(n,r,20),this.debug("DEBUG: Outgoing: Writing CHANNEL_OPEN ("+e+", session)"),be(this,n)},fe.prototype.windowChange=function(e,t,r,n,i){if(this.server)throw new Error("Client-only method called in server mode");var o=Buffer.allocUnsafe(39);return o[0]=S.CHANNEL_REQUEST,h(o,e,1),h(o,13,5),o.write("window-change",9,13,"ascii"),o[22]=0,h(o,r,23),h(o,t,27),h(o,i,31),h(o,n,35),this.debug("DEBUG: Outgoing: Writing CHANNEL_REQUEST ("+e+", window-change)"),be(this,o)},fe.prototype.pty=function(e,t,r,n,i,o,s,a){if(this.server)throw new Error("Client-only method called in server mode");o&&o.length||(o="vt100"),!s||Buffer.isBuffer(s)||Array.isArray(s)||"object"!=typeof s||(s=function(e){for(var t,r,n,i=/^\d+$/,o=Object.keys(e),s=0,a=[],f=0,u=o.length;f<u;++f)t=o[f],(r=I[t])&&!i.test(t)&&"number"==typeof e[t]&&"TTY_OP_END"!==t&&(n=e[t],a[s++]=r,a[s++]=n>>>24&255,a[s++]=n>>>16&255,a[s++]=n>>>8&255,a[s++]=255&n);return a[s]=I.TTY_OP_END,a}(s)),s&&s.length||(s=oe);var f=o.length,u=s.length,c=21,l=Buffer.allocUnsafe(21+f+4+4+4+4+4+u);if(l[0]=S.CHANNEL_REQUEST,h(l,e,1),h(l,7,5),l.write("pty-req",9,7,"ascii"),l[16]=void 0===a||!0===a?1:0,h(l,f,17),l.write(o,21,f,"utf8"),h(l,r,c+=f),h(l,t,c+=4),h(l,i,c+=4),h(l,n,c+=4),h(l,u,c+=4),c+=4,Array.isArray(s))for(var p=0;p<u;++p)l[c++]=s[p];else Buffer.isBuffer(s)&&s.copy(l,c);return this.debug("DEBUG: Outgoing: Writing CHANNEL_REQUEST ("+e+", pty-req)"),be(this,l)},fe.prototype.shell=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");var r=Buffer.allocUnsafe(15);return r[0]=S.CHANNEL_REQUEST,h(r,e,1),h(r,5,5),r.write("shell",9,5,"ascii"),r[14]=void 0===t||!0===t?1:0,this.debug("DEBUG: Outgoing: Writing CHANNEL_REQUEST ("+e+", shell)"),be(this,r)},fe.prototype.exec=function(e,t,r){if(this.server)throw new Error("Client-only method called in server mode");var n=Buffer.isBuffer(t)?t.length:Buffer.byteLength(t),i=Buffer.allocUnsafe(18+n);return i[0]=S.CHANNEL_REQUEST,h(i,e,1),h(i,4,5),i.write("exec",9,4,"ascii"),i[13]=void 0===r||!0===r?1:0,h(i,n,14),Buffer.isBuffer(t)?t.copy(i,18):i.write(t,18,n,"utf8"),this.debug("DEBUG: Outgoing: Writing CHANNEL_REQUEST ("+e+", exec)"),be(this,i)},fe.prototype.signal=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");if("SIG"===(t=t.toUpperCase()).slice(0,3)&&(t=t.substring(3)),-1===O.indexOf(t))throw new Error("Invalid signal: "+t);var r=t.length,n=Buffer.allocUnsafe(20+r);return n[0]=S.CHANNEL_REQUEST,h(n,e,1),h(n,6,5),n.write("signal",9,6,"ascii"),n[15]=0,h(n,r,16),n.write(t,20,r,"ascii"),this.debug("DEBUG: Outgoing: Writing CHANNEL_REQUEST ("+e+", signal)"),be(this,n)},fe.prototype.env=function(e,t,r,n){if(this.server)throw new Error("Client-only method called in server mode");var i=Buffer.byteLength(t),o=Buffer.isBuffer(r)?r.length:Buffer.byteLength(r),s=Buffer.allocUnsafe(17+i+4+o);return s[0]=S.CHANNEL_REQUEST,h(s,e,1),h(s,3,5),s.write("env",9,3,"ascii"),s[12]=void 0===n||!0===n?1:0,h(s,i,13),s.write(t,17,i,"ascii"),h(s,o,17+i),Buffer.isBuffer(r)?r.copy(s,17+i+4):s.write(r,17+i+4,o,"utf8"),this.debug("DEBUG: Outgoing: Writing CHANNEL_REQUEST ("+e+", env)"),be(this,s)},fe.prototype.x11Forward=function(e,t,r){if(this.server)throw new Error("Client-only method called in server mode");var n=Buffer.byteLength(t.protocol),i=Buffer.byteLength(t.cookie),o=Buffer.allocUnsafe(22+n+4+i+4);o[0]=S.CHANNEL_REQUEST,h(o,e,1),h(o,7,5),o.write("x11-req",9,7,"ascii"),o[16]=void 0===r||!0===r?1:0,o[17]=t.single?1:0,h(o,n,18);var s=22;return Buffer.isBuffer(t.protocol)?t.protocol.copy(o,s):o.write(t.protocol,s,n,"utf8"),h(o,i,s+=n),s+=4,Buffer.isBuffer(t.cookie)?t.cookie.copy(o,s):o.write(t.cookie,s,i,"binary"),s+=i,h(o,t.screen||0,s),this.debug("DEBUG: Outgoing: Writing CHANNEL_REQUEST ("+e+", x11-req)"),be(this,o)},fe.prototype.subsystem=function(e,t,r){if(this.server)throw new Error("Client-only method called in server mode");var n=Buffer.byteLength(t),i=Buffer.allocUnsafe(23+n);return i[0]=S.CHANNEL_REQUEST,h(i,e,1),h(i,9,5),i.write("subsystem",9,9,"ascii"),i[18]=void 0===r||!0===r?1:0,h(i,n,19),i.write(t,23,n,"ascii"),this.debug("DEBUG: Outgoing: Writing CHANNEL_REQUEST ("+e+", subsystem: "+t+")"),be(this,i)},fe.prototype.openssh_agentForward=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");var r=Buffer.allocUnsafe(36);return r[0]=S.CHANNEL_REQUEST,h(r,e,1),h(r,26,5),r.write("auth-agent-req@openssh.com",9,26,"ascii"),r[35]=void 0===t||!0===t?1:0,this.debug("DEBUG: Outgoing: Writing CHANNEL_REQUEST ("+e+", auth-agent-req@openssh.com)"),be(this,r)},fe.prototype.authPassword=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");var r=Buffer.byteLength(e),n=Buffer.byteLength(t),i=0,o=Buffer.allocUnsafe(5+r+4+14+4+8+1+4+n);return o[i]=S.USERAUTH_REQUEST,h(o,r,++i),o.write(e,i+=4,r,"utf8"),h(o,14,i+=r),o.write("ssh-connection",i+=4,14,"ascii"),h(o,8,i+=14),o.write("password",i+=4,8,"ascii"),o[i+=8]=0,h(o,n,++i),o.write(t,i+=4,n,"utf8"),this._state.authsQueue.push("password"),this.debug("DEBUG: Outgoing: Writing USERAUTH_REQUEST (password)"),be(this,o)},fe.prototype.authPK=function(e,t,r){if(this.server)throw new Error("Client-only method called in server mode");var n,i=this,o=this._state.outgoing;"function"==typeof t.getPublicSSH?(n=t.type,t=t.getPublicSSH()):n=t.toString("ascii",4,4+c(t,0));var s=Buffer.byteLength(e),a=Buffer.byteLength(n),f=t.length,u=o.sessionId.length,l=0,p=Buffer.allocUnsafe((r?4+u:0)+1+4+s+4+14+4+9+1+4+a+4+f);return r?(h(p,u,l),o.sessionId.copy(p,l+=4),p[l+=u]=S.USERAUTH_REQUEST):p[l]=S.USERAUTH_REQUEST,h(p,s,++l),p.write(e,l+=4,s,"utf8"),h(p,14,l+=s),p.write("ssh-connection",l+=4,14,"ascii"),h(p,9,l+=14),p.write("publickey",l+=4,9,"ascii"),p[l+=9]=r?1:0,h(p,a,++l),p.write(n,l+=4,a,"ascii"),h(p,f,l+=a),t.copy(p,l+=4),r?(r(p,(function(r){if(!1===(r=Te(r,n)))throw new Error("Error while converting handshake signature");var o=r.length,u=Buffer.allocUnsafe(5+s+4+14+4+9+1+4+a+4+f+4+4+a+4+o);return u[l=0]=S.USERAUTH_REQUEST,h(u,s,++l),u.write(e,l+=4,s,"utf8"),h(u,14,l+=s),u.write("ssh-connection",l+=4,14,"ascii"),h(u,9,l+=14),u.write("publickey",l+=4,9,"ascii"),u[l+=9]=1,h(u,a,++l),u.write(n,l+=4,a,"ascii"),h(u,f,l+=a),t.copy(u,l+=4),h(u,4+a+4+o,l+=f),h(u,a,l+=4),u.write(n,l+=4,a,"ascii"),h(u,o,l+=a),r.copy(u,l+=4),i._state.authsQueue.push("publickey"),i.debug("DEBUG: Outgoing: Writing USERAUTH_REQUEST (publickey)"),be(i,u)})),!0):(this._state.authsQueue.push("publickey"),this.debug("DEBUG: Outgoing: Writing USERAUTH_REQUEST (publickey -- check)"),be(this,p))},fe.prototype.authHostbased=function(e,t,r,n,i){if(this.server)throw new Error("Client-only method called in server mode");var o,s=this,a=this._state.outgoing;"function"==typeof t.getPublicSSH?(o=t.type,t=t.getPublicSSH()):o=t.toString("ascii",4,4+c(t,0));var f=Buffer.byteLength(e),u=Buffer.byteLength(o),l=t.length,p=a.sessionId.length,d=Buffer.byteLength(r),E=Buffer.byteLength(n),g=0,m=Buffer.allocUnsafe(4+p+1+4+f+4+14+4+9+4+u+4+l+4+d+4+E);return h(m,p,g),a.sessionId.copy(m,g+=4),m[g+=p]=S.USERAUTH_REQUEST,h(m,f,++g),m.write(e,g+=4,f,"utf8"),h(m,14,g+=f),m.write("ssh-connection",g+=4,14,"ascii"),h(m,9,g+=14),m.write("hostbased",g+=4,9,"ascii"),h(m,u,g+=9),m.write(o,g+=4,u,"ascii"),h(m,l,g+=u),t.copy(m,g+=4),h(m,d,g+=l),m.write(r,g+=4,d,"ascii"),h(m,E,g+=d),m.write(n,g+=4,E,"utf8"),i(m,(function(e){if(!1===(e=Te(e,o)))throw new Error("Error while converting handshake signature");var t=e.length,r=Buffer.allocUnsafe(m.length-p+t);return m.copy(r,0,4+p),h(r,t,r.length-t-4),e.copy(r,r.length-t),s._state.authsQueue.push("hostbased"),s.debug("DEBUG: Outgoing: Writing USERAUTH_REQUEST (hostbased)"),be(s,r)})),!0},fe.prototype.authKeyboard=function(e){if(this.server)throw new Error("Client-only method called in server mode");var t=Buffer.byteLength(e),r=0,n=Buffer.allocUnsafe(5+t+4+14+4+20+4+4);return n[r]=S.USERAUTH_REQUEST,h(n,t,++r),n.write(e,r+=4,t,"utf8"),h(n,14,r+=t),n.write("ssh-connection",r+=4,14,"ascii"),h(n,20,r+=14),n.write("keyboard-interactive",r+=4,20,"ascii"),h(n,0,r+=20),h(n,0,r+=4),this._state.authsQueue.push("keyboard-interactive"),this.debug("DEBUG: Outgoing: Writing USERAUTH_REQUEST (keyboard-interactive)"),be(this,n)},fe.prototype.authNone=function(e){if(this.server)throw new Error("Client-only method called in server mode");var t=Buffer.byteLength(e),r=0,n=Buffer.allocUnsafe(5+t+4+14+4+4);return n[r]=S.USERAUTH_REQUEST,h(n,t,++r),n.write(e,r+=4,t,"utf8"),h(n,14,r+=t),n.write("ssh-connection",r+=4,14,"ascii"),h(n,4,r+=14),n.write("none",r+=4,4,"ascii"),this._state.authsQueue.push("none"),this.debug("DEBUG: Outgoing: Writing USERAUTH_REQUEST (none)"),be(this,n)},fe.prototype.authInfoRes=function(e){if(this.server)throw new Error("Client-only method called in server mode");var t,r,n,i=0,o=0;if(e)for(n=0,r=e.length;n<r;++n)i+=4+Buffer.byteLength(e[n]);var s=Buffer.allocUnsafe(5+i);if(s[o++]=S.USERAUTH_INFO_RESPONSE,h(s,e?e.length:0,o),e)for(o+=4,n=0,r=e.length;n<r;++n)t=Buffer.byteLength(e[n]),h(s,t,o),o+=4,t&&(s.write(e[n],o,t,"utf8"),o+=t);return this.debug("DEBUG: Outgoing: Writing USERAUTH_INFO_RESPONSE"),be(this,s)},fe.prototype.serviceAccept=function(e){if(!this.server)throw new Error("Server-only method called in client mode");var t=e.length,r=Buffer.allocUnsafe(5+t);if(r[0]=S.SERVICE_ACCEPT,h(r,t,1),r.write(e,5,t,"ascii"),this.debug("DEBUG: Outgoing: Writing SERVICE_ACCEPT ("+e+")"),be(this,r),this.server&&this.banner&&"ssh-userauth"===e){var n=Buffer.byteLength(this.banner),i=5+n+4,o=Buffer.allocUnsafe(i);o[0]=S.USERAUTH_BANNER,h(o,n,1),o.write(this.banner,5,n,"utf8"),o.fill(0,i-4),this.debug("DEBUG: Outgoing: Writing USERAUTH_BANNER"),be(this,o),this.banner=void 0}},fe.prototype.forwardedTcpip=function(e,t,r,n){if(!this.server)throw new Error("Server-only method called in client mode");var i=Buffer.byteLength(n.boundAddr),o=Buffer.byteLength(n.remoteAddr),s=36+i,a=Buffer.allocUnsafe(36+i+4+4+o+4);return a[0]=S.CHANNEL_OPEN,h(a,15,1),a.write("forwarded-tcpip",5,15,"ascii"),h(a,e,20),h(a,t,24),h(a,r,28),h(a,i,32),a.write(n.boundAddr,36,i,"ascii"),h(a,n.boundPort,s),h(a,o,s+=4),a.write(n.remoteAddr,s+=4,o,"ascii"),h(a,n.remotePort,s+=o),this.debug("DEBUG: Outgoing: Writing CHANNEL_OPEN ("+e+", forwarded-tcpip)"),be(this,a)},fe.prototype.x11=function(e,t,r,n){if(!this.server)throw new Error("Server-only method called in client mode");var i=Buffer.byteLength(n.originAddr),o=24+i,s=Buffer.allocUnsafe(24+i+4);return s[0]=S.CHANNEL_OPEN,h(s,3,1),s.write("x11",5,3,"ascii"),h(s,e,8),h(s,t,12),h(s,r,16),h(s,i,20),s.write(n.originAddr,24,i,"ascii"),h(s,n.originPort,o),this.debug("DEBUG: Outgoing: Writing CHANNEL_OPEN ("+e+", x11)"),be(this,s)},fe.prototype.openssh_authAgent=function(e,t,r){if(!this.server)throw new Error("Server-only method called in client mode");var n=Buffer.allocUnsafe(39);return n[0]=S.CHANNEL_OPEN,h(n,22,1),n.write("auth-agent@openssh.com",5,22,"ascii"),h(n,e,27),h(n,t,31),h(n,r,35),this.debug("DEBUG: Outgoing: Writing CHANNEL_OPEN ("+e+", auth-agent@openssh.com)"),be(this,n)},fe.prototype.openssh_forwardedStreamLocal=function(e,t,r,n){if(!this.server)throw new Error("Server-only method called in client mode");var i=Buffer.byteLength(n.socketPath),o=Buffer.allocUnsafe(54+i+4);return o[0]=S.CHANNEL_OPEN,h(o,33,1),o.write("forwarded-streamlocal@openssh.com",5,33,"ascii"),h(o,e,38),h(o,t,42),h(o,r,46),h(o,i,50),o.write(n.socketPath,54,i,"utf8"),h(o,0,54+i),this.debug("DEBUG: Outgoing: Writing CHANNEL_OPEN ("+e+", forwarded-streamlocal@openssh.com)"),be(this,o)},fe.prototype.exitStatus=function(e,t){if(!this.server)throw new Error("Server-only method called in client mode");var r=Buffer.allocUnsafe(25);return r[0]=S.CHANNEL_REQUEST,h(r,e,1),h(r,11,5),r.write("exit-status",9,11,"ascii"),r[20]=0,h(r,t,21),this.debug("DEBUG: Outgoing: Writing CHANNEL_REQUEST ("+e+", exit-status)"),be(this,r)},fe.prototype.exitSignal=function(e,t,r,n){if(!this.server)throw new Error("Server-only method called in client mode");var i=Buffer.byteLength(t),o=n?Buffer.byteLength(n):0,s=25+i,a=Buffer.allocUnsafe(25+i+1+4+o+4);return a[0]=S.CHANNEL_REQUEST,h(a,e,1),h(a,11,5),a.write("exit-signal",9,11,"ascii"),a[20]=0,h(a,i,21),a.write(t,25,i,"utf8"),a[s++]=r?1:0,h(a,o,s),s+=4,o&&(a.write(n,s,o,"utf8"),s+=o),h(a,0,s),this.debug("DEBUG: Outgoing: Writing CHANNEL_REQUEST ("+e+", exit-signal)"),be(this,a)},fe.prototype.authFailure=function(e,t){if(!this.server)throw new Error("Server-only method called in client mode");var r;if(!this._state.authsQueue.length)throw new Error("No auth in progress");if("boolean"==typeof e&&(t=e,e=void 0),e){r=[];for(var n=0,i=e.length;n<i;++n)"none"!==e[n].toLowerCase()&&r.push(e[n]);r=r.join(",")}else r="";var o=r.length,s=Buffer.allocUnsafe(5+o+1);return s[0]=S.USERAUTH_FAILURE,h(s,o,1),s.write(r,5,o,"ascii"),s[5+o]=!0===t?1:0,this._state.authsQueue.shift(),this.debug("DEBUG: Outgoing: Writing USERAUTH_FAILURE"),be(this,s)},fe.prototype.authSuccess=function(){if(!this.server)throw new Error("Server-only method called in client mode");if(!this._state.authsQueue.length)throw new Error("No auth in progress");var e=this._state,t=e.outgoing,r=e.incoming;e.authsQueue.shift(),this.debug("DEBUG: Outgoing: Writing USERAUTH_SUCCESS");var n=be(this,re);return"zlib@openssh.com"===t.compress.type&&(t.compress.instance=i.createDeflate(Q),t.compress.queue=[]),"zlib@openssh.com"===r.decompress.type&&(r.decompress.instance=i.createInflate(Q)),n},fe.prototype.authPKOK=function(e,t){if(!this.server)throw new Error("Server-only method called in client mode");var r=this._state.authsQueue;if(!r.length||"publickey"!==r[0])throw new Error('"publickey" auth not in progress');var n=e.length,i=t.length,o=Buffer.allocUnsafe(5+n+4+i);return o[0]=S.USERAUTH_PK_OK,h(o,n,1),o.write(e,5,n,"ascii"),h(o,i,5+n),t.copy(o,5+n+4),this._state.authsQueue.shift(),this.debug("DEBUG: Outgoing: Writing USERAUTH_PK_OK"),be(this,o)},fe.prototype.authPasswdChg=function(e,t){if(!this.server)throw new Error("Server-only method called in client mode");var r=Buffer.byteLength(e),n=t?t.length:0,i=0,o=Buffer.allocUnsafe(5+r+4+n);return o[i]=S.USERAUTH_PASSWD_CHANGEREQ,h(o,r,++i),o.write(e,i+=4,r,"utf8"),h(o,n,i+=r),n&&o.write(t,i+=4,n,"ascii"),this.debug("DEBUG: Outgoing: Writing USERAUTH_PASSWD_CHANGEREQ"),be(this,o)},fe.prototype.authInfoReq=function(e,t,r){if(!this.server)throw new Error("Server-only method called in client mode");var n,i,o,s,a=0,f=e?Buffer.byteLength(e):0,u=t?Buffer.byteLength(t):0,c=0;for(s=0,o=r.length;s<o;++s)a+=4+Buffer.byteLength(r[s].prompt)+1;var l=Buffer.allocUnsafe(5+f+4+u+4+4+a);for(l[c++]=S.USERAUTH_INFO_REQUEST,h(l,f,c),c+=4,e&&(l.write(e,c,f,"utf8"),c+=f),h(l,u,c),c+=4,t&&(l.write(t,c,u,"utf8"),c+=u),h(l,0,c),c+=4,h(l,r.length,c),c+=4,s=0,o=r.length;s<o;++s)i=r[s],n=Buffer.byteLength(i.prompt),h(l,n,c),c+=4,n&&(l.write(i.prompt,c,n,"utf8"),c+=n),l[c++]=i.echo?1:0;return this.debug("DEBUG: Outgoing: Writing USERAUTH_INFO_REQUEST"),be(this,l)};var Ae="function"==typeof n.randomFillSync?n.randomFillSync:function(e,t,r){n.randomBytes(r).copy(e,t)};function Te(e,t){switch(t){case"ssh-dss":return m(e);case"ecdsa-sha2-nistp256":case"ecdsa-sha2-nistp384":case"ecdsa-sha2-nistp521":return v(e)}return e}var Re="function"==typeof n.timingSafeEqual?function(e,t){return e.length!==t.length?(n.timingSafeEqual(e,e),!1):n.timingSafeEqual(e,t)}:function(e,t){var r;e.length===t.length?r=0:(r=1,t=e);for(var n=0,i=e.length;n<i;++n)r|=e[n]^t[n];return 0===r};function Ne(e,t){switch(e){case"curve25519-sha256":case"curve25519-sha256@libssh.org":if(!k)break;return this.type="25519",this.hash="sha256",this.pktInit="KEXECDH_INIT",void(this.pktReply="KEXECDH_REPLY");case"ecdh-sha2-nistp256":return this.type="ecdh",this.name="prime256v1",this.hash="sha256",this.pktInit="KEXECDH_INIT",void(this.pktReply="KEXECDH_REPLY");case"ecdh-sha2-nistp384":return this.type="ecdh",this.name="secp384r1",this.hash="sha384",this.pktInit="KEXECDH_INIT",void(this.pktReply="KEXECDH_REPLY");case"ecdh-sha2-nistp521":return this.type="ecdh",this.name="secp521r1",this.hash="sha512",this.pktInit="KEXECDH_INIT",void(this.pktReply="KEXECDH_REPLY");case"diffie-hellman-group1-sha1":return this.type="group",this.name="modp2",this.hash="sha1",this.pktInit="KEXDH_INIT",void(this.pktReply="KEXDH_REPLY");case"diffie-hellman-group14-sha1":return this.type="group",this.name="modp14",this.hash="sha1",this.pktInit="KEXDH_INIT",void(this.pktReply="KEXDH_REPLY");case"diffie-hellman-group14-sha256":return this.type="group",this.name="modp14",this.hash="sha256",this.pktInit="KEXDH_INIT",void(this.pktReply="KEXDH_REPLY");case"diffie-hellman-group16-sha512":return this.type="group",this.name="modp16",this.hash="sha512",this.pktInit="KEXDH_INIT",void(this.pktReply="KEXDH_REPLY");case"diffie-hellman-group18-sha512":return this.type="group",this.name="modp18",this.hash="sha512",this.pktInit="KEXDH_INIT",void(this.pktReply="KEXDH_REPLY");case"diffie-hellman-group-exchange-sha1":return this.type="groupex",this.hash="sha1",this.pktInit="KEXDH_GEX_REQ",this.pktReply="KEXDH_GEX_REPLY",this._prime=null,void(this._generator=null);case"diffie-hellman-group-exchange-sha256":return this.type="groupex",this.hash="sha256",this.pktInit="KEXDH_GEX_REQ",this.pktReply="KEXDH_GEX_REPLY",this._prime=null,void(this._generator=null)}throw new Error("Unsupported key exchange algorithm: "+e)}function Ie(e){for(var t,r=0,n=e.length;0===e[r];)++r,--n;return 128&e[r]?((t=Buffer.allocUnsafe(1+n))[0]=0,e.copy(t,1,r),e=t):n!==e.length&&(t=Buffer.allocUnsafe(n),e.copy(t,0,r),e=t),e}Ne.prototype.setDHParams=function(e,t){if("groupex"===this.type){if(!Buffer.isBuffer(e))throw new Error("Invalid prime value");if(!Buffer.isBuffer(t))throw new Error("Invalid generator value");this._prime=e,this._generator=t}},Ne.prototype.getDHParams=function(){if("groupex"===this.type&&this._kex)return{prime:Ie(this._kex.getPrime()),generator:Ie(this._kex.getGenerator())}},Ne.prototype.generateKeys=function(){switch(this.type){case"25519":this._keys||(this._keys=n.generateKeyPairSync("x25519"));break;case"ecdh":this._kex||(this._kex=n.createECDH(this.name),this._public=this._kex.generateKeys());break;case"group":case"groupex":this._kex||(this.name?this._kex=n.createDiffieHellmanGroup(this.name):this._prime&&this._generator&&(this._kex=n.createDiffieHellman(this._prime,this._generator)),this._kex&&(this._public=this._kex.generateKeys()))}},Ne.prototype.getPublicKey=function(){var e;switch(this.generateKeys(),this.type){case"25519":return(e=this._keys.publicKey.export({type:"spki",format:"der"})).slice(-32);case"ecdh":case"group":case"groupex":e=this._public}if(e)return this.convertPublicKey(e)},Ne.prototype.convertPublicKey=function(e){for(var t,r=0,n=e.length;0===e[r];)++r,--n;switch(this.type){case"25519":if(32===e.length)return e;break;default:if(128&e[r])return(t=Buffer.allocUnsafe(1+n))[0]=0,e.copy(t,1,r),t}return n!==e.length&&(t=Buffer.allocUnsafe(n),e.copy(t,0,r),e=t),e},Ne.prototype.computeSecret=function(e){switch(this.generateKeys(),this.type){case"25519":try{var t=new u.Writer;return t.startSequence(),t.startSequence(),t.writeOID("1.3.101.110"),t.endSequence(),t.startSequence(u.BitString),t.writeByte(0),t._ensure(e.length),e.copy(t._buf,t._offset,0,e.length),t._offset+=e.length,t.endSequence(),t.endSequence(),Ie(n.diffieHellman({privateKey:this._keys.privateKey,publicKey:n.createPublicKey({key:t.buffer,type:"spki",format:"der"})}))}catch(e){return e}break;case"ecdh":case"group":case"groupex":try{return Ie(this._kex.computeSecret(e))}catch(e){return e}}},e.exports=fe,e.exports._send=be},8013:(e,t,r)=>{var n=r(476).Ber,i=r(33).readUInt32BE,o=r(33).writeUInt32BE;function s(e,t,r,n,o,s){r&&!Buffer.isBuffer(r)&&"string"!=typeof r&&("number"==typeof o&&(s=o),o=n,n=r,r=void 0),t||(t=0);var a,f,u=e.length,c=u-t;return t<0||t>=u||c<4||(a=i(e,t))>(s||1/0)||c<4+a?(n&&n._cleanup(o),!1):(f=(t+=4)+a,e._pos=f,r?Buffer.isBuffer(r)?(e.copy(r,0,t,f),r):e.toString(r,t,f):e.slice(t,f))}e.exports={iv_inc:function(e){var t=12,r=0;do{if(255!==(r=e[--t]))return void(e[t]=++r);e[t]=0}while(t>4)},readInt:function(e,t,r,n){var o=e.length;return t<0||t>=o||o-t<4?(r&&r._cleanup(n),!1):i(e,t)},readString:s,parseKey:r(8819).parseKey,sigSSHToASN1:function(e,t,r,i){var o;switch(t){case"ssh-dss":if(e.length>40)return e;(o=new n.Writer).startSequence();var a=e.slice(0,20),f=e.slice(20);if(128&a[0]){var u=Buffer.allocUnsafe(21);u[0]=0,a.copy(u,1),a=u}else 0!==a[0]||128&a[1]||(a=a.slice(1));if(128&f[0]){var c=Buffer.allocUnsafe(21);c[0]=0,f.copy(c,1),f=c}else 0!==f[0]||128&f[1]||(f=f.slice(1));return o.writeBuffer(a,n.Integer),o.writeBuffer(f,n.Integer),o.endSequence(),o.buffer;case"ecdsa-sha2-nistp256":case"ecdsa-sha2-nistp384":case"ecdsa-sha2-nistp521":return!1!==(a=s(e,0,r,i))&&!1!==(f=s(e,e._pos,r,i))&&((o=new n.Writer).startSequence(),o.writeBuffer(a,n.Integer),o.writeBuffer(f,n.Integer),o.endSequence(),o.buffer);default:return e}},DSASigBERToBare:function(e){if(e.length<=40)return e;var t=new n.Reader(e);t.readSequence();var r=t.readString(n.Integer,!0),i=t.readString(n.Integer,!0),o=0,s=0;if(r.length<20){var a=Buffer.allocUnsafe(20);r.copy(a,1),(r=a)[0]=0}if(i.length<20){var f=Buffer.allocUnsafe(20);i.copy(f,1),(i=f)[0]=0}r.length>20&&0===r[0]&&(o=1),i.length>20&&0===i[0]&&(s=1);var u=Buffer.allocUnsafe(r.length-o+(i.length-s));return r.copy(u,0,o),i.copy(u,r.length-o,s),u},ECDSASigASN1ToSSH:function(e){if(0===e[0])return e;var t=new n.Reader(e);t.readSequence();var r=t.readString(n.Integer,!0),i=t.readString(n.Integer,!0);if(null===r||null===i)return!1;var s=Buffer.allocUnsafe(4+r.length+4+i.length);return o(s,r.length,0),r.copy(s,4),o(s,i.length,4+r.length),i.copy(s,8+r.length),s}}},5129:e=>{"use strict";e.exports={i8:"0.4.10"}},491:(e,t,r)=>{var n=r(5404).inherits,i=r(5170).Duplex,o=r(5170).Readable,s=r(5170).Writable,a=r(816).constants.CHANNEL_EXTENDED_DATATYPE.STDERR,f=2097152,u=1048576,c=["CHANNEL_EOF","CHANNEL_CLOSE","CHANNEL_DATA","CHANNEL_EXTENDED_DATA","CHANNEL_WINDOW_ADJUST","CHANNEL_SUCCESS","CHANNEL_FAILURE","CHANNEL_REQUEST"],h=c.length;function l(e,t,r){var n={highWaterMark:f,allowHalfOpen:!r||r&&!1!==r.allowHalfOpen};this.allowHalfOpen=n.allowHalfOpen,i.call(this,n);var s=this,a=r&&r.server;this.server=a,this.type=e.type,this.subtype=void 0;var l,E,g,m,v,y=this.incoming=e.incoming,_=y.id,w=this.outgoing=e.outgoing,b=this._callbacks=[];this._client=t,this._hasX11=!1;var S=t._channels,A=t._sshstream;function T(){s._waitClientDrain&&(s._waitClientDrain=!1,s._waitWindow||(s._chunk?s._write(s._chunk,null,s._chunkcb):s._chunkcb?s._chunkcb():s._chunkErr?s.stderr._write(s._chunkErr,null,s._chunkcbErr):s._chunkcbErr&&s._chunkcbErr()))}function R(){s.eof(),(a||!a&&!s.allowHalfOpen)&&s.close(),s.writable=!1}function N(){s.readable=!1}t._sock.on("drain",T),A.once("CHANNEL_EOF:"+_,(function(){"open"===y.state&&(y.state="eof",s.readable&&s.push(null),!a&&s.stderr.readable&&s.stderr.push(null))})).once("CHANNEL_CLOSE:"+_,(function(){if("closed"!==y.state){y.state="closed",s.readable&&s.push(null),a&&s.stderr.writable?s.stderr.end():!a&&s.stderr.readable&&s.stderr.push(null),"open"!==w.state&&"eof"!==w.state||s.close(),"closing"===w.state&&(w.state="closed"),delete S[_];var e=s._writableState;t._sock.removeListener("drain",T),e.ending||e.finished||s.end(),s._callbacks=[];for(var r=0;r<b.length;++r)b[r](!0);for(b=s._callbacks,a?s.readable?s.once("end",(function(){s.emit("close")})):s.emit("close"):(s.readable?s.once("end",(function(){null===l?s.emit("close",l,E,g,m,v):s.emit("close",l)})):null===l?s.emit("close",l,E,g,m,v):s.emit("close",l),s.stderr.readable?s.stderr.once("end",(function(){s.stderr.emit("close")})):s.stderr.emit("close")),r=0;r<h;++r)A.removeAllListeners(c[r]+":"+_)}})).on("CHANNEL_DATA:"+_,(function(e){0!==y.window&&(y.window-=e.length,s.push(e)?y.window<=u&&p(s):s._waitChanDrain=!0)})).on("CHANNEL_WINDOW_ADJUST:"+_,(function(e){w.window+=e,s._waitWindow&&(s._waitWindow=!1,s._waitClientDrain||(s._chunk?s._write(s._chunk,null,s._chunkcb):s._chunkcb?s._chunkcb():s._chunkErr?s.stderr._write(s._chunkErr,null,s._chunkcbErr):s._chunkcbErr&&s._chunkcbErr()))})).on("CHANNEL_SUCCESS:"+_,(function(){a?(A._kalast=Date.now(),A._kacnt=0):t._resetKA(),b.length&&b.shift()(!1)})).on("CHANNEL_FAILURE:"+_,(function(){a?(A._kalast=Date.now(),A._kacnt=0):t._resetKA(),b.length&&b.shift()(!0)})).on("CHANNEL_REQUEST:"+_,(function(e){if(!a){if("exit-status"===e.request)return void s.emit("exit",l=e.code);if("exit-signal"===e.request)return void s.emit("exit",l=null,E="SIG"+e.signal,g=e.coredump,m=e.description,v=e.lang)}e.wantReply&&A.channelFailure(w.id)})),this.stdin=this.stdout=this,a?this.stderr=new d(this):(this.stderr=new o(n),this.stderr._read=function(e){s._waitChanDrain&&(s._waitChanDrain=!1,y.window<=u&&p(s))},A.on("CHANNEL_EXTENDED_DATA:"+_,(function(e,t){0!==y.window&&(y.window-=t.length,s.stderr.push(t)?y.window<=u&&p(s):s._waitChanDrain=!0)}))),this._waitClientDrain=!1,this._waitWindow=!1,this._waitChanDrain=!1,this._chunk=void 0,this._chunkcb=void 0,this._chunkErr=void 0,this._chunkcbErr=void 0,this.on("finish",R).on("prefinish",R),this.on("end",N).on("close",N)}function p(e){if("closed"===e.outgoing.state)return!0;var t=f-e.incoming.window;return t<=0||(e.incoming.window+=t,e._client._sshstream.channelWindowAdjust(e.outgoing.id,t))}function d(e){s.call(this,{highWaterMark:f}),this._channel=e}n(l,i),l.prototype.eof=function(){var e=!0,t=this.outgoing;return"open"===t.state&&(t.state="eof",e=this._client._sshstream.channelEOF(t.id)),e},l.prototype.close=function(){var e=!0,t=this.outgoing;return"open"!==t.state&&"eof"!==t.state||(t.state="closing",e=this._client._sshstream.channelClose(t.id)),e},l.prototype._read=function(e){this._waitChanDrain&&(this._waitChanDrain=!1,this.incoming.window<=u&&p(this))},l.prototype._write=function(e,t,r){var n,i,o,s=this._client._sshstream,a=this.outgoing,f=a.packetSize,u=a.id,c=a.window,h=e.length,l=0;if("open"===a.state){for(;h-l>0&&c>0;)if((o=h-l)>c&&(o=c),o>f&&(o=f),n=s.channelData(u,e.slice(l,l+o)),l+=o,c-=o,!n){this._waitClientDrain=!0,this._chunk=void 0,this._chunkcb=r;break}if(a.window=c,h-l>0)return 0===c&&(this._waitWindow=!0),l>0?(i=Buffer.allocUnsafe(h-l),e.copy(i,0,l),this._chunk=i):this._chunk=e,void(this._chunkcb=r);this._waitClientDrain||r()}},l.prototype.destroy=function(){this.end()},l.prototype.setWindow=function(e,t,r,n){if(this.server)throw new Error("Client-only method called in server mode");return"session"!==this.type||"shell"!==this.subtype&&"exec"!==this.subtype||!this.writable||"open"!==this.outgoing.state||this._client._sshstream.windowChange(this.outgoing.id,e,t,r,n)},l.prototype.signal=function(e){if(this.server)throw new Error("Client-only method called in server mode");return"session"!==this.type||!this.writable||"open"!==this.outgoing.state||this._client._sshstream.signal(this.outgoing.id,e)},l.prototype.exit=function(e,t,r){if(!this.server)throw new Error("Server-only method called in client mode");return"session"!==this.type||!this.writable||"open"!==this.outgoing.state||("number"==typeof e?this._client._sshstream.exitStatus(this.outgoing.id,e):this._client._sshstream.exitSignal(this.outgoing.id,e,t,r))},l.MAX_WINDOW=f,l.PACKET_SIZE=32768,n(d,s),d.prototype._write=function(e,t,r){var n,i,o,s=this._channel,f=s._client._sshstream,u=s.outgoing,c=u.packetSize,h=u.id,l=u.window,p=e.length,d=0;if("open"===s.outgoing.state){for(;p-d>0&&l>0;)if((o=p-d)>l&&(o=l),o>c&&(o=c),n=f.channelExtData(h,e.slice(d,d+o),a),d+=o,l-=o,!n){s._waitClientDrain=!0,s._chunkErr=void 0,s._chunkcbErr=r;break}if(u.window=l,p-d>0)return 0===l&&(s._waitWindow=!0),d>0?(i=Buffer.allocUnsafe(p-d),e.copy(i,0,d),s._chunkErr=i):s._chunkErr=e,void(s._chunkcbErr=r);s._waitClientDrain||r()}},e.exports=l},2519:(e,t,r)=>{var n=r(5404).inherits,i=r(7187).EventEmitter;function o(e){var t=this;i.call(this),this._stream=e,e.on("error",(function(e){t.emit("error",e)})).on("end",(function(){t.emit("end")})).on("close",(function(){t.emit("close")})).on("continue",(function(){t.emit("continue")}))}n(o,i),o.prototype.end=function(){return this._stream.end()},o.prototype.createReadStream=function(e,t){return this._stream.createReadStream(e,t)},o.prototype.createWriteStream=function(e,t){return this._stream.createWriteStream(e,t)},o.prototype.open=function(e,t,r,n){return this._stream.open(e,t,r,n)},o.prototype.close=function(e,t){return this._stream.close(e,t)},o.prototype.read=function(e,t,r,n,i,o){return this._stream.readData(e,t,r,n,i,o)},o.prototype.write=function(e,t,r,n,i,o){return this._stream.writeData(e,t,r,n,i,o)},o.prototype.fastGet=function(e,t,r,n){return this._stream.fastGet(e,t,r,n)},o.prototype.fastPut=function(e,t,r,n){return this._stream.fastPut(e,t,r,n)},o.prototype.readFile=function(e,t,r){return this._stream.readFile(e,t,r)},o.prototype.writeFile=function(e,t,r,n){return this._stream.writeFile(e,t,r,n)},o.prototype.appendFile=function(e,t,r,n){return this._stream.appendFile(e,t,r,n)},o.prototype.exists=function(e,t){return this._stream.exists(e,t)},o.prototype.unlink=function(e,t){return this._stream.unlink(e,t)},o.prototype.rename=function(e,t,r){return this._stream.rename(e,t,r)},o.prototype.mkdir=function(e,t,r){return this._stream.mkdir(e,t,r)},o.prototype.rmdir=function(e,t){return this._stream.rmdir(e,t)},o.prototype.readdir=function(e,t,r){return this._stream.readdir(e,t,r)},o.prototype.fstat=function(e,t){return this._stream.fstat(e,t)},o.prototype.stat=function(e,t){return this._stream.stat(e,t)},o.prototype.lstat=function(e,t){return this._stream.lstat(e,t)},o.prototype.opendir=function(e,t){return this._stream.opendir(e,t)},o.prototype.setstat=function(e,t,r){return this._stream.setstat(e,t,r)},o.prototype.fsetstat=function(e,t,r){return this._stream.fsetstat(e,t,r)},o.prototype.futimes=function(e,t,r,n){return this._stream.futimes(e,t,r,n)},o.prototype.utimes=function(e,t,r,n){return this._stream.utimes(e,t,r,n)},o.prototype.fchown=function(e,t,r,n){return this._stream.fchown(e,t,r,n)},o.prototype.chown=function(e,t,r,n){return this._stream.chown(e,t,r,n)},o.prototype.fchmod=function(e,t,r){return this._stream.fchmod(e,t,r)},o.prototype.chmod=function(e,t,r){return this._stream.chmod(e,t,r)},o.prototype.readlink=function(e,t){return this._stream.readlink(e,t)},o.prototype.symlink=function(e,t,r){return this._stream.symlink(e,t,r)},o.prototype.realpath=function(e,t){return this._stream.realpath(e,t)},o.prototype.ext_openssh_rename=function(e,t,r){return this._stream.ext_openssh_rename(e,t,r)},o.prototype.ext_openssh_statvfs=function(e,t){return this._stream.ext_openssh_statvfs(e,t)},o.prototype.ext_openssh_fstatvfs=function(e,t){return this._stream.ext_openssh_fstatvfs(e,t)},o.prototype.ext_openssh_hardlink=function(e,t,r){return this._stream.ext_openssh_hardlink(e,t,r)},o.prototype.ext_openssh_fsync=function(e,t){return this._stream.ext_openssh_fsync(e,t)},e.exports=o},1119:(e,t,r)=>{var n=r(1409).Socket,i=r(7187).EventEmitter,o=r(5404).inherits,s=r(5584),a=r(6577),f=r(4507),u=r(510).readUInt32BE,c=r(510).writeUInt32BE,h=r(510).writeUInt32LE,l=/^\!<socket >(\d+) s ([A-Z0-9]{8}\-[A-Z0-9]{8}\-[A-Z0-9]{8}\-[A-Z0-9]{8})/,p=/^[/\\][/\\]\.[/\\]pipe[/\\].+/;if(e.exports=function(e,t,r,i,o){var s,d,E,m,v,y,_,w,b=0,S=Buffer.isBuffer(t),A=0,T=0,R=0,N=0,I=!1;function O(){var e;if(S){var r=9;e=Buffer.allocUnsafe(9+b+4+m+4),c(e,e.length-4,0),e[4]=13,c(e,b,5),t.copy(e,r),c(e,m,r+=b),i.copy(e,r+=4),c(e,0,r+=m),s.write(e)}else s.write(Buffer.from([0,0,0,1,11]))}function k(e){for(var r=0,n=e.length;r<n;++r)if(void 0===v)5==++A&&(v=e[r],A=0);else if(14===v)if(E){if(E[A]=e[r],++A===T)return s.removeAllListeners("data"),s.destroy()}else T<<=8,T+=e[r],4==++A&&(E=Buffer.allocUnsafe(T),A=0);else if(12===v)if(void 0===y){if(R<<=8,R+=e[r],4==++A&&(y=new Array(R),A=0,0===R))return s.removeAllListeners("data"),s.destroy()}else if(t)if(!1===I){if(t[A]=e[r],++A===b&&(y[R-1]=t,b=0,A=0,I=!0,0==--R))return t=void 0,s.removeAllListeners("data"),s.destroy()}else!0===I?(N<<=8,N+=e[r],4==++A&&(A=0,N>0?I=N:(t=void 0,I=!1),N=0)):++A===I&&(I=!1,A=0,t=void 0);else b<<=8,b+=e[r],4==++A&&(t=Buffer.allocUnsafe(b),A=0);else if(5===v)return d=S?new Error("Agent unable to sign data"):new Error("Unable to retrieve list of keys from agent"),s.removeAllListeners("data"),s.destroy()}function U(e){d=e}function B(){d?o(d):S&&!E||!S&&!y?o(new Error("Unexpected disconnection from agent")):S&&E?o(void 0,E):!S&&y&&o(void 0,y)}if("function"==typeof t&&"function"==typeof r?(_=t,w=r):S?(b=t.length,m=i.length):(o=t,t=void 0),"win32"!==process.platform||p.test(e))s=new n;else{if("pageant"!==e){var L=!1;return void a.readFile(e,(function t(r,i){if(r)return L?o(new Error("Invalid cygwin unix socket path")):void f.exec('cygpath -w "'+e+'"',(function(r,n,i){if(r||0===n.length)return o(new Error("Invalid cygwin unix socket path"));L=!0,e=n.toString().replace(/[\r\n]/g,""),a.readFile(e,t)}));var c;if(c=l.exec(i.toString("ascii"))){var p,d,E,g,m,v,y=0,_=!1,w=[],b=Buffer.allocUnsafe(12);for(b.fill(0),p=parseInt(c[1],10),d=c[2].replace(/\-/g,""),E=Buffer.allocUnsafe(16),m=0,v=0;v<32;++m,v+=2)E[m]=parseInt(d.substring(v,v+2),16);for(m=0;m<16;m+=4)h(E,u(E,m),m);function S(){y=0,g="secret",s.write(E)}function A(e){y+=e.length,"secret"===g?16===y&&(y=0,g="creds",s.write(b)):"creds"===g&&(_||w.push(e),12===y&&(s.removeListener("connect",S),s.removeListener("data",A),s.removeListener("close",T),_?(C(),s.emit("connect")):(_=!0,b=Buffer.concat(w),h(b,process.pid,0),s.destroy(),R())))}function T(){o(new Error("Problem negotiating cygwin unix socket security"))}function R(){(s=new n).once("connect",S),s.on("data",A),s.once("close",T),s.connect(p)}R()}else o(new Error("Malformed cygwin unix socket file"))}))}s=new g}function C(){var e;_||w?(s.once("connect",(function(){e=_();var t=!1;function r(){t||(s.destroy(),t=!0)}e.once("end",r).once("close",r).on("data",(function(e){s.write(e)})),s.on("data",(function(t){e.write(t)}))})),s.once("close",(function(){e||w()}))):(s.once("connect",O),s.on("data",k),s.once("error",U),s.once("close",B))}C(),s.connect(e)},"win32"===process.platform){var d={},E=s.resolve("/","..","util/pagent.exe");function g(){this.proc=void 0,this.buffer=null}d[10]=new Error("Invalid pagent.exe arguments"),d[11]=new Error("Pageant is not running"),d[12]=new Error("pagent.exe could not create an mmap"),d[13]=new Error("pagent.exe could not set mode for stdin"),d[14]=new Error("pagent.exe could not set mode for stdout"),d[15]=new Error("pagent.exe did not get expected input payload"),o(g,i),g.prototype.write=function(e){if(null===this.buffer?this.buffer=e:this.buffer=Buffer.concat([this.buffer,e],this.buffer.length+e.length),!(this.buffer.length<4)){var t=u(this.buffer,0);if(!(this.buffer.length-4<t)){e=this.buffer.slice(0,4+t),this.buffer.length>4+t?this.buffer=this.buffer.slice(4+t):this.buffer=null;var r,n=this,i=!1;(r=this.proc=f.spawn(E,[e.length])).stdout.on("data",(function(e){n.emit("data",e)})),r.once("error",(function(e){i||(i=!0,n.emit("error",e))})),r.once("close",(function(e){n.proc=void 0,d[e]&&!i&&(i=!0,n.emit("error",d[e])),n.emit("close",i)})),r.stdin.end(e)}}},g.prototype.end=g.prototype.destroy=function(){this.buffer=null,this.proc&&(this.proc.kill(),this.proc=void 0)},g.prototype.connect=function(){this.emit("connect")}}},510:e=>{e.exports={readUInt32BE:function(e,t){return 16777216*e[t++]+65536*e[t++]+256*e[t++]+e[t]},writeUInt32BE:function(e,t,r){return e[r++]=t>>>24,e[r++]=t>>>16,e[r++]=t>>>8,e[r++]=t,r},writeUInt32LE:function(e,t,r){return e[r++]=t,e[r++]=t>>>8,e[r++]=t>>>16,e[r++]=t>>>24,r}}},2353:(e,t,r)=>{var n=r(9946),i=r(1409).Socket,o=r(9997).lookup,s=r(7187).EventEmitter,a=r(5404).inherits,f=n.getHashes(),u=r(816),c=u.SSH2Stream,h=u.SFTPStream,l=u.constants,p=l.BUGS,d=l.ALGORITHMS,E=l.EDDSA_SUPPORTED,g=u.utils.parseKey,m=r(3657),v=r(491),y=r(1119),_=r(2519),w=r(510).readUInt32BE,b=Math.pow(2,32)-1,S=/^OpenSSH_(?:(?![0-4])\d)|(?:\d{2,})/,A=function(e){};function T(){if(!(this instanceof T))return new T;s.call(this),this.config={host:void 0,port:void 0,localAddress:void 0,localPort:void 0,forceIPv4:void 0,forceIPv6:void 0,keepaliveCountMax:void 0,keepaliveInterval:void 0,readyTimeout:void 0,username:void 0,password:void 0,privateKey:void 0,tryKeyboard:void 0,agent:void 0,allowAgentFwd:void 0,authHandler:void 0,hostHashAlgo:void 0,hostHashCb:void 0,strictVendor:void 0,debug:void 0},this._readyTimeout=void 0,this._channels=void 0,this._callbacks=void 0,this._forwarding=void 0,this._forwardingUnix=void 0,this._acceptX11=void 0,this._agentFwdEnabled=void 0,this._curChan=void 0,this._remoteVer=void 0,this._sshstream=void 0,this._sock=void 0,this._resetKA=void 0}function R(e,t,r,n){var i=N(e),o=v.MAX_WINDOW,s=v.PACKET_SIZE,a=!0;if(!1===i)return n(new Error("No free channels available"));"function"==typeof r&&(n=r,r={}),e._channels[i]=n;var f=e._sshstream;return f.once("CHANNEL_OPEN_CONFIRMATION:"+i,u).once("CHANNEL_OPEN_FAILURE:"+i,c).once("CHANNEL_CLOSE:"+i,c),"session"===t?a=f.session(i,o,s):"direct-tcpip"===t?a=f.directTcpip(i,o,s,r):"direct-streamlocal@openssh.com"===t&&(a=f.openssh_directStreamLocal(i,o,s,r)),a;function u(r){f.removeListener("CHANNEL_OPEN_FAILURE:"+i,c),f.removeListener("CHANNEL_CLOSE:"+i,c);var a={type:t,incoming:{id:i,window:o,packetSize:s,state:"open"},outgoing:{id:r.sender,window:r.window,packetSize:r.packetSize,state:"open"}};n(void 0,new v(a,e))}function c(t){var r;f.removeListener("CHANNEL_OPEN_CONFIRMATION:"+i,u),f.removeListener("CHANNEL_OPEN_FAILURE:"+i,c),f.removeListener("CHANNEL_CLOSE:"+i,c),delete e._channels[i],t instanceof Error?r=t:"object"==typeof t&&null!==t?((r=new Error("(SSH) Channel open failure: "+t.description)).reason=t.reason,r.lang=t.lang):(r=new Error("(SSH) Channel open failure: server closed channel unexpectedly")).reason=r.lang="",n(r)}}function N(e){if(e._curChan<b)return++e._curChan;for(var t=0,r=e._channels;t<b;++t)if(!r[t])return t;return!1}function I(e,t,r){var n={single:!1,protocol:"MIT-MAGIC-COOKIE-1",cookie:void 0,screen:0};"function"==typeof t?r=t:"object"==typeof t&&null!==t&&("boolean"==typeof t.single&&(n.single=t.single),"number"==typeof t.screen&&(n.screen=t.screen),"string"==typeof t.protocol&&(n.protocol=t.protocol),"string"==typeof t.cookie?n.cookie=t.cookie:Buffer.isBuffer(t.cookie)&&(n.cookie=t.cookie.toString("hex"))),void 0===n.cookie&&(n.cookie=L());var i="function"==typeof r;return"open"!==e.outgoing.state?(i&&r(new Error("Channel is not open")),!0):(i&&e._callbacks.push((function(t){if(t)return r(!0!==t?t:new Error("Unable to request X11"));e._hasX11=!0,++e._client._acceptX11,e.once("close",(function(){e._client._acceptX11&&--e._client._acceptX11})),r()})),e._client._sshstream.x11Forward(e.outgoing.id,n,i))}function O(e,t,r){var n=24,i=80,o=640,s=480,a="vt100",f=null;"function"==typeof t?r=t:"object"==typeof t&&null!==t&&("number"==typeof t.rows&&(n=t.rows),"number"==typeof t.cols&&(i=t.cols),"number"==typeof t.width&&(o=t.width),"number"==typeof t.height&&(s=t.height),"string"==typeof t.term&&(a=t.term),"object"==typeof t.modes&&(f=t.modes));var u="function"==typeof r;return"open"!==e.outgoing.state?(u&&r(new Error("Channel is not open")),!0):(u&&e._callbacks.push((function(e){if(e)return r(!0!==e?e:new Error("Unable to request a pseudo-terminal"));r()})),e._client._sshstream.pty(e.outgoing.id,n,i,s,o,a,f,u))}function k(e,t){var r="function"==typeof t;return"open"!==e.outgoing.state?(r&&t(new Error("Channel is not open")),!0):e._client._agentFwdEnabled?(r&&t(!1),!0):(e._client._agentFwdEnabled=!0,e._callbacks.push((function(n){if(n)return e._client._agentFwdEnabled=!1,void(r&&t(!0!==n?n:new Error("Unable to request agent forwarding")));r&&t()})),e._client._sshstream.openssh_agentForward(e.outgoing.id,!0))}function U(e,t){if("open"!==e.outgoing.state)return!0;for(var r,n,i=!0,o=Object.keys(t||{}),s=0,a=o.length;s<a;++s)n=t[r=o[s]],i=e._client._sshstream.env(e.outgoing.id,r,n,!1);return i}function B(e,t,r){return"open"!==e.outgoing.state?(r(new Error("Channel is not open")),!0):(e._callbacks.push((function(n){if(n)return r(!0!==n?n:new Error("Unable to start subsystem: "+t));e.subtype="subsystem",r(void 0,e)})),e._client._sshstream.subsystem(e.outgoing.id,t,!0))}a(T,s),T.prototype.connect=function(e){var t=this;if(this._sock&&this._sock.writable)return this.once("close",(function(){t.connect(e)})),void this.end();this.config.host=e.hostname||e.host||"localhost",this.config.port=e.port||22,this.config.localAddress="string"==typeof e.localAddress?e.localAddress:void 0,this.config.localPort="string"==typeof e.localPort||"number"==typeof e.localPort?e.localPort:void 0,this.config.forceIPv4=e.forceIPv4||!1,this.config.forceIPv6=e.forceIPv6||!1,this.config.keepaliveCountMax="number"==typeof e.keepaliveCountMax&&e.keepaliveCountMax>=0?e.keepaliveCountMax:3,this.config.keepaliveInterval="number"==typeof e.keepaliveInterval&&e.keepaliveInterval>0?e.keepaliveInterval:0,this.config.readyTimeout="number"==typeof e.readyTimeout&&e.readyTimeout>=0?e.readyTimeout:2e4;var r,s={kex:void 0,kexBuf:void 0,cipher:void 0,cipherBuf:void 0,serverHostKey:void 0,serverHostKeyBuf:void 0,hmac:void 0,hmacBuf:void 0,compress:void 0,compressBuf:void 0};if("object"==typeof e.algorithms&&null!==e.algorithms){var a,u;if(u=e.algorithms.kex,Array.isArray(u)&&u.length>0){for(a=d.SUPPORTED_KEX,r=0;r<u.length;++r)if(-1===a.indexOf(u[r]))throw new Error("Unsupported key exchange algorithm: "+u[r]);s.kex=u}if(u=e.algorithms.cipher,Array.isArray(u)&&u.length>0){for(a=d.SUPPORTED_CIPHER,r=0;r<u.length;++r)if(-1===a.indexOf(u[r]))throw new Error("Unsupported cipher algorithm: "+u[r]);s.cipher=u}if(u=e.algorithms.serverHostKey,Array.isArray(u)&&u.length>0){for(a=d.SUPPORTED_SERVER_HOST_KEY,r=0;r<u.length;++r)if(-1===a.indexOf(u[r]))throw new Error("Unsupported server host key algorithm: "+u[r]);s.serverHostKey=u}if(u=e.algorithms.hmac,Array.isArray(u)&&u.length>0){for(a=d.SUPPORTED_HMAC,r=0;r<u.length;++r)if(-1===a.indexOf(u[r]))throw new Error("Unsupported HMAC algorithm: "+u[r]);s.hmac=u}if(u=e.algorithms.compress,Array.isArray(u)&&u.length>0){for(a=d.SUPPORTED_COMPRESS,r=0;r<u.length;++r)if(-1===a.indexOf(u[r]))throw new Error("Unsupported compression algorithm: "+u[r]);s.compress=u}}if(void 0===s.compress&&(e.compress?(s.compress=["zlib@openssh.com","zlib"],"force"!==e.compress&&s.compress.push("none")):!1===e.compress&&(s.compress=["none"])),"string"==typeof e.username)this.config.username=e.username;else{if("string"!=typeof e.user)throw new Error("Invalid username");this.config.username=e.user}this.config.password="string"==typeof e.password?e.password:void 0,this.config.privateKey="string"==typeof e.privateKey||Buffer.isBuffer(e.privateKey)?e.privateKey:void 0,this.config.localHostname="string"==typeof e.localHostname&&e.localHostname.length?e.localHostname:void 0,this.config.localUsername="string"==typeof e.localUsername&&e.localUsername.length?e.localUsername:void 0,this.config.tryKeyboard=!0===e.tryKeyboard,this.config.agent="string"==typeof e.agent&&e.agent.length?e.agent:void 0,this.config.allowAgentFwd=!0===e.agentForward&&void 0!==this.config.agent;var h=this.config.authHandler="function"==typeof e.authHandler?e.authHandler:void 0;this.config.strictVendor="boolean"!=typeof e.strictVendor||e.strictVendor;var p=this.config.debug="function"==typeof e.debug?e.debug:A;if(!0===e.agentForward&&!this.config.allowAgentFwd)throw new Error("You must set a valid agent path to allow agent forwarding");var m,_=this._callbacks=[];if(this._channels={},this._forwarding={},this._forwardingUnix={},this._acceptX11=0,this._agentFwdEnabled=!1,this._curChan=-1,this._remoteVer=void 0,this.config.privateKey){if((m=g(this.config.privateKey,e.passphrase))instanceof Error)throw new Error("Cannot parse privateKey: "+m.message);if(Array.isArray(m)&&(m=m[0]),null===m.getPrivatePEM())throw new Error("privateKey value does not contain a (valid) private key")}var b=this._sshstream=new c({algorithms:s,debug:p===A?void 0:p}),S=this._sock=e.sock||new i;this._sock.stderr&&"function"==typeof this._sock.stderr.resume&&this._sock.stderr.resume();var T,R,I=this.config.keepaliveInterval,O=this.config.keepaliveCountMax,k=0;function U(){if(++k>O){if(clearInterval(T),S.readable){var e=new Error("Keepalive timeout");e.level="client-timeout",t.emit("error",e),S.destroy()}}else S.writable?(_.push(B),b.ping()):clearInterval(T)}function B(){I>0&&(k=0,clearInterval(T),S.writable&&(T=setInterval(U,I)))}if(this._resetKA=B,b.on("USERAUTH_BANNER",(function(e){t.emit("banner",e)})),S.on("connect",(function(){p("DEBUG: Client: Connected"),t.emit("connect"),e.sock||b.pipe(S).pipe(b)})).on("timeout",(function(){t.emit("timeout")})).on("error",(function(e){clearTimeout(t._readyTimeout),e.level="client-socket",t.emit("error",e)})).on("end",(function(){b.unpipe(S),clearTimeout(t._readyTimeout),clearInterval(T),t.emit("end")})).on("close",(function(){b.unpipe(S),clearTimeout(t._readyTimeout),clearInterval(T),t.emit("close");var e=_,n=new Error("No response from server");for(_=t._callbacks=[],r=0;r<e.length;++r)e[r](n);var i=t._channels,o=Object.keys(i);for(t._channels={},r=0;r<o.length;++r){var s,a=b.emit("CHANNEL_OPEN_FAILURE:"+o[r],n),f=b.emit("CHANNEL_CLOSE:"+o[r]);a||f||!(s=i[o[r]])||"function"!=typeof s||s(n)}})),b.on("drain",(function(){t.emit("drain")})).once("header",(function(e){t._remoteVer=e.versions.software,e.greeting&&t.emit("greeting",e.greeting)})).on("continue",(function(){t.emit("continue")})).on("error",(function(e){void 0===e.level?e.level="protocol":"handshake"===e.level&&clearTimeout(t._readyTimeout),t.emit("error",e)})).on("end",(function(){S.resume()})),"function"==typeof e.hostVerifier){if(-1===f.indexOf(e.hostHash))throw new Error("Invalid host hash algorithm: "+e.hostHash);var L=e.hostVerifier,C=n.createHash(e.hostHash);b.once("fingerprint",(function(e,t){C.update(e);var r=L(C.digest("hex"),t);void 0!==r&&t(r)}))}var P,D=null,H=null,x=0,M=["none"];if(void 0!==this.config.password&&M.push("password"),void 0!==m&&M.push("publickey"),void 0!==this.config.agent&&M.push("agent"),this.config.tryKeyboard&&M.push("keyboard-interactive"),void 0!==m&&void 0!==this.config.localHostname&&void 0!==this.config.localUsername&&M.push("hostbased"),void 0===h){var K=0;h=function(e,t,r){return K!==M.length&&M[K++]}}var F=!1;function G(e){if(F=!0,!1===e){b.removeListener("USERAUTH_FAILURE",V),b.removeListener("USERAUTH_PK_OK",j);var r=new Error("All configured authentication methods failed");return r.level="client-authentication",t.emit("error",r),void(b.writable&&t.end())}if(-1===M.indexOf(e))throw new Error("Authentication method not allowed: "+e);switch(R=e){case"password":b.authPassword(t.config.username,t.config.password);break;case"publickey":b.authPK(t.config.username,m),b.once("USERAUTH_PK_OK",j);break;case"hostbased":b.authHostbased(t.config.username,m,t.config.localHostname,t.config.localUsername,(function(e,r){var n=m.sign(e);if(n instanceof Error)return n.message="Error while signing data with privateKey: "+n.message,n.level="client-authentication",t.emit("error",n),q();r(n)}));break;case"agent":y(t.config.agent,(function(e,r){return e?(e.level="agent",t.emit("error",e),P=void 0,q()):0===r.length?(p("DEBUG: Agent: No keys stored in agent"),P=void 0,q()):(P=r,x=0,b.authPK(t.config.username,r[0]),void b.once("USERAUTH_PK_OK",j))}));break;case"keyboard-interactive":b.authKeyboard(t.config.username),b.on("USERAUTH_INFO_REQUEST",W);break;case"none":b.authNone(t.config.username)}}function q(){F=!1;var e=h(H,D,G);F||void 0===e||G(e)}function X(){if("agent"===R){if(x>=P.length)return;++x>=P.length?(p("DEBUG: Agent: No more keys left to try"),p("DEBUG: Client: agent auth failed"),P=void 0,q()):(p("DEBUG: Agent: Trying key #"+(x+1)),b.authPK(t.config.username,P[x]),b.once("USERAUTH_PK_OK",j))}}function W(e,r,n,i){if(0===(Array.isArray(i)?i.length:0))return p("DEBUG: Client: Sending automatic USERAUTH_INFO_RESPONSE"),b.authInfoRes();t.emit("keyboard-interactive",e,r,n,i,(function(e){b.authInfoRes(e)}))}function j(){if("agent"===R){var e=P[x],r=w(e,0),n=e.toString("ascii",4,4+r),i=n.slice(4);switch(n){case"ssh-rsa":case"ssh-dss":case"ecdsa-sha2-nistp256":case"ecdsa-sha2-nistp384":case"ecdsa-sha2-nistp521":break;default:if(E&&"ssh-ed25519"===n)break;return p("DEBUG: Agent: Skipping unsupported key type: "+n),X()}b.authPK(t.config.username,e,(function(r,o){y(t.config.agent,e,i,r,(function(e,r){if(e)e.level="agent",t.emit("error",e);else{var i=w(r,0);if(4+i+4<r.length){if(r.toString("ascii",4,4+i)===n)return o(r.slice(4+i+4));(e=new Error("Agent key/signature type mismatch")).level="agent",t.emit("error",e)}}X()}))}))}else"publickey"===R&&b.authPK(t.config.username,m,(function(e,r){var n=m.sign(e);if(n instanceof Error)return n.message="Error while signing data with privateKey: "+n.message,n.level="client-authentication",t.emit("error",n),q();r(n)}))}function V(e,t){if(b.removeListener("USERAUTH_PK_OK",j),b.removeListener("USERAUTH_INFO_REQUEST",W),"agent"===R)return p("DEBUG: Client: Agent key #"+(x+1)+" failed"),X();p("DEBUG: Client: "+R+" auth failed"),D=t,H=e,q()}if(b.once("USERAUTH_SUCCESS",(function(){b.removeListener("USERAUTH_FAILURE",V),b.removeListener("USERAUTH_INFO_REQUEST",W),B(),clearTimeout(t._readyTimeout),t.emit("ready")})).on("USERAUTH_FAILURE",V),b.once("ready",(function(){b.service("ssh-userauth"),b.once("SERVICE_ACCEPT",(function(e){"ssh-userauth"===e&&q()}))})),b.on("CHANNEL_OPEN",(function(e){!function(e,t){var r,n=!1;function i(){var r={type:t.type,incoming:{id:n,window:v.MAX_WINDOW,packetSize:v.PACKET_SIZE,state:"open"},outgoing:{id:t.sender,window:t.window,packetSize:t.packetSize,state:"open"}},i=new v(r,e);return e._sshstream.channelOpenConfirm(t.sender,n,v.MAX_WINDOW,v.PACKET_SIZE),i}function o(){void 0===r&&(r=!1===n?l.CHANNEL_OPEN_FAILURE.RESOURCE_SHORTAGE:l.CHANNEL_OPEN_FAILURE.CONNECT_FAILED),e._sshstream.channelOpenFail(t.sender,r,"","")}if("forwarded-tcpip"===t.type||"x11"===t.type||"auth-agent@openssh.com"===t.type||"forwarded-streamlocal@openssh.com"===t.type){var s="forwarded-tcpip"===t.type&&void 0===e._forwarding[t.data.destIP+":"+t.data.destPort]||"forwarded-streamlocal@openssh.com"===t.type&&void 0===e._forwardingUnix[t.data.socketPath]||"x11"===t.type&&0===e._acceptX11||"auth-agent@openssh.com"===t.type&&!e._agentFwdEnabled;s?(r=l.CHANNEL_OPEN_FAILURE.ADMINISTRATIVELY_PROHIBITED,e.config.debug("DEBUG: Client: Automatic rejection of incoming channel open: unexpected channel open for: "+t.type)):!1===(n=N(e))?(e.config.debug("DEBUG: Client: Automatic rejection of incoming channel open: no channels available"),s=!0):e._channels[n]=!0,s&&o(),!1!==n&&("forwarded-tcpip"===t.type?(0===t.data.destPort&&(t.data.destPort=e._forwarding[t.data.destIP+":"+t.data.destPort]),e.emit("tcp connection",t.data,i,o)):"x11"===t.type?e.emit("x11",t.data,i,o):"forwarded-streamlocal@openssh.com"===t.type?e.emit("unix connection",t.data,i,o):y(e.config.agent,i,o))}else e.config.debug("DEBUG: Client: Automatic rejection of incoming channel open: unsupported type: "+t.type),r=l.CHANNEL_OPEN_FAILURE.UNKNOWN_CHANNEL_TYPE,o()}(t,e)})),b.on("REQUEST_SUCCESS",(function(e){_.length&&_.shift()(!1,e)})).on("REQUEST_FAILURE",(function(){_.length&&_.shift()(!0)})),b.on("GLOBAL_REQUEST",(function(e,t,r){t&&b.requestFailure()})),e.sock)Z(),b.pipe(S).pipe(b);else{var Y=this.config.host,Q=this.config.forceIPv4,z=this.config.forceIPv6;function $(){Z(),t._sock.connect({host:Y,port:t.config.port,localAddress:t.config.localAddress,localPort:t.config.localPort}),t._sock.setNoDelay(!0),t._sock.setMaxListeners(0),t._sock.setTimeout("number"==typeof e.timeout?e.timeout:0)}p("DEBUG: Client: Trying "+Y+" on port "+this.config.port+" ..."),!Q&&!z||Q&&z?$():o(Y,Q?4:6,(function(e,r,n){if(e){var i=new Error("Error while looking up "+(Q?"IPv4":"IPv6")+" address for host "+Y+": "+e);return clearTimeout(t._readyTimeout),i.level="client-dns",t.emit("error",i),void t.emit("close")}Y=r,$()}))}function Z(){t.config.readyTimeout>0&&(t._readyTimeout=setTimeout((function(){var e=new Error("Timed out while waiting for handshake");e.level="client-timeout",t.emit("error",e),S.destroy()}),t.config.readyTimeout))}},T.prototype.end=function(){return!!(this._sock&&this._sock.writable&&this._sshstream&&this._sshstream.writable)&&this._sshstream.disconnect()},T.prototype.destroy=function(){this._sock&&this._sock.destroy()},T.prototype.exec=function(e,t,r){if(!(this._sock&&this._sock.writable&&this._sshstream&&this._sshstream.writable))throw new Error("Not connected");"function"==typeof t&&(r=t,t={});var n=this;return R(this,"session",{allowHalfOpen:!1!==t.allowHalfOpen},(function(i,o){if(i)return r(i);var s=[];function a(e){if(e)return o.close(),r(e);s.length&&s.shift()()}(!0===n.config.allowAgentFwd||t&&!0===t.agentForward&&void 0!==n.config.agent)&&s.push((function(){k(o,a)})),"object"==typeof t&&null!==t&&("object"==typeof t.env&&null!==t.env&&U(o,t.env),("object"==typeof t.pty&&null!==t.pty||!0===t.pty)&&s.push((function(){O(o,t.pty,a)})),("object"==typeof t.x11&&null!==t.x11||"number"===t.x11||!0===t.x11)&&s.push((function(){I(o,t.x11,a)}))),s.push((function(){!function(e,t,r,n){if("open"!==e.outgoing.state)return n(new Error("Channel is not open")),!0;e._callbacks.push((function(t){if(t)return n(!0!==t?t:new Error("Unable to exec"));e.subtype="exec",e.allowHalfOpen=!1!==r.allowHalfOpen,n(void 0,e)})),e._client._sshstream.exec(e.outgoing.id,t,!0)}(o,e,t,r)})),s.shift()()}))},T.prototype.shell=function(e,t,r){if(!(this._sock&&this._sock.writable&&this._sshstream&&this._sshstream.writable))throw new Error("Not connected");var n=this;return"function"==typeof e?(r=e,e=t=void 0):"function"==typeof t&&(r=t,t=void 0),!e||void 0===e.x11&&void 0===e.env||(t=e,e=void 0),R(this,"session",(function(i,o){if(i)return r(i);var s=[];function a(e){if(e)return o.close(),r(e);s.length&&s.shift()()}(!0===n.config.allowAgentFwd||t&&!0===t.agentForward&&void 0!==n.config.agent)&&s.push((function(){k(o,a)})),!1!==e&&s.push((function(){O(o,e,a)})),"object"==typeof t&&null!==t&&("object"==typeof t.env&&null!==t.env&&U(o,t.env),("object"==typeof t.x11&&null!==t.x11||"number"===t.x11||!0===t.x11)&&s.push((function(){I(o,t.x11,a)}))),s.push((function(){!function(e,t){if("open"!==e.outgoing.state)return t(new Error("Channel is not open")),!0;e._callbacks.push((function(r){if(r)return t(!0!==r?r:new Error("Unable to open shell"));e.subtype="shell",t(void 0,e)})),e._client._sshstream.shell(e.outgoing.id,!0)}(o,r)})),s.shift()()}))},T.prototype.subsys=function(e,t){if(!(this._sock&&this._sock.writable&&this._sshstream&&this._sshstream.writable))throw new Error("Not connected");return R(this,"session",(function(r,n){if(r)return t(r);B(n,e,(function(e,r){if(e)return t(e);t(void 0,r)}))}))},T.prototype.sftp=function(e){if(!(this._sock&&this._sock.writable&&this._sshstream&&this._sshstream.writable))throw new Error("Not connected");var t=this;return R(this,"session",(function(r,n){if(r)return e(r);B(n,"sftp",(function(r,n){if(r)return e(r);var i=t._sshstream._state.incoming.identRaw,o={debug:t.config.debug},s=new h(o,i);function a(t){s.removeListener("ready",f),n.removeListener("exit",u),e(t)}function f(){s.removeListener("error",a),n.removeListener("exit",u),e(void 0,new _(s))}function u(t,r){s.removeListener("ready",f),s.removeListener("error",a);var n=new Error("number"==typeof t?"Received exit code "+t+" while establishing SFTP session":"Received signal "+r+" while establishing SFTP session");n.code=t,n.signal=r,e(n)}s.once("error",a).once("ready",f).once("close",(function(){n.end()})),n.once("exit",u),s.pipe(n).pipe(s)}))}))},T.prototype.forwardIn=function(e,t,r){if(!(this._sock&&this._sock.writable&&this._sshstream&&this._sshstream.writable))throw new Error("Not connected");var n=this,i="function"==typeof r;return i&&this._callbacks.push((function(i,o){if(i)return r(!0!==i?i:new Error("Unable to bind to "+e+":"+t));var s=t;0===t&&o&&o.length>=4&&(s=w(o,0),n._sshstream.remoteBugs&p.DYN_RPORT_BUG||(t=s)),n._forwarding[e+":"+t]=s,r(void 0,s)})),this._sshstream.tcpipForward(e,t,i)},T.prototype.unforwardIn=function(e,t,r){if(!(this._sock&&this._sock.writable&&this._sshstream&&this._sshstream.writable))throw new Error("Not connected");var n=this,i="function"==typeof r;return i&&this._callbacks.push((function(i){if(i)return r(!0!==i?i:new Error("Unable to unbind from "+e+":"+t));delete n._forwarding[e+":"+t],r()})),this._sshstream.cancelTcpipForward(e,t,i)},T.prototype.forwardOut=function(e,t,r,n,i){if(!(this._sock&&this._sock.writable&&this._sshstream&&this._sshstream.writable))throw new Error("Not connected");return R(this,"direct-tcpip",{srcIP:e,srcPort:t,dstIP:r,dstPort:n},i)},T.prototype.openssh_noMoreSessions=function(e){if(!(this._sock&&this._sock.writable&&this._sshstream&&this._sshstream.writable))throw new Error("Not connected");var t="function"==typeof e;return!this.config.strictVendor||this.config.strictVendor&&S.test(this._remoteVer)?(t&&this._callbacks.push((function(t){if(t)return e(!0!==t?t:new Error("Unable to disable future sessions"));e()})),this._sshstream.openssh_noMoreSessions(t)):(t&&process.nextTick((function(){e(new Error("strictVendor enabled and server is not OpenSSH or compatible version"))})),!0)},T.prototype.openssh_forwardInStreamLocal=function(e,t){if(!(this._sock&&this._sock.writable&&this._sshstream&&this._sshstream.writable))throw new Error("Not connected");var r="function"==typeof t,n=this;return!this.config.strictVendor||this.config.strictVendor&&S.test(this._remoteVer)?(r&&this._callbacks.push((function(r){if(r)return t(!0!==r?r:new Error("Unable to bind to "+e));n._forwardingUnix[e]=!0,t()})),this._sshstream.openssh_streamLocalForward(e,r)):(r&&process.nextTick((function(){t(new Error("strictVendor enabled and server is not OpenSSH or compatible version"))})),!0)},T.prototype.openssh_unforwardInStreamLocal=function(e,t){if(!(this._sock&&this._sock.writable&&this._sshstream&&this._sshstream.writable))throw new Error("Not connected");var r="function"==typeof t,n=this;return!this.config.strictVendor||this.config.strictVendor&&S.test(this._remoteVer)?(r&&this._callbacks.push((function(r){if(r)return t(!0!==r?r:new Error("Unable to unbind on "+e));delete n._forwardingUnix[e],t()})),this._sshstream.openssh_cancelStreamLocalForward(e,r)):(r&&process.nextTick((function(){t(new Error("strictVendor enabled and server is not OpenSSH or compatible version"))})),!0)},T.prototype.openssh_forwardOutStreamLocal=function(e,t){if(!(this._sock&&this._sock.writable&&this._sshstream&&this._sshstream.writable))throw new Error("Not connected");return!this.config.strictVendor||this.config.strictVendor&&S.test(this._remoteVer)?R(this,"direct-streamlocal@openssh.com",{socketPath:e},t):(process.nextTick((function(){t(new Error("strictVendor enabled and server is not OpenSSH or compatible version"))})),!0)};var L=function(){if("function"==typeof n.randomFillSync){var e=Buffer.alloc(16);return function(){return n.randomFillSync(e,0,16),e.toString("hex")}}return function(){return n.randomBytes(16).toString("hex")}}();T.Client=T,T.Server=r(7465),T.utils=u.utils,T.SFTP_STATUS_CODE=h.STATUS_CODE,T.SFTP_OPEN_MODE=h.OPEN_MODE,T.HTTPAgent=m.SSHTTPAgent,T.HTTPSAgent=m.SSHTTPSAgent,e.exports=T},3657:(e,t,r)=>{var n,i=r(4959).Agent,o=r(8373).Agent,s=r(5404).inherits;function a(e,t){var i=e&&e.localAddress||this._defaultSrcIP,o=e&&e.localPort||0,s=e.host,a=e.port;void 0===n&&(n=r(2353).Client);var u=new n,c=!1;u.on("ready",(()=>{u.forwardOut(i,o,s,a,((e,r)=>{if(c=!0,e)return u.end(),t(e);r.once("close",(()=>{u.end()})),t(null,function(e){return e.setKeepAlive=f,e.setNoDelay=f,e.setTimeout=f,e.ref=f,e.unref=f,e.destroySoon=e.destroy,e}(r))}))})).on("error",t).on("close",(()=>{c||t(new Error("Unexpected connection loss"))})).connect(this._connectCfg)}function f(){}[i,o].forEach((e=>{function r(t,n){if(!(this instanceof r))return new r(t,n);e.call(this,n),this._connectCfg=t,this._defaultSrcIP=n&&n.srcIP||"localhost"}s(r,e),r.prototype.createConnection=a,t[e===i?"SSHTTPAgent":"SSHTTPSAgent"]=r}))},4055:e=>{function t(e,t){for(var r=t,n=r+1,i=e.length;n<i;r+=1,n+=1)e[r]=e[n];e.pop()}function r(e,r,n){var i=this._streams=[];this._timer=void 0,this._timerInterval=e,this._timerfn=function(){for(var e,o,s=Date.now(),a=0,f=i.length;a<f;++a)if((o=(e=i[a])._kalast)&&s-o>=r)if(++e._kacnt>n){var u=new Error("Keepalive timeout");u.level="client-timeout",e.emit("error",u),e.disconnect(),t(i,a),--a,f=i.length}else e._kalast=s,e.ping()}}r.prototype.start=function(){this._timer&&this.stop(),this._timer=setInterval(this._timerfn,this._timerInterval)},r.prototype.stop=function(){this._timer&&(clearInterval(this._timer),this._timer=void 0)},r.prototype.add=function(e){var t=this._streams,r=this;function n(){e._kalast=Date.now(),e._kacnt=0}e.once("end",(function(){r.remove(e)})).on("packet",n),t[t.length]=e,n(),this._timer||this.start()},r.prototype.remove=function(e){var r=this._streams,n=r.indexOf(e);n>-1&&t(r,n),r.length||this.stop()},e.exports=r},7465:(e,t,r)=>{var n,i=r(1409),o=r(7187).EventEmitter,s=o.listenerCount,a=r(5404).inherits,f=r(816),u=f.utils.parseKey,c=f.SSH2Stream,h=f.SFTPStream,l=f.constants,p=l.DISCONNECT_REASON,d=l.CHANNEL_OPEN_FAILURE,E=l.ALGORITHMS,g=r(491),m=r(4055),v=r(510).writeUInt32BE,y=Math.pow(2,32)-1;function _(e,t){if(!(this instanceof _))return new _(e,t);var r,a={"ssh-rsa":null,"ssh-dss":null,"ssh-ed25519":null,"ecdsa-sha2-nistp256":null,"ecdsa-sha2-nistp384":null,"ecdsa-sha2-nistp521":null},f=e.hostKeys;if(!Array.isArray(f))throw new Error("hostKeys must be an array");for(r=0;r<f.length;++r){var h;if((h=Buffer.isBuffer(f[r])||"string"==typeof f[r]?u(f[r]):u(f[r].key,f[r].passphrase))instanceof Error)throw new Error("Cannot parse privateKey: "+h.message);if(Array.isArray(h)&&(h=h[0]),null===h.getPrivatePEM())throw new Error("privateKey value contains an invalid private key");a[h.type]||(a[h.type]=h)}var l={kex:void 0,kexBuf:void 0,cipher:void 0,cipherBuf:void 0,serverHostKey:void 0,serverHostKeyBuf:void 0,hmac:void 0,hmacBuf:void 0,compress:void 0,compressBuf:void 0};if("object"==typeof e.algorithms&&null!==e.algorithms){var d,g;if(g=e.algorithms.kex,Array.isArray(g)&&g.length>0){for(d=E.SUPPORTED_KEX,r=0;r<g.length;++r)if(-1===d.indexOf(g[r]))throw new Error("Unsupported key exchange algorithm: "+g[r]);l.kex=g}if(g=e.algorithms.cipher,Array.isArray(g)&&g.length>0){for(d=E.SUPPORTED_CIPHER,r=0;r<g.length;++r)if(-1===d.indexOf(g[r]))throw new Error("Unsupported cipher algorithm: "+g[r]);l.cipher=g}g=e.algorithms.serverHostKey;var v=!1;if(Array.isArray(g)&&g.length>0){for(d=E.SUPPORTED_SERVER_HOST_KEY,r=g.length-1;r>=0;--r){if(-1===d.indexOf(g[r]))throw new Error("Unsupported server host key algorithm: "+g[r]);a[g[r]]||(v||(g=g.slice(),v=!0),g.splice(r,1))}g.length>0&&(l.serverHostKey=g)}if(g=e.algorithms.hmac,Array.isArray(g)&&g.length>0){for(d=E.SUPPORTED_HMAC,r=0;r<g.length;++r)if(-1===d.indexOf(g[r]))throw new Error("Unsupported HMAC algorithm: "+g[r]);l.hmac=g}if(g=e.algorithms.compress,Array.isArray(g)&&g.length>0){for(d=E.SUPPORTED_COMPRESS,r=0;r<g.length;++r)if(-1===d.indexOf(g[r]))throw new Error("Unsupported compression algorithm: "+g[r]);l.compress=g}}if(void 0===l.serverHostKey){var y=Object.keys(a);for(r=y.length-1;r>=0;--r)a[y[r]]||y.splice(r,1);l.serverHostKey=y}!n&&_.KEEPALIVE_INTERVAL>0&&_.KEEPALIVE_CLIENT_INTERVAL>0&&_.KEEPALIVE_CLIENT_COUNT_MAX>=0&&(n=new m(_.KEEPALIVE_INTERVAL,_.KEEPALIVE_CLIENT_INTERVAL,_.KEEPALIVE_CLIENT_COUNT_MAX));var b=this;o.call(this),"function"==typeof t&&b.on("connection",t);var S,A,T={algorithms:l,hostKeys:a,server:!0};for(r=0,A=(S=Object.keys(e)).length;r<A;++r){var R=S[r];"privateKey"!==R&&"publicKey"!==R&&"passphrase"!==R&&"algorithms"!==R&&"hostKeys"!==R&&"server"!==R&&(T[R]=e[R])}if("function"==typeof T.debug)var N=T.debug,I=Object.keys(T);this._srv=new i.Server((function(e){if(b._connections>=b.maxConnections)e.destroy();else{++b._connections,e.once("close",(function(e){--b._connections,o.read()})).on("error",(function(e){o.reset(),o.emit("error",e)}));var t=T;if(N){t={};for(var r,n=0;n<I.length;++n)t[r=I[n]]=T[r];var i="["+process.hrtime().join(".")+"] ";t.debug=function(e){N(i+e)}}var o=new c(t),a=new w(o,e);e.pipe(o).pipe(e),a.on("error",f),o.once("header",(function(t){if(!o._readableState.ended){if(!s(b,"connection"))return o.disconnect(p.BY_APPLICATION);a.removeListener("error",f),b.emit("connection",a,{ip:e.remoteAddress,family:e.remoteFamily,port:e.remotePort,header:t})}}))}function f(e){}})).on("error",(function(e){b.emit("error",e)})).on("listening",(function(){b.emit("listening")})).on("close",(function(){b.emit("close")})),this._connections=0,this.maxConnections=1/0}function w(e,t){o.call(this);var r=this;this._sshstream=e;var i=this._channels={};this._curChan=-1,this._sock=t,this.noMoreSessions=!1,this.authenticated=!1,e.on("end",(function(){t.resume(),r.emit("end")})).on("close",(function(e){r.emit("close",e)})).on("error",(function(e){r.emit("error",e)})).on("drain",(function(){r.emit("drain")})).on("continue",(function(){r.emit("continue")}));var a,f=0,u=!1,c=[];function h(t,n,i,o){if(0===f||a&&(a.username!==t||a.service!==n)||"password"!==i&&"publickey"!==i&&"hostbased"!==i&&"keyboard-interactive"!==i&&"none"!==i||10===c.length)return e.disconnect(p.PROTOCOL_ERROR);if("ssh-connection"!==n)return e.disconnect(p.SERVICE_NOT_AVAILABLE);var u;if(e._state.authMethod=i,"keyboard-interactive"===i?u=new T(e,t,n,i,o,l):"publickey"===i?u=new R(e,t,n,i,o,l):"hostbased"===i?u=new N(e,t,n,i,o,l):"password"===i?u=new I(e,t,n,i,o,l):"none"===i&&(u=new S(e,t,n,i,l)),a){if(!a._initialResponse)return c.push(u);a._multistep&&!this._finalResponse&&(a._cleanup&&a._cleanup(),a.emit("abort"))}a=u,s(r,"authentication")?r.emit("authentication",a):a.reject()}function l(t,n,i,o){a!==t||r.authenticated||(n?(e.removeListener("USERAUTH_REQUEST",h),a=void 0,r.authenticated=!0,e.authSuccess(),c=[],r.emit("ready")):(e.authFailure(i,o),c.length&&(a=c.pop(),s(r,"authentication")?r.emit("authentication",a):a.reject())))}e.on("SERVICE_REQUEST",(function(t){if(0===f||u||r.authenticated||"ssh-userauth"!==t)return e.disconnect(p.SERVICE_NOT_AVAILABLE);u=!0,e.serviceAccept(t)})).on("USERAUTH_REQUEST",h);var E=[];e.on("GLOBAL_REQUEST",(function(t,n,i){var o={type:null,buf:null};function a(t,r){o.type=t,o.buf=r,function(){for(var t;E.length>0&&E[0].type;)"SUCCESS"===(t=E.shift()).type&&e.requestSuccess(t.buf),"FAILURE"===t.type&&e.requestFailure()}()}if(n&&E.push(o),("tcpip-forward"===t||"cancel-tcpip-forward"===t||"no-more-sessions@openssh.com"===t||"streamlocal-forward@openssh.com"===t||"cancel-streamlocal-forward@openssh.com"===t)&&s(r,"request")&&r.authenticated){var f,u;if(n){var c=!1;f=function(e){var r;c||(c=!0,"tcpip-forward"===t&&0===i.bindPort&&"number"==typeof e&&(r=Buffer.allocUnsafe(4),v(r,e,0)),a("SUCCESS",r))},u=function(){c||(c=!0,a("FAILURE"))}}if("no-more-sessions@openssh.com"===t)return r.noMoreSessions=!0,void(f&&f());r.emit("request",f,u,t,i)}else n&&a("FAILURE")})),e.on("CHANNEL_OPEN",(function(t){if("session"===t.type&&r.noMoreSessions||!r.authenticated){var n=d.ADMINISTRATIVELY_PROHIBITED;return e.channelOpenFail(t.sender,n)}var o,a,f=k(r),u=!1;if(!1===f)return e.channelOpenFail(t.sender,d.RESOURCE_SHORTAGE);switch(i[f]=!0,a=function(){if(!u){u=!0,delete i[f];var r=d.ADMINISTRATIVELY_PROHIBITED;return e.channelOpenFail(t.sender,r)}},t.type){case"session":s(r,"session")?(o=function(){if(!u)return u=!0,e.channelOpenConfirm(t.sender,f,g.MAX_WINDOW,g.PACKET_SIZE),new b(r,t,f)},r.emit("session",o,a)):a();break;case"direct-tcpip":s(r,"tcpip")?(o=function(){if(!u){u=!0,e.channelOpenConfirm(t.sender,f,g.MAX_WINDOW,g.PACKET_SIZE);var n={type:void 0,incoming:{id:f,window:g.MAX_WINDOW,packetSize:g.PACKET_SIZE,state:"open"},outgoing:{id:t.sender,window:t.window,packetSize:t.packetSize,state:"open"}};return new g(n,r)}},r.emit("tcpip",o,a,t.data)):a();break;case"direct-streamlocal@openssh.com":s(r,"openssh.streamlocal")?(o=function(){if(!u){u=!0,e.channelOpenConfirm(t.sender,f,g.MAX_WINDOW,g.PACKET_SIZE);var n={type:void 0,incoming:{id:f,window:g.MAX_WINDOW,packetSize:g.PACKET_SIZE,state:"open"},outgoing:{id:t.sender,window:t.window,packetSize:t.packetSize,state:"open"}};return new g(n,r)}},r.emit("openssh.streamlocal",o,a,t.data)):a();break;default:a()}})),e.on("NEWKEYS",(function(){++f>1&&r.emit("rekey")})),n&&this.once("ready",(function(){n.add(e)}))}function b(e,t,r){this.subtype=void 0;var n,i=!1,o=this,a=t.sender,f={type:"session",incoming:{id:r,window:g.MAX_WINDOW,packetSize:g.PACKET_SIZE,state:"open"},outgoing:{id:t.sender,window:t.window,packetSize:t.packetSize,state:"open"}};e._sshstream.on("CHANNEL_REQUEST:"+r,(function(t){var r,u,c=!1;if(t.wantReply&&("shell"!==t.request&&"exec"!==t.request&&"subsystem"!==t.request&&(r=function(){if(!(c||i||n))return c=!0,e._sshstream.channelSuccess(a)}),u=function(){if(!(c||i||n))return c=!0,e._sshstream.channelFailure(a)}),i)u&&u();else switch(t.request){case"env":s(o,"env")?o.emit("env",r,u,{key:t.key,val:t.val}):u&&u();break;case"pty-req":s(o,"pty")?o.emit("pty",r,u,{cols:t.cols,rows:t.rows,width:t.width,height:t.height,term:t.term,modes:t.modes}):u&&u();break;case"window-change":s(o,"window-change")?o.emit("window-change",r,u,{cols:t.cols,rows:t.rows,width:t.width,height:t.height}):u&&u();break;case"x11-req":s(o,"x11")?o.emit("x11",r,u,{single:t.single,protocol:t.protocol,cookie:t.cookie,screen:t.screen}):u&&u();break;case"signal":s(o,"signal")?o.emit("signal",r,u,{name:t.signal}):u&&u();break;case"auth-agent-req@openssh.com":s(o,"auth-agent")?o.emit("auth-agent",r,u):u&&u();break;case"shell":s(o,"shell")?(r=function(){if(!(c||i||n))return c=!0,t.wantReply&&e._sshstream.channelSuccess(a),(n=new g(f,e,{server:!0})).subtype=o.subtype=t.request,n},o.emit("shell",r,u)):u&&u();break;case"exec":s(o,"exec")?(r=function(){if(!(c||i||n))return c=!0,t.wantReply&&e._sshstream.channelSuccess(a),(n=new g(f,e,{server:!0})).subtype=o.subtype=t.request,n},o.emit("exec",r,u,{command:t.command})):u&&u();break;case"subsystem":r=function(){if(!(c||i||n)){if(c=!0,t.wantReply&&e._sshstream.channelSuccess(a),(n=new g(f,e,{server:!0})).subtype=o.subtype=t.request+":"+t.subsystem,"sftp"===t.subsystem){var r=new h({server:!0,debug:e._sshstream.debug});return n.pipe(r).pipe(n),r}return n}},"sftp"===t.subsystem&&s(o,"sftp")?o.emit("sftp",r,u):"sftp"!==t.subsystem&&s(o,"subsystem")?o.emit("subsystem",r,u,{name:t.subsystem}):u&&u();break;default:u&&u()}})).once("CHANNEL_EOF:"+r,(function(){i=!0,o.emit("eof"),o.emit("end")})).once("CHANNEL_CLOSE:"+r,(function(){i=!0,o.emit("close")}))}function S(e,t,r,n,i){o.call(this);var s=this;this.username=this.user=t,this.service=r,this.method=n,this._initialResponse=!1,this._finalResponse=!1,this._multistep=!1,this._cbfinal=function(e,t,r){s._finalResponse||(s._finalResponse=!0,i(s,e,t,r))},this._stream=e}a(_,o),_.prototype.listen=function(){return this._srv.listen.apply(this._srv,arguments),this},_.prototype.address=function(){return this._srv.address()},_.prototype.getConnections=function(e){this._srv.getConnections(e)},_.prototype.close=function(e){return this._srv.close(e),this},_.prototype.ref=function(){this._srv.ref()},_.prototype.unref=function(){this._srv.unref()},a(w,o),w.prototype.end=function(){return this._sshstream.disconnect(p.BY_APPLICATION)},w.prototype.x11=function(e,t,r){return O(this,"x11",{originAddr:e,originPort:t},r)},w.prototype.forwardOut=function(e,t,r,n,i){return O(this,"forwarded-tcpip",{boundAddr:e,boundPort:t,remoteAddr:r,remotePort:n},i)},w.prototype.openssh_forwardOutStreamLocal=function(e,t){return O(this,"forwarded-streamlocal@openssh.com",{socketPath:e},t)},w.prototype.rekey=function(e){var t,r=this._sshstream,n=!0;try{n=r.rekey()}catch(e){t=e}return"function"==typeof e&&(t?process.nextTick((function(){e(t)})):this.once("rekey",e)),n},a(b,o),a(S,o),S.prototype.accept=function(){this._cleanup&&this._cleanup(),this._initialResponse=!0,this._cbfinal(!0)},S.prototype.reject=function(e,t){this._cleanup&&this._cleanup(),this._initialResponse=!0,this._cbfinal(!1,e,t)};var A=/[ \t\r\n]*,[ \t\r\n]*/g;function T(e,t,r,n,i,o){S.call(this,e,t,r,n,o),this._multistep=!0;var s=this;this._cb=void 0,this._onInfoResponse=function(e){if(s._cb){var t=s._cb;s._cb=void 0,t(e)}},this.submethods=i.split(A),this.on("abort",(function(){s._cb&&s._cb(new Error("Authentication request aborted"))}))}function R(e,t,r,n,i,o){var s;if(S.call(this,e,t,r,n,o),this.key={algo:i.keyAlgo,data:i.key},this.signature=i.signature,this.signature)switch(i.keyAlgo){case"ssh-rsa":case"ssh-dss":s="sha1";break;case"ssh-ed25519":s=null;break;case"ecdsa-sha2-nistp256":s="sha256";break;case"ecdsa-sha2-nistp384":s="sha384";break;case"ecdsa-sha2-nistp521":s="sha512"}this.sigAlgo=s,this.blob=i.blob}function N(e,t,r,n,i,o){var s;if(S.call(this,e,t,r,n,o),this.key={algo:i.keyAlgo,data:i.key},this.signature=i.signature,this.signature)switch(i.keyAlgo){case"ssh-rsa":case"ssh-dss":s="sha1";break;case"ssh-ed25519":s=null;break;case"ecdsa-sha2-nistp256":s="sha256";break;case"ecdsa-sha2-nistp384":s="sha384";break;case"ecdsa-sha2-nistp521":s="sha512"}this.sigAlgo=s,this.blob=i.blob,this.localHostname=i.localHostname,this.localUsername=i.localUsername}function I(e,t,r,n,i,o){S.call(this,e,t,r,n,o),this.password=i}function O(e,t,r,n){var i=k(e),o=g.MAX_WINDOW,s=g.PACKET_SIZE,a=!0;if(!1===i)return n(new Error("No free channels available"));"function"==typeof r&&(n=r,r={}),e._channels[i]=!0;var f=e._sshstream;return f.once("CHANNEL_OPEN_CONFIRMATION:"+i,(function(r){f.removeAllListeners("CHANNEL_OPEN_FAILURE:"+i);var a={type:t,incoming:{id:i,window:o,packetSize:s,state:"open"},outgoing:{id:r.sender,window:r.window,packetSize:r.packetSize,state:"open"}};n(void 0,new g(a,e,{server:!0}))})).once("CHANNEL_OPEN_FAILURE:"+i,(function(t){f.removeAllListeners("CHANNEL_OPEN_CONFIRMATION:"+i),delete e._channels[i];var r=new Error("(SSH) Channel open failure: "+t.description);r.reason=t.reason,r.lang=t.lang,n(r)})),"forwarded-tcpip"===t?a=f.forwardedTcpip(i,o,s,r):"x11"===t?a=f.x11(i,o,s,r):"forwarded-streamlocal@openssh.com"===t&&(a=f.openssh_forwardedStreamLocal(i,o,s,r)),a}function k(e){if(e._curChan<y)return++e._curChan;for(var t=0,r=e._channels;t<y;++t)if(!r[t])return t;return!1}a(T,S),T.prototype._cleanup=function(){this._stream.removeListener("USERAUTH_INFO_RESPONSE",this._onInfoResponse)},T.prototype.prompt=function(e,t,r,n){Array.isArray(e)||(e=[e]),"function"==typeof t?(n=t,t=r=void 0):"function"==typeof r&&(n=r,r=void 0);for(var i=0;i<e.length;++i)"string"==typeof e[i]&&(e[i]={prompt:e[i],echo:!0});return this._cb=n,this._initialResponse=!0,this._stream.once("USERAUTH_INFO_RESPONSE",this._onInfoResponse),this._stream.authInfoReq(t,r,e)},a(R,S),R.prototype.accept=function(){this.signature?S.prototype.accept.call(this):(this._initialResponse=!0,this._stream.authPKOK(this.key.algo,this.key.data))},a(N,S),a(I,S),_.createServer=function(e,t){return new _(e,t)},_.KEEPALIVE_INTERVAL=1e3,_.KEEPALIVE_CLIENT_INTERVAL=15e3,_.KEEPALIVE_CLIENT_COUNT_MAX=3,e.exports=_,e.exports.IncomingClient=w},1301:(e,t,r)=>{var n=r(7187).EventEmitter;function i(e,t,r,n,i){for(var o=0;o<i;++o,++t,++n)if(e[t]!==r[n])return!1;return!0}function o(e){"string"==typeof e&&(e=new Buffer(e));var t,r,n=e.length;for(this.maxMatches=1/0,this.matches=0,this._occ=new Array(256),this._lookbehind_size=0,this._needle=e,this._bufpos=0,this._lookbehind=new Buffer(n),r=0;r<256;++r)this._occ[r]=n;if(n>=1)for(t=0;t<n-1;++t)this._occ[e[t]]=n-1-t}(0,r(7926).inherits)(o,n),o.prototype.reset=function(){this._lookbehind_size=0,this.matches=0,this._bufpos=0},o.prototype.push=function(e,t){var r,n;for(Buffer.isBuffer(e)||(e=new Buffer(e,"binary")),n=e.length,this._bufpos=t||0;r!==n&&this.matches<this.maxMatches;)r=this._sbmh_feed(e);return r},o.prototype._sbmh_feed=function(e){var t=e.length,r=this._needle,n=r.length,o=-this._lookbehind_size,s=r[n-1],a=this._occ,f=this._lookbehind;if(o<0){for(;o<0&&o<=t-n;){if((c=this._sbmh_lookup_char(e,o+n-1))===s&&this._sbmh_memcmp(e,o,n-1))return this._lookbehind_size=0,++this.matches,o>-this._lookbehind_size?this.emit("info",!0,f,0,this._lookbehind_size+o):this.emit("info",!0),this._bufpos=o+n,o+n;o+=a[c]}if(o<0)for(;o<0&&!this._sbmh_memcmp(e,o,t-o);)o++;if(!(o>=0)){var u=this._lookbehind_size+o;return u>0&&this.emit("info",!1,f,0,u),f.copy(f,0,u,this._lookbehind_size-u),this._lookbehind_size-=u,e.copy(f,this._lookbehind_size),this._lookbehind_size+=t,this._bufpos=t,t}this.emit("info",!1,f,0,this._lookbehind_size),this._lookbehind_size=0}for(o>=0&&(o+=this._bufpos);o<=t-n;){var c;if((c=e[o+n-1])===s&&e[o]===r[0]&&i(r,0,e,o,n-1))return++this.matches,o>0?this.emit("info",!0,e,this._bufpos,o):this.emit("info",!0),this._bufpos=o+n,o+n;o+=a[c]}if(o<t){for(;o<t&&(e[o]!==r[0]||!i(e,o,r,0,t-o));)++o;o<t&&(e.copy(f,0,o,o+(t-o)),this._lookbehind_size=t-o)}return o>0&&this.emit("info",!1,e,this._bufpos,o<t?o:t),this._bufpos=t,t},o.prototype._sbmh_lookup_char=function(e,t){return t<0?this._lookbehind[this._lookbehind_size+t]:e[t]},o.prototype._sbmh_memcmp=function(e,t,r){for(var n=0;n<r;){if(this._sbmh_lookup_char(e,t+n)!==this._needle[n])return!1;++n}return!0},e.exports=o},3607:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},s=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{f(n.next(e))}catch(e){o(e)}}function a(e){try{f(n.throw(e))}catch(e){o(e)}}function f(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}f((n=n.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const f=o(r(2225)),u=r(7921),c=a(r(3606)),h=r(816),l=a(r(7351)),p=r(3879),d=a(r(3606));function E(e,t,r,n=!0){return s(this,void 0,void 0,(function*(){try{yield e.putFile(t,r),n&&console.log(`✔ Successfully copied file ${t} to remote ${r}.`)}catch(t){console.error("⚠️ An error happened:(.",t.message,t.stack),e.dispose(),f.setFailed(t.message)}}))}process.on("uncaughtException",(e=>{if("ECONNRESET"!==e.code)throw e})),function(){s(this,void 0,void 0,(function*(){const e=f.getInput("host")||"localhost",t=f.getInput("username"),r=+f.getInput("port")||22,n=f.getInput("privateKey"),i=f.getInput("password"),o=f.getInput("passphrase"),a=!!f.getInput("tryKeyboard"),g=!!f.getInput("verbose")||!0,m=!!f.getInput("recursive")||!0,v=+f.getInput("concurrency")||1,y=f.getInput("local"),_=!!f.getInput("dotfiles")||!0,w=f.getInput("remote"),b=!!f.getInput("rmRemote")||!1,S=f.getInput("atomicPut"),A=f.getInput("exclude")||null;if(S){const e=h.SFTPStream.prototype.fastPut;h.SFTPStream.prototype.fastPut=function(t,r,n,i){const o=d.default.posix.parse(r);o.base="."+o.base;const s=d.default.posix.format(o),a=this;e.apply(this,[t,s,n,function(e,t){e?i(e,t):a.ext_openssh_rename(s,r,i)}])}}try{const h=yield function(e="localhost",t,r=22,n,i,o,a){return s(this,void 0,void 0,(function*(){const s=new u.NodeSSH;console.log(`Establishing a SSH connection to ${e}.`);try{const f={host:e,port:r,username:t,password:i,passphrase:o,tryKeyboard:a,onKeyboardInteractive:a?p.keyboardFunction(i):null};n&&(console.log("using provided private key"),f.privateKey=n),yield s.connect(f),console.log(`🤝 Connected to ${e}.`)}catch(t){console.error(`⚠️ The GitHub Action couldn't connect to ${e}.`,t),f.setFailed(t.message)}return s}))}(e,t,r,n,i,o,a);yield function(e,t,r,n=!1,i,o=!0,a=!0,u=!1,h){return s(this,void 0,void 0,(function*(){console.log(`Starting scp Action: ${t} to ${r}`);try{p=t,l.default.existsSync(p)&&l.default.lstatSync(p).isDirectory()?(u&&(yield function(e,t,r=!0){return s(this,void 0,void 0,(function*(){try{yield e.execCommand(`rm -rf ${t}/*`),r&&console.log(`✔ Successfully deleted all files of ${t}.`)}catch(t){console.error("⚠️ An error happened:(.",t.message,t.stack),e.dispose(),f.setFailed(t.message)}}))}(e,r)),yield function(e,t,r,n=!1,i=3,o=!1,a=!0,f){return s(this,void 0,void 0,(function*(){const u=f?new RegExp(function(e){let t=e;return t=t.replace(/\./g,"\\."),t=t.replace(/\*/g,".*"),t="^"+t+"$",console.log(t),t}(f)):null,h=[],l=[],p=yield e.putDirectory(t,r,{recursive:a,concurrency:i,validate:e=>(!c.default.basename(e).startsWith(".")||n)&&(!f||!e.replace(new RegExp(t+"/?"),"").match(u)),tick:function(e,t,r){r?(o&&console.log(`❕copy failed for ${e}.`),h.push({local:e,remote:t})):(o&&console.log(`✔ successfully copied ${e}.`),l.push({local:e,remote:t}))}});console.log(`The copy of directory ${t} was ${p?"successful":"unsuccessful"}.`),h.length>0&&(console.log("failed transfers",h.join(", ")),yield function(e,t){return s(this,void 0,void 0,(function*(){for(const r of e)yield t(r)}))}(h,(t=>s(this,void 0,void 0,(function*(){console.log(`Retrying to copy ${t.local} to ${t.remote}.`),yield E(e,t.local,t.remote,!0)})))))}))}(e,t,r,n,i,o,a,h)):yield E(e,t,r,o),e.dispose(),console.log("✅ scp Action finished.")}catch(t){console.error("⚠️ An error happened:(.",t.message,t.stack),e.dispose(),process.abort(),f.setFailed(t.message)}var p}))}(h,y,w,_,v,g,m,b,A),h.dispose()}catch(e){f.setFailed(e)}}))}()},3879:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.keyboardFunction=void 0,t.keyboardFunction=e=>(t,r,n,i,o)=>{i.length>0&&i[0].prompt.toLowerCase().includes("password")&&o([e])}},780:(e,t,r)=>{!function(e){"use strict";var t=function(e){var t,r=new Float64Array(16);if(e)for(t=0;t<e.length;t++)r[t]=e[t];return r},n=function(){throw new Error("no PRNG")},i=new Uint8Array(16),o=new Uint8Array(32);o[0]=9;var s=t(),a=t([1]),f=t([56129,1]),u=t([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),c=t([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),h=t([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),l=t([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),p=t([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function d(e,t,r,n){e[t]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r,e[t+4]=n>>24&255,e[t+5]=n>>16&255,e[t+6]=n>>8&255,e[t+7]=255&n}function E(e,t,r,n,i){var o,s=0;for(o=0;o<i;o++)s|=e[t+o]^r[n+o];return(1&s-1>>>8)-1}function g(e,t,r,n){return E(e,t,r,n,16)}function m(e,t,r,n){return E(e,t,r,n,32)}function v(e,t,r,n){!function(e,t,r,n){for(var i,o=255&n[0]|(255&n[1])<<8|(255&n[2])<<16|(255&n[3])<<24,s=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,a=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,f=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,u=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,c=255&n[4]|(255&n[5])<<8|(255&n[6])<<16|(255&n[7])<<24,h=255&t[0]|(255&t[1])<<8|(255&t[2])<<16|(255&t[3])<<24,l=255&t[4]|(255&t[5])<<8|(255&t[6])<<16|(255&t[7])<<24,p=255&t[8]|(255&t[9])<<8|(255&t[10])<<16|(255&t[11])<<24,d=255&t[12]|(255&t[13])<<8|(255&t[14])<<16|(255&t[15])<<24,E=255&n[8]|(255&n[9])<<8|(255&n[10])<<16|(255&n[11])<<24,g=255&r[16]|(255&r[17])<<8|(255&r[18])<<16|(255&r[19])<<24,m=255&r[20]|(255&r[21])<<8|(255&r[22])<<16|(255&r[23])<<24,v=255&r[24]|(255&r[25])<<8|(255&r[26])<<16|(255&r[27])<<24,y=255&r[28]|(255&r[29])<<8|(255&r[30])<<16|(255&r[31])<<24,_=255&n[12]|(255&n[13])<<8|(255&n[14])<<16|(255&n[15])<<24,w=o,b=s,S=a,A=f,T=u,R=c,N=h,I=l,O=p,k=d,U=E,B=g,L=m,C=v,P=y,D=_,H=0;H<20;H+=2)w^=(i=(L^=(i=(O^=(i=(T^=(i=w+L|0)<<7|i>>>25)+w|0)<<9|i>>>23)+T|0)<<13|i>>>19)+O|0)<<18|i>>>14,R^=(i=(b^=(i=(C^=(i=(k^=(i=R+b|0)<<7|i>>>25)+R|0)<<9|i>>>23)+k|0)<<13|i>>>19)+C|0)<<18|i>>>14,U^=(i=(N^=(i=(S^=(i=(P^=(i=U+N|0)<<7|i>>>25)+U|0)<<9|i>>>23)+P|0)<<13|i>>>19)+S|0)<<18|i>>>14,D^=(i=(B^=(i=(I^=(i=(A^=(i=D+B|0)<<7|i>>>25)+D|0)<<9|i>>>23)+A|0)<<13|i>>>19)+I|0)<<18|i>>>14,w^=(i=(A^=(i=(S^=(i=(b^=(i=w+A|0)<<7|i>>>25)+w|0)<<9|i>>>23)+b|0)<<13|i>>>19)+S|0)<<18|i>>>14,R^=(i=(T^=(i=(I^=(i=(N^=(i=R+T|0)<<7|i>>>25)+R|0)<<9|i>>>23)+N|0)<<13|i>>>19)+I|0)<<18|i>>>14,U^=(i=(k^=(i=(O^=(i=(B^=(i=U+k|0)<<7|i>>>25)+U|0)<<9|i>>>23)+B|0)<<13|i>>>19)+O|0)<<18|i>>>14,D^=(i=(P^=(i=(C^=(i=(L^=(i=D+P|0)<<7|i>>>25)+D|0)<<9|i>>>23)+L|0)<<13|i>>>19)+C|0)<<18|i>>>14;w=w+o|0,b=b+s|0,S=S+a|0,A=A+f|0,T=T+u|0,R=R+c|0,N=N+h|0,I=I+l|0,O=O+p|0,k=k+d|0,U=U+E|0,B=B+g|0,L=L+m|0,C=C+v|0,P=P+y|0,D=D+_|0,e[0]=w>>>0&255,e[1]=w>>>8&255,e[2]=w>>>16&255,e[3]=w>>>24&255,e[4]=b>>>0&255,e[5]=b>>>8&255,e[6]=b>>>16&255,e[7]=b>>>24&255,e[8]=S>>>0&255,e[9]=S>>>8&255,e[10]=S>>>16&255,e[11]=S>>>24&255,e[12]=A>>>0&255,e[13]=A>>>8&255,e[14]=A>>>16&255,e[15]=A>>>24&255,e[16]=T>>>0&255,e[17]=T>>>8&255,e[18]=T>>>16&255,e[19]=T>>>24&255,e[20]=R>>>0&255,e[21]=R>>>8&255,e[22]=R>>>16&255,e[23]=R>>>24&255,e[24]=N>>>0&255,e[25]=N>>>8&255,e[26]=N>>>16&255,e[27]=N>>>24&255,e[28]=I>>>0&255,e[29]=I>>>8&255,e[30]=I>>>16&255,e[31]=I>>>24&255,e[32]=O>>>0&255,e[33]=O>>>8&255,e[34]=O>>>16&255,e[35]=O>>>24&255,e[36]=k>>>0&255,e[37]=k>>>8&255,e[38]=k>>>16&255,e[39]=k>>>24&255,e[40]=U>>>0&255,e[41]=U>>>8&255,e[42]=U>>>16&255,e[43]=U>>>24&255,e[44]=B>>>0&255,e[45]=B>>>8&255,e[46]=B>>>16&255,e[47]=B>>>24&255,e[48]=L>>>0&255,e[49]=L>>>8&255,e[50]=L>>>16&255,e[51]=L>>>24&255,e[52]=C>>>0&255,e[53]=C>>>8&255,e[54]=C>>>16&255,e[55]=C>>>24&255,e[56]=P>>>0&255,e[57]=P>>>8&255,e[58]=P>>>16&255,e[59]=P>>>24&255,e[60]=D>>>0&255,e[61]=D>>>8&255,e[62]=D>>>16&255,e[63]=D>>>24&255}(e,t,r,n)}function y(e,t,r,n){!function(e,t,r,n){for(var i,o=255&n[0]|(255&n[1])<<8|(255&n[2])<<16|(255&n[3])<<24,s=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,a=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,f=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,u=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,c=255&n[4]|(255&n[5])<<8|(255&n[6])<<16|(255&n[7])<<24,h=255&t[0]|(255&t[1])<<8|(255&t[2])<<16|(255&t[3])<<24,l=255&t[4]|(255&t[5])<<8|(255&t[6])<<16|(255&t[7])<<24,p=255&t[8]|(255&t[9])<<8|(255&t[10])<<16|(255&t[11])<<24,d=255&t[12]|(255&t[13])<<8|(255&t[14])<<16|(255&t[15])<<24,E=255&n[8]|(255&n[9])<<8|(255&n[10])<<16|(255&n[11])<<24,g=255&r[16]|(255&r[17])<<8|(255&r[18])<<16|(255&r[19])<<24,m=255&r[20]|(255&r[21])<<8|(255&r[22])<<16|(255&r[23])<<24,v=255&r[24]|(255&r[25])<<8|(255&r[26])<<16|(255&r[27])<<24,y=255&r[28]|(255&r[29])<<8|(255&r[30])<<16|(255&r[31])<<24,_=255&n[12]|(255&n[13])<<8|(255&n[14])<<16|(255&n[15])<<24,w=0;w<20;w+=2)o^=(i=(m^=(i=(p^=(i=(u^=(i=o+m|0)<<7|i>>>25)+o|0)<<9|i>>>23)+u|0)<<13|i>>>19)+p|0)<<18|i>>>14,c^=(i=(s^=(i=(v^=(i=(d^=(i=c+s|0)<<7|i>>>25)+c|0)<<9|i>>>23)+d|0)<<13|i>>>19)+v|0)<<18|i>>>14,E^=(i=(h^=(i=(a^=(i=(y^=(i=E+h|0)<<7|i>>>25)+E|0)<<9|i>>>23)+y|0)<<13|i>>>19)+a|0)<<18|i>>>14,_^=(i=(g^=(i=(l^=(i=(f^=(i=_+g|0)<<7|i>>>25)+_|0)<<9|i>>>23)+f|0)<<13|i>>>19)+l|0)<<18|i>>>14,o^=(i=(f^=(i=(a^=(i=(s^=(i=o+f|0)<<7|i>>>25)+o|0)<<9|i>>>23)+s|0)<<13|i>>>19)+a|0)<<18|i>>>14,c^=(i=(u^=(i=(l^=(i=(h^=(i=c+u|0)<<7|i>>>25)+c|0)<<9|i>>>23)+h|0)<<13|i>>>19)+l|0)<<18|i>>>14,E^=(i=(d^=(i=(p^=(i=(g^=(i=E+d|0)<<7|i>>>25)+E|0)<<9|i>>>23)+g|0)<<13|i>>>19)+p|0)<<18|i>>>14,_^=(i=(y^=(i=(v^=(i=(m^=(i=_+y|0)<<7|i>>>25)+_|0)<<9|i>>>23)+m|0)<<13|i>>>19)+v|0)<<18|i>>>14;e[0]=o>>>0&255,e[1]=o>>>8&255,e[2]=o>>>16&255,e[3]=o>>>24&255,e[4]=c>>>0&255,e[5]=c>>>8&255,e[6]=c>>>16&255,e[7]=c>>>24&255,e[8]=E>>>0&255,e[9]=E>>>8&255,e[10]=E>>>16&255,e[11]=E>>>24&255,e[12]=_>>>0&255,e[13]=_>>>8&255,e[14]=_>>>16&255,e[15]=_>>>24&255,e[16]=h>>>0&255,e[17]=h>>>8&255,e[18]=h>>>16&255,e[19]=h>>>24&255,e[20]=l>>>0&255,e[21]=l>>>8&255,e[22]=l>>>16&255,e[23]=l>>>24&255,e[24]=p>>>0&255,e[25]=p>>>8&255,e[26]=p>>>16&255,e[27]=p>>>24&255,e[28]=d>>>0&255,e[29]=d>>>8&255,e[30]=d>>>16&255,e[31]=d>>>24&255}(e,t,r,n)}var _=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function w(e,t,r,n,i,o,s){var a,f,u=new Uint8Array(16),c=new Uint8Array(64);for(f=0;f<16;f++)u[f]=0;for(f=0;f<8;f++)u[f]=o[f];for(;i>=64;){for(v(c,u,s,_),f=0;f<64;f++)e[t+f]=r[n+f]^c[f];for(a=1,f=8;f<16;f++)a=a+(255&u[f])|0,u[f]=255&a,a>>>=8;i-=64,t+=64,n+=64}if(i>0)for(v(c,u,s,_),f=0;f<i;f++)e[t+f]=r[n+f]^c[f];return 0}function b(e,t,r,n,i){var o,s,a=new Uint8Array(16),f=new Uint8Array(64);for(s=0;s<16;s++)a[s]=0;for(s=0;s<8;s++)a[s]=n[s];for(;r>=64;){for(v(f,a,i,_),s=0;s<64;s++)e[t+s]=f[s];for(o=1,s=8;s<16;s++)o=o+(255&a[s])|0,a[s]=255&o,o>>>=8;r-=64,t+=64}if(r>0)for(v(f,a,i,_),s=0;s<r;s++)e[t+s]=f[s];return 0}function S(e,t,r,n,i){var o=new Uint8Array(32);y(o,n,i,_);for(var s=new Uint8Array(8),a=0;a<8;a++)s[a]=n[a+16];return b(e,t,r,s,o)}function A(e,t,r,n,i,o,s){var a=new Uint8Array(32);y(a,o,s,_);for(var f=new Uint8Array(8),u=0;u<8;u++)f[u]=o[u+16];return w(e,t,r,n,i,f,a)}var T=function(e){var t,r,n,i,o,s,a,f;this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0,t=255&e[0]|(255&e[1])<<8,this.r[0]=8191&t,r=255&e[2]|(255&e[3])<<8,this.r[1]=8191&(t>>>13|r<<3),n=255&e[4]|(255&e[5])<<8,this.r[2]=7939&(r>>>10|n<<6),i=255&e[6]|(255&e[7])<<8,this.r[3]=8191&(n>>>7|i<<9),o=255&e[8]|(255&e[9])<<8,this.r[4]=255&(i>>>4|o<<12),this.r[5]=o>>>1&8190,s=255&e[10]|(255&e[11])<<8,this.r[6]=8191&(o>>>14|s<<2),a=255&e[12]|(255&e[13])<<8,this.r[7]=8065&(s>>>11|a<<5),f=255&e[14]|(255&e[15])<<8,this.r[8]=8191&(a>>>8|f<<8),this.r[9]=f>>>5&127,this.pad[0]=255&e[16]|(255&e[17])<<8,this.pad[1]=255&e[18]|(255&e[19])<<8,this.pad[2]=255&e[20]|(255&e[21])<<8,this.pad[3]=255&e[22]|(255&e[23])<<8,this.pad[4]=255&e[24]|(255&e[25])<<8,this.pad[5]=255&e[26]|(255&e[27])<<8,this.pad[6]=255&e[28]|(255&e[29])<<8,this.pad[7]=255&e[30]|(255&e[31])<<8};function R(e,t,r,n,i,o){var s=new T(o);return s.update(r,n,i),s.finish(e,t),0}function N(e,t,r,n,i,o){var s=new Uint8Array(16);return R(s,0,r,n,i,o),g(e,t,s,0)}function I(e,t,r,n,i){var o;if(r<32)return-1;for(A(e,0,t,0,r,n,i),R(e,16,e,32,r-32,e),o=0;o<16;o++)e[o]=0;return 0}function O(e,t,r,n,i){var o,s=new Uint8Array(32);if(r<32)return-1;if(S(s,0,32,n,i),0!==N(t,16,t,32,r-32,s))return-1;for(A(e,0,t,0,r,n,i),o=0;o<32;o++)e[o]=0;return 0}function k(e,t){var r;for(r=0;r<16;r++)e[r]=0|t[r]}function U(e){var t,r,n=1;for(t=0;t<16;t++)r=e[t]+n+65535,n=Math.floor(r/65536),e[t]=r-65536*n;e[0]+=n-1+37*(n-1)}function B(e,t,r){for(var n,i=~(r-1),o=0;o<16;o++)n=i&(e[o]^t[o]),e[o]^=n,t[o]^=n}function L(e,r){var n,i,o,s=t(),a=t();for(n=0;n<16;n++)a[n]=r[n];for(U(a),U(a),U(a),i=0;i<2;i++){for(s[0]=a[0]-65517,n=1;n<15;n++)s[n]=a[n]-65535-(s[n-1]>>16&1),s[n-1]&=65535;s[15]=a[15]-32767-(s[14]>>16&1),o=s[15]>>16&1,s[14]&=65535,B(a,s,1-o)}for(n=0;n<16;n++)e[2*n]=255&a[n],e[2*n+1]=a[n]>>8}function C(e,t){var r=new Uint8Array(32),n=new Uint8Array(32);return L(r,e),L(n,t),m(r,0,n,0)}function P(e){var t=new Uint8Array(32);return L(t,e),1&t[0]}function D(e,t){var r;for(r=0;r<16;r++)e[r]=t[2*r]+(t[2*r+1]<<8);e[15]&=32767}function H(e,t,r){for(var n=0;n<16;n++)e[n]=t[n]+r[n]}function x(e,t,r){for(var n=0;n<16;n++)e[n]=t[n]-r[n]}function M(e,t,r){var n,i,o=0,s=0,a=0,f=0,u=0,c=0,h=0,l=0,p=0,d=0,E=0,g=0,m=0,v=0,y=0,_=0,w=0,b=0,S=0,A=0,T=0,R=0,N=0,I=0,O=0,k=0,U=0,B=0,L=0,C=0,P=0,D=r[0],H=r[1],x=r[2],M=r[3],K=r[4],F=r[5],G=r[6],q=r[7],X=r[8],W=r[9],j=r[10],V=r[11],Y=r[12],Q=r[13],z=r[14],$=r[15];o+=(n=t[0])*D,s+=n*H,a+=n*x,f+=n*M,u+=n*K,c+=n*F,h+=n*G,l+=n*q,p+=n*X,d+=n*W,E+=n*j,g+=n*V,m+=n*Y,v+=n*Q,y+=n*z,_+=n*$,s+=(n=t[1])*D,a+=n*H,f+=n*x,u+=n*M,c+=n*K,h+=n*F,l+=n*G,p+=n*q,d+=n*X,E+=n*W,g+=n*j,m+=n*V,v+=n*Y,y+=n*Q,_+=n*z,w+=n*$,a+=(n=t[2])*D,f+=n*H,u+=n*x,c+=n*M,h+=n*K,l+=n*F,p+=n*G,d+=n*q,E+=n*X,g+=n*W,m+=n*j,v+=n*V,y+=n*Y,_+=n*Q,w+=n*z,b+=n*$,f+=(n=t[3])*D,u+=n*H,c+=n*x,h+=n*M,l+=n*K,p+=n*F,d+=n*G,E+=n*q,g+=n*X,m+=n*W,v+=n*j,y+=n*V,_+=n*Y,w+=n*Q,b+=n*z,S+=n*$,u+=(n=t[4])*D,c+=n*H,h+=n*x,l+=n*M,p+=n*K,d+=n*F,E+=n*G,g+=n*q,m+=n*X,v+=n*W,y+=n*j,_+=n*V,w+=n*Y,b+=n*Q,S+=n*z,A+=n*$,c+=(n=t[5])*D,h+=n*H,l+=n*x,p+=n*M,d+=n*K,E+=n*F,g+=n*G,m+=n*q,v+=n*X,y+=n*W,_+=n*j,w+=n*V,b+=n*Y,S+=n*Q,A+=n*z,T+=n*$,h+=(n=t[6])*D,l+=n*H,p+=n*x,d+=n*M,E+=n*K,g+=n*F,m+=n*G,v+=n*q,y+=n*X,_+=n*W,w+=n*j,b+=n*V,S+=n*Y,A+=n*Q,T+=n*z,R+=n*$,l+=(n=t[7])*D,p+=n*H,d+=n*x,E+=n*M,g+=n*K,m+=n*F,v+=n*G,y+=n*q,_+=n*X,w+=n*W,b+=n*j,S+=n*V,A+=n*Y,T+=n*Q,R+=n*z,N+=n*$,p+=(n=t[8])*D,d+=n*H,E+=n*x,g+=n*M,m+=n*K,v+=n*F,y+=n*G,_+=n*q,w+=n*X,b+=n*W,S+=n*j,A+=n*V,T+=n*Y,R+=n*Q,N+=n*z,I+=n*$,d+=(n=t[9])*D,E+=n*H,g+=n*x,m+=n*M,v+=n*K,y+=n*F,_+=n*G,w+=n*q,b+=n*X,S+=n*W,A+=n*j,T+=n*V,R+=n*Y,N+=n*Q,I+=n*z,O+=n*$,E+=(n=t[10])*D,g+=n*H,m+=n*x,v+=n*M,y+=n*K,_+=n*F,w+=n*G,b+=n*q,S+=n*X,A+=n*W,T+=n*j,R+=n*V,N+=n*Y,I+=n*Q,O+=n*z,k+=n*$,g+=(n=t[11])*D,m+=n*H,v+=n*x,y+=n*M,_+=n*K,w+=n*F,b+=n*G,S+=n*q,A+=n*X,T+=n*W,R+=n*j,N+=n*V,I+=n*Y,O+=n*Q,k+=n*z,U+=n*$,m+=(n=t[12])*D,v+=n*H,y+=n*x,_+=n*M,w+=n*K,b+=n*F,S+=n*G,A+=n*q,T+=n*X,R+=n*W,N+=n*j,I+=n*V,O+=n*Y,k+=n*Q,U+=n*z,B+=n*$,v+=(n=t[13])*D,y+=n*H,_+=n*x,w+=n*M,b+=n*K,S+=n*F,A+=n*G,T+=n*q,R+=n*X,N+=n*W,I+=n*j,O+=n*V,k+=n*Y,U+=n*Q,B+=n*z,L+=n*$,y+=(n=t[14])*D,_+=n*H,w+=n*x,b+=n*M,S+=n*K,A+=n*F,T+=n*G,R+=n*q,N+=n*X,I+=n*W,O+=n*j,k+=n*V,U+=n*Y,B+=n*Q,L+=n*z,C+=n*$,_+=(n=t[15])*D,s+=38*(b+=n*x),a+=38*(S+=n*M),f+=38*(A+=n*K),u+=38*(T+=n*F),c+=38*(R+=n*G),h+=38*(N+=n*q),l+=38*(I+=n*X),p+=38*(O+=n*W),d+=38*(k+=n*j),E+=38*(U+=n*V),g+=38*(B+=n*Y),m+=38*(L+=n*Q),v+=38*(C+=n*z),y+=38*(P+=n*$),o=(n=(o+=38*(w+=n*H))+(i=1)+65535)-65536*(i=Math.floor(n/65536)),s=(n=s+i+65535)-65536*(i=Math.floor(n/65536)),a=(n=a+i+65535)-65536*(i=Math.floor(n/65536)),f=(n=f+i+65535)-65536*(i=Math.floor(n/65536)),u=(n=u+i+65535)-65536*(i=Math.floor(n/65536)),c=(n=c+i+65535)-65536*(i=Math.floor(n/65536)),h=(n=h+i+65535)-65536*(i=Math.floor(n/65536)),l=(n=l+i+65535)-65536*(i=Math.floor(n/65536)),p=(n=p+i+65535)-65536*(i=Math.floor(n/65536)),d=(n=d+i+65535)-65536*(i=Math.floor(n/65536)),E=(n=E+i+65535)-65536*(i=Math.floor(n/65536)),g=(n=g+i+65535)-65536*(i=Math.floor(n/65536)),m=(n=m+i+65535)-65536*(i=Math.floor(n/65536)),v=(n=v+i+65535)-65536*(i=Math.floor(n/65536)),y=(n=y+i+65535)-65536*(i=Math.floor(n/65536)),_=(n=_+i+65535)-65536*(i=Math.floor(n/65536)),o=(n=(o+=i-1+37*(i-1))+(i=1)+65535)-65536*(i=Math.floor(n/65536)),s=(n=s+i+65535)-65536*(i=Math.floor(n/65536)),a=(n=a+i+65535)-65536*(i=Math.floor(n/65536)),f=(n=f+i+65535)-65536*(i=Math.floor(n/65536)),u=(n=u+i+65535)-65536*(i=Math.floor(n/65536)),c=(n=c+i+65535)-65536*(i=Math.floor(n/65536)),h=(n=h+i+65535)-65536*(i=Math.floor(n/65536)),l=(n=l+i+65535)-65536*(i=Math.floor(n/65536)),p=(n=p+i+65535)-65536*(i=Math.floor(n/65536)),d=(n=d+i+65535)-65536*(i=Math.floor(n/65536)),E=(n=E+i+65535)-65536*(i=Math.floor(n/65536)),g=(n=g+i+65535)-65536*(i=Math.floor(n/65536)),m=(n=m+i+65535)-65536*(i=Math.floor(n/65536)),v=(n=v+i+65535)-65536*(i=Math.floor(n/65536)),y=(n=y+i+65535)-65536*(i=Math.floor(n/65536)),_=(n=_+i+65535)-65536*(i=Math.floor(n/65536)),o+=i-1+37*(i-1),e[0]=o,e[1]=s,e[2]=a,e[3]=f,e[4]=u,e[5]=c,e[6]=h,e[7]=l,e[8]=p,e[9]=d,e[10]=E,e[11]=g,e[12]=m,e[13]=v,e[14]=y,e[15]=_}function K(e,t){M(e,t,t)}function F(e,r){var n,i=t();for(n=0;n<16;n++)i[n]=r[n];for(n=253;n>=0;n--)K(i,i),2!==n&&4!==n&&M(i,i,r);for(n=0;n<16;n++)e[n]=i[n]}function G(e,r,n){var i,o,s=new Uint8Array(32),a=new Float64Array(80),u=t(),c=t(),h=t(),l=t(),p=t(),d=t();for(o=0;o<31;o++)s[o]=r[o];for(s[31]=127&r[31]|64,s[0]&=248,D(a,n),o=0;o<16;o++)c[o]=a[o],l[o]=u[o]=h[o]=0;for(u[0]=l[0]=1,o=254;o>=0;--o)B(u,c,i=s[o>>>3]>>>(7&o)&1),B(h,l,i),H(p,u,h),x(u,u,h),H(h,c,l),x(c,c,l),K(l,p),K(d,u),M(u,h,u),M(h,c,p),H(p,u,h),x(u,u,h),K(c,u),x(h,l,d),M(u,h,f),H(u,u,l),M(h,h,u),M(u,l,d),M(l,c,a),K(c,p),B(u,c,i),B(h,l,i);for(o=0;o<16;o++)a[o+16]=u[o],a[o+32]=h[o],a[o+48]=c[o],a[o+64]=l[o];var E=a.subarray(32),g=a.subarray(16);return F(E,E),M(g,g,E),L(e,g),0}function q(e,t){return G(e,t,o)}function X(e,t){return n(t,32),q(e,t)}function W(e,t,r){var n=new Uint8Array(32);return G(n,r,t),y(e,i,n,_)}T.prototype.blocks=function(e,t,r){for(var n,i,o,s,a,f,u,c,h,l,p,d,E,g,m,v,y,_,w,b=this.fin?0:2048,S=this.h[0],A=this.h[1],T=this.h[2],R=this.h[3],N=this.h[4],I=this.h[5],O=this.h[6],k=this.h[7],U=this.h[8],B=this.h[9],L=this.r[0],C=this.r[1],P=this.r[2],D=this.r[3],H=this.r[4],x=this.r[5],M=this.r[6],K=this.r[7],F=this.r[8],G=this.r[9];r>=16;)l=h=0,l+=(S+=8191&(n=255&e[t+0]|(255&e[t+1])<<8))*L,l+=(A+=8191&(n>>>13|(i=255&e[t+2]|(255&e[t+3])<<8)<<3))*(5*G),l+=(T+=8191&(i>>>10|(o=255&e[t+4]|(255&e[t+5])<<8)<<6))*(5*F),l+=(R+=8191&(o>>>7|(s=255&e[t+6]|(255&e[t+7])<<8)<<9))*(5*K),h=(l+=(N+=8191&(s>>>4|(a=255&e[t+8]|(255&e[t+9])<<8)<<12))*(5*M))>>>13,l&=8191,l+=(I+=a>>>1&8191)*(5*x),l+=(O+=8191&(a>>>14|(f=255&e[t+10]|(255&e[t+11])<<8)<<2))*(5*H),l+=(k+=8191&(f>>>11|(u=255&e[t+12]|(255&e[t+13])<<8)<<5))*(5*D),l+=(U+=8191&(u>>>8|(c=255&e[t+14]|(255&e[t+15])<<8)<<8))*(5*P),p=h+=(l+=(B+=c>>>5|b)*(5*C))>>>13,p+=S*C,p+=A*L,p+=T*(5*G),p+=R*(5*F),h=(p+=N*(5*K))>>>13,p&=8191,p+=I*(5*M),p+=O*(5*x),p+=k*(5*H),p+=U*(5*D),h+=(p+=B*(5*P))>>>13,p&=8191,d=h,d+=S*P,d+=A*C,d+=T*L,d+=R*(5*G),h=(d+=N*(5*F))>>>13,d&=8191,d+=I*(5*K),d+=O*(5*M),d+=k*(5*x),d+=U*(5*H),E=h+=(d+=B*(5*D))>>>13,E+=S*D,E+=A*P,E+=T*C,E+=R*L,h=(E+=N*(5*G))>>>13,E&=8191,E+=I*(5*F),E+=O*(5*K),E+=k*(5*M),E+=U*(5*x),g=h+=(E+=B*(5*H))>>>13,g+=S*H,g+=A*D,g+=T*P,g+=R*C,h=(g+=N*L)>>>13,g&=8191,g+=I*(5*G),g+=O*(5*F),g+=k*(5*K),g+=U*(5*M),m=h+=(g+=B*(5*x))>>>13,m+=S*x,m+=A*H,m+=T*D,m+=R*P,h=(m+=N*C)>>>13,m&=8191,m+=I*L,m+=O*(5*G),m+=k*(5*F),m+=U*(5*K),v=h+=(m+=B*(5*M))>>>13,v+=S*M,v+=A*x,v+=T*H,v+=R*D,h=(v+=N*P)>>>13,v&=8191,v+=I*C,v+=O*L,v+=k*(5*G),v+=U*(5*F),y=h+=(v+=B*(5*K))>>>13,y+=S*K,y+=A*M,y+=T*x,y+=R*H,h=(y+=N*D)>>>13,y&=8191,y+=I*P,y+=O*C,y+=k*L,y+=U*(5*G),_=h+=(y+=B*(5*F))>>>13,_+=S*F,_+=A*K,_+=T*M,_+=R*x,h=(_+=N*H)>>>13,_&=8191,_+=I*D,_+=O*P,_+=k*C,_+=U*L,w=h+=(_+=B*(5*G))>>>13,w+=S*G,w+=A*F,w+=T*K,w+=R*M,h=(w+=N*x)>>>13,w&=8191,w+=I*H,w+=O*D,w+=k*P,w+=U*C,S=l=8191&(h=(h=((h+=(w+=B*L)>>>13)<<2)+h|0)+(l&=8191)|0),A=p+=h>>>=13,T=d&=8191,R=E&=8191,N=g&=8191,I=m&=8191,O=v&=8191,k=y&=8191,U=_&=8191,B=w&=8191,t+=16,r-=16;this.h[0]=S,this.h[1]=A,this.h[2]=T,this.h[3]=R,this.h[4]=N,this.h[5]=I,this.h[6]=O,this.h[7]=k,this.h[8]=U,this.h[9]=B},T.prototype.finish=function(e,t){var r,n,i,o,s=new Uint16Array(10);if(this.leftover){for(o=this.leftover,this.buffer[o++]=1;o<16;o++)this.buffer[o]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(r=this.h[1]>>>13,this.h[1]&=8191,o=2;o<10;o++)this.h[o]+=r,r=this.h[o]>>>13,this.h[o]&=8191;for(this.h[0]+=5*r,r=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=r,r=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=r,s[0]=this.h[0]+5,r=s[0]>>>13,s[0]&=8191,o=1;o<10;o++)s[o]=this.h[o]+r,r=s[o]>>>13,s[o]&=8191;for(s[9]-=8192,n=(1^r)-1,o=0;o<10;o++)s[o]&=n;for(n=~n,o=0;o<10;o++)this.h[o]=this.h[o]&n|s[o];for(this.h[0]=65535&(this.h[0]|this.h[1]<<13),this.h[1]=65535&(this.h[1]>>>3|this.h[2]<<10),this.h[2]=65535&(this.h[2]>>>6|this.h[3]<<7),this.h[3]=65535&(this.h[3]>>>9|this.h[4]<<4),this.h[4]=65535&(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14),this.h[5]=65535&(this.h[6]>>>2|this.h[7]<<11),this.h[6]=65535&(this.h[7]>>>5|this.h[8]<<8),this.h[7]=65535&(this.h[8]>>>8|this.h[9]<<5),i=this.h[0]+this.pad[0],this.h[0]=65535&i,o=1;o<8;o++)i=(this.h[o]+this.pad[o]|0)+(i>>>16)|0,this.h[o]=65535&i;e[t+0]=this.h[0]>>>0&255,e[t+1]=this.h[0]>>>8&255,e[t+2]=this.h[1]>>>0&255,e[t+3]=this.h[1]>>>8&255,e[t+4]=this.h[2]>>>0&255,e[t+5]=this.h[2]>>>8&255,e[t+6]=this.h[3]>>>0&255,e[t+7]=this.h[3]>>>8&255,e[t+8]=this.h[4]>>>0&255,e[t+9]=this.h[4]>>>8&255,e[t+10]=this.h[5]>>>0&255,e[t+11]=this.h[5]>>>8&255,e[t+12]=this.h[6]>>>0&255,e[t+13]=this.h[6]>>>8&255,e[t+14]=this.h[7]>>>0&255,e[t+15]=this.h[7]>>>8&255},T.prototype.update=function(e,t,r){var n,i;if(this.leftover){for((i=16-this.leftover)>r&&(i=r),n=0;n<i;n++)this.buffer[this.leftover+n]=e[t+n];if(r-=i,t+=i,this.leftover+=i,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(r>=16&&(i=r-r%16,this.blocks(e,t,i),t+=i,r-=i),r){for(n=0;n<r;n++)this.buffer[this.leftover+n]=e[t+n];this.leftover+=r}};var j=I,V=O,Y=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function Q(e,t,r,n){for(var i,o,s,a,f,u,c,h,l,p,d,E,g,m,v,y,_,w,b,S,A,T,R,N,I,O,k=new Int32Array(16),U=new Int32Array(16),B=e[0],L=e[1],C=e[2],P=e[3],D=e[4],H=e[5],x=e[6],M=e[7],K=t[0],F=t[1],G=t[2],q=t[3],X=t[4],W=t[5],j=t[6],V=t[7],Q=0;n>=128;){for(b=0;b<16;b++)S=8*b+Q,k[b]=r[S+0]<<24|r[S+1]<<16|r[S+2]<<8|r[S+3],U[b]=r[S+4]<<24|r[S+5]<<16|r[S+6]<<8|r[S+7];for(b=0;b<80;b++)if(i=B,o=L,s=C,a=P,f=D,u=H,c=x,l=K,p=F,d=G,E=q,g=X,m=W,v=j,R=65535&(T=V),N=T>>>16,I=65535&(A=M),O=A>>>16,R+=65535&(T=(X>>>14|D<<18)^(X>>>18|D<<14)^(D>>>9|X<<23)),N+=T>>>16,I+=65535&(A=(D>>>14|X<<18)^(D>>>18|X<<14)^(X>>>9|D<<23)),O+=A>>>16,R+=65535&(T=X&W^~X&j),N+=T>>>16,I+=65535&(A=D&H^~D&x),O+=A>>>16,R+=65535&(T=Y[2*b+1]),N+=T>>>16,I+=65535&(A=Y[2*b]),O+=A>>>16,A=k[b%16],N+=(T=U[b%16])>>>16,I+=65535&A,O+=A>>>16,I+=(N+=(R+=65535&T)>>>16)>>>16,R=65535&(T=w=65535&R|N<<16),N=T>>>16,I=65535&(A=_=65535&I|(O+=I>>>16)<<16),O=A>>>16,R+=65535&(T=(K>>>28|B<<4)^(B>>>2|K<<30)^(B>>>7|K<<25)),N+=T>>>16,I+=65535&(A=(B>>>28|K<<4)^(K>>>2|B<<30)^(K>>>7|B<<25)),O+=A>>>16,N+=(T=K&F^K&G^F&G)>>>16,I+=65535&(A=B&L^B&C^L&C),O+=A>>>16,h=65535&(I+=(N+=(R+=65535&T)>>>16)>>>16)|(O+=I>>>16)<<16,y=65535&R|N<<16,R=65535&(T=E),N=T>>>16,I=65535&(A=a),O=A>>>16,N+=(T=w)>>>16,I+=65535&(A=_),O+=A>>>16,L=i,C=o,P=s,D=a=65535&(I+=(N+=(R+=65535&T)>>>16)>>>16)|(O+=I>>>16)<<16,H=f,x=u,M=c,B=h,F=l,G=p,q=d,X=E=65535&R|N<<16,W=g,j=m,V=v,K=y,b%16==15)for(S=0;S<16;S++)A=k[S],R=65535&(T=U[S]),N=T>>>16,I=65535&A,O=A>>>16,A=k[(S+9)%16],R+=65535&(T=U[(S+9)%16]),N+=T>>>16,I+=65535&A,O+=A>>>16,_=k[(S+1)%16],R+=65535&(T=((w=U[(S+1)%16])>>>1|_<<31)^(w>>>8|_<<24)^(w>>>7|_<<25)),N+=T>>>16,I+=65535&(A=(_>>>1|w<<31)^(_>>>8|w<<24)^_>>>7),O+=A>>>16,_=k[(S+14)%16],N+=(T=((w=U[(S+14)%16])>>>19|_<<13)^(_>>>29|w<<3)^(w>>>6|_<<26))>>>16,I+=65535&(A=(_>>>19|w<<13)^(w>>>29|_<<3)^_>>>6),O+=A>>>16,O+=(I+=(N+=(R+=65535&T)>>>16)>>>16)>>>16,k[S]=65535&I|O<<16,U[S]=65535&R|N<<16;R=65535&(T=K),N=T>>>16,I=65535&(A=B),O=A>>>16,A=e[0],N+=(T=t[0])>>>16,I+=65535&A,O+=A>>>16,O+=(I+=(N+=(R+=65535&T)>>>16)>>>16)>>>16,e[0]=B=65535&I|O<<16,t[0]=K=65535&R|N<<16,R=65535&(T=F),N=T>>>16,I=65535&(A=L),O=A>>>16,A=e[1],N+=(T=t[1])>>>16,I+=65535&A,O+=A>>>16,O+=(I+=(N+=(R+=65535&T)>>>16)>>>16)>>>16,e[1]=L=65535&I|O<<16,t[1]=F=65535&R|N<<16,R=65535&(T=G),N=T>>>16,I=65535&(A=C),O=A>>>16,A=e[2],N+=(T=t[2])>>>16,I+=65535&A,O+=A>>>16,O+=(I+=(N+=(R+=65535&T)>>>16)>>>16)>>>16,e[2]=C=65535&I|O<<16,t[2]=G=65535&R|N<<16,R=65535&(T=q),N=T>>>16,I=65535&(A=P),O=A>>>16,A=e[3],N+=(T=t[3])>>>16,I+=65535&A,O+=A>>>16,O+=(I+=(N+=(R+=65535&T)>>>16)>>>16)>>>16,e[3]=P=65535&I|O<<16,t[3]=q=65535&R|N<<16,R=65535&(T=X),N=T>>>16,I=65535&(A=D),O=A>>>16,A=e[4],N+=(T=t[4])>>>16,I+=65535&A,O+=A>>>16,O+=(I+=(N+=(R+=65535&T)>>>16)>>>16)>>>16,e[4]=D=65535&I|O<<16,t[4]=X=65535&R|N<<16,R=65535&(T=W),N=T>>>16,I=65535&(A=H),O=A>>>16,A=e[5],N+=(T=t[5])>>>16,I+=65535&A,O+=A>>>16,O+=(I+=(N+=(R+=65535&T)>>>16)>>>16)>>>16,e[5]=H=65535&I|O<<16,t[5]=W=65535&R|N<<16,R=65535&(T=j),N=T>>>16,I=65535&(A=x),O=A>>>16,A=e[6],N+=(T=t[6])>>>16,I+=65535&A,O+=A>>>16,O+=(I+=(N+=(R+=65535&T)>>>16)>>>16)>>>16,e[6]=x=65535&I|O<<16,t[6]=j=65535&R|N<<16,R=65535&(T=V),N=T>>>16,I=65535&(A=M),O=A>>>16,A=e[7],N+=(T=t[7])>>>16,I+=65535&A,O+=A>>>16,O+=(I+=(N+=(R+=65535&T)>>>16)>>>16)>>>16,e[7]=M=65535&I|O<<16,t[7]=V=65535&R|N<<16,Q+=128,n-=128}return n}function z(e,t,r){var n,i=new Int32Array(8),o=new Int32Array(8),s=new Uint8Array(256),a=r;for(i[0]=1779033703,i[1]=3144134277,i[2]=1013904242,i[3]=2773480762,i[4]=1359893119,i[5]=2600822924,i[6]=528734635,i[7]=1541459225,o[0]=4089235720,o[1]=2227873595,o[2]=4271175723,o[3]=1595750129,o[4]=2917565137,o[5]=725511199,o[6]=4215389547,o[7]=327033209,Q(i,o,t,r),r%=128,n=0;n<r;n++)s[n]=t[a-r+n];for(s[r]=128,s[(r=256-128*(r<112?1:0))-9]=0,d(s,r-8,a/536870912|0,a<<3),Q(i,o,s,r),n=0;n<8;n++)d(e,8*n,i[n],o[n]);return 0}function $(e,r){var n=t(),i=t(),o=t(),s=t(),a=t(),f=t(),u=t(),h=t(),l=t();x(n,e[1],e[0]),x(l,r[1],r[0]),M(n,n,l),H(i,e[0],e[1]),H(l,r[0],r[1]),M(i,i,l),M(o,e[3],r[3]),M(o,o,c),M(s,e[2],r[2]),H(s,s,s),x(a,i,n),x(f,s,o),H(u,s,o),H(h,i,n),M(e[0],a,f),M(e[1],h,u),M(e[2],u,f),M(e[3],a,h)}function Z(e,t,r){var n;for(n=0;n<4;n++)B(e[n],t[n],r)}function J(e,r){var n=t(),i=t(),o=t();F(o,r[2]),M(n,r[0],o),M(i,r[1],o),L(e,i),e[31]^=P(n)<<7}function ee(e,t,r){var n,i;for(k(e[0],s),k(e[1],a),k(e[2],a),k(e[3],s),i=255;i>=0;--i)Z(e,t,n=r[i/8|0]>>(7&i)&1),$(t,e),$(e,e),Z(e,t,n)}function te(e,r){var n=[t(),t(),t(),t()];k(n[0],h),k(n[1],l),k(n[2],a),M(n[3],h,l),ee(e,n,r)}function re(e,r,i){var o,s=new Uint8Array(64),a=[t(),t(),t(),t()];for(i||n(r,32),z(s,r,32),s[0]&=248,s[31]&=127,s[31]|=64,te(a,s),J(e,a),o=0;o<32;o++)r[o+32]=e[o];return 0}var ne=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function ie(e,t){var r,n,i,o;for(n=63;n>=32;--n){for(r=0,i=n-32,o=n-12;i<o;++i)t[i]+=r-16*t[n]*ne[i-(n-32)],r=t[i]+128>>8,t[i]-=256*r;t[i]+=r,t[n]=0}for(r=0,i=0;i<32;i++)t[i]+=r-(t[31]>>4)*ne[i],r=t[i]>>8,t[i]&=255;for(i=0;i<32;i++)t[i]-=r*ne[i];for(n=0;n<32;n++)t[n+1]+=t[n]>>8,e[n]=255&t[n]}function oe(e){var t,r=new Float64Array(64);for(t=0;t<64;t++)r[t]=e[t];for(t=0;t<64;t++)e[t]=0;ie(e,r)}function se(e,r,n,i){var o,s,a=new Uint8Array(64),f=new Uint8Array(64),u=new Uint8Array(64),c=new Float64Array(64),h=[t(),t(),t(),t()];z(a,i,32),a[0]&=248,a[31]&=127,a[31]|=64;var l=n+64;for(o=0;o<n;o++)e[64+o]=r[o];for(o=0;o<32;o++)e[32+o]=a[32+o];for(z(u,e.subarray(32),n+32),oe(u),te(h,u),J(e,h),o=32;o<64;o++)e[o]=i[o];for(z(f,e,n+64),oe(f),o=0;o<64;o++)c[o]=0;for(o=0;o<32;o++)c[o]=u[o];for(o=0;o<32;o++)for(s=0;s<32;s++)c[o+s]+=f[o]*a[s];return ie(e.subarray(32),c),l}function ae(e,r,n,i){var o,f=new Uint8Array(32),c=new Uint8Array(64),h=[t(),t(),t(),t()],l=[t(),t(),t(),t()];if(n<64)return-1;if(function(e,r){var n=t(),i=t(),o=t(),f=t(),c=t(),h=t(),l=t();return k(e[2],a),D(e[1],r),K(o,e[1]),M(f,o,u),x(o,o,e[2]),H(f,e[2],f),K(c,f),K(h,c),M(l,h,c),M(n,l,o),M(n,n,f),function(e,r){var n,i=t();for(n=0;n<16;n++)i[n]=r[n];for(n=250;n>=0;n--)K(i,i),1!==n&&M(i,i,r);for(n=0;n<16;n++)e[n]=i[n]}(n,n),M(n,n,o),M(n,n,f),M(n,n,f),M(e[0],n,f),K(i,e[0]),M(i,i,f),C(i,o)&&M(e[0],e[0],p),K(i,e[0]),M(i,i,f),C(i,o)?-1:(P(e[0])===r[31]>>7&&x(e[0],s,e[0]),M(e[3],e[0],e[1]),0)}(l,i))return-1;for(o=0;o<n;o++)e[o]=r[o];for(o=0;o<32;o++)e[o+32]=i[o];if(z(c,e,n),oe(c),ee(h,l,c),te(l,r.subarray(32)),$(h,l),J(f,h),n-=64,m(r,0,f,0)){for(o=0;o<n;o++)e[o]=0;return-1}for(o=0;o<n;o++)e[o]=r[o+64];return n}var fe,ue=64,ce=32,he=64;function le(e,t){if(32!==e.length)throw new Error("bad key size");if(24!==t.length)throw new Error("bad nonce size")}function pe(){var e,t;for(t=0;t<arguments.length;t++)if("[object Uint8Array]"!==(e=Object.prototype.toString.call(arguments[t])))throw new TypeError("unexpected type "+e+", use Uint8Array")}function de(e){for(var t=0;t<e.length;t++)e[t]=0}e.lowlevel={crypto_core_hsalsa20:y,crypto_stream_xor:A,crypto_stream:S,crypto_stream_salsa20_xor:w,crypto_stream_salsa20:b,crypto_onetimeauth:R,crypto_onetimeauth_verify:N,crypto_verify_16:g,crypto_verify_32:m,crypto_secretbox:I,crypto_secretbox_open:O,crypto_scalarmult:G,crypto_scalarmult_base:q,crypto_box_beforenm:W,crypto_box_afternm:j,crypto_box:function(e,t,r,n,i,o){var s=new Uint8Array(32);return W(s,i,o),j(e,t,r,n,s)},crypto_box_open:function(e,t,r,n,i,o){var s=new Uint8Array(32);return W(s,i,o),V(e,t,r,n,s)},crypto_box_keypair:X,crypto_hash:z,crypto_sign:se,crypto_sign_keypair:re,crypto_sign_open:ae,crypto_secretbox_KEYBYTES:32,crypto_secretbox_NONCEBYTES:24,crypto_secretbox_ZEROBYTES:32,crypto_secretbox_BOXZEROBYTES:16,crypto_scalarmult_BYTES:32,crypto_scalarmult_SCALARBYTES:32,crypto_box_PUBLICKEYBYTES:32,crypto_box_SECRETKEYBYTES:32,crypto_box_BEFORENMBYTES:32,crypto_box_NONCEBYTES:24,crypto_box_ZEROBYTES:32,crypto_box_BOXZEROBYTES:16,crypto_sign_BYTES:ue,crypto_sign_PUBLICKEYBYTES:ce,crypto_sign_SECRETKEYBYTES:he,crypto_sign_SEEDBYTES:32,crypto_hash_BYTES:64},e.util||(e.util={},e.util.decodeUTF8=e.util.encodeUTF8=e.util.encodeBase64=e.util.decodeBase64=function(){throw new Error("nacl.util moved into separate package: https://github.com/dchest/tweetnacl-util-js")}),e.randomBytes=function(e){var t=new Uint8Array(e);return n(t,e),t},e.secretbox=function(e,t,r){pe(e,t,r),le(r,t);for(var n=new Uint8Array(32+e.length),i=new Uint8Array(n.length),o=0;o<e.length;o++)n[o+32]=e[o];return I(i,n,n.length,t,r),i.subarray(16)},e.secretbox.open=function(e,t,r){pe(e,t,r),le(r,t);for(var n=new Uint8Array(16+e.length),i=new Uint8Array(n.length),o=0;o<e.length;o++)n[o+16]=e[o];return!(n.length<32)&&0===O(i,n,n.length,t,r)&&i.subarray(32)},e.secretbox.keyLength=32,e.secretbox.nonceLength=24,e.secretbox.overheadLength=16,e.scalarMult=function(e,t){if(pe(e,t),32!==e.length)throw new Error("bad n size");if(32!==t.length)throw new Error("bad p size");var r=new Uint8Array(32);return G(r,e,t),r},e.scalarMult.base=function(e){if(pe(e),32!==e.length)throw new Error("bad n size");var t=new Uint8Array(32);return q(t,e),t},e.scalarMult.scalarLength=32,e.scalarMult.groupElementLength=32,e.box=function(t,r,n,i){var o=e.box.before(n,i);return e.secretbox(t,r,o)},e.box.before=function(e,t){pe(e,t),function(e,t){if(32!==e.length)throw new Error("bad public key size");if(32!==t.length)throw new Error("bad secret key size")}(e,t);var r=new Uint8Array(32);return W(r,e,t),r},e.box.after=e.secretbox,e.box.open=function(t,r,n,i){var o=e.box.before(n,i);return e.secretbox.open(t,r,o)},e.box.open.after=e.secretbox.open,e.box.keyPair=function(){var e=new Uint8Array(32),t=new Uint8Array(32);return X(e,t),{publicKey:e,secretKey:t}},e.box.keyPair.fromSecretKey=function(e){if(pe(e),32!==e.length)throw new Error("bad secret key size");var t=new Uint8Array(32);return q(t,e),{publicKey:t,secretKey:new Uint8Array(e)}},e.box.publicKeyLength=32,e.box.secretKeyLength=32,e.box.sharedKeyLength=32,e.box.nonceLength=24,e.box.overheadLength=e.secretbox.overheadLength,e.sign=function(e,t){if(pe(e,t),t.length!==he)throw new Error("bad secret key size");var r=new Uint8Array(ue+e.length);return se(r,e,e.length,t),r},e.sign.open=function(e,t){if(2!==arguments.length)throw new Error("nacl.sign.open accepts 2 arguments; did you mean to use nacl.sign.detached.verify?");if(pe(e,t),t.length!==ce)throw new Error("bad public key size");var r=new Uint8Array(e.length),n=ae(r,e,e.length,t);if(n<0)return null;for(var i=new Uint8Array(n),o=0;o<i.length;o++)i[o]=r[o];return i},e.sign.detached=function(t,r){for(var n=e.sign(t,r),i=new Uint8Array(ue),o=0;o<i.length;o++)i[o]=n[o];return i},e.sign.detached.verify=function(e,t,r){if(pe(e,t,r),t.length!==ue)throw new Error("bad signature size");if(r.length!==ce)throw new Error("bad public key size");var n,i=new Uint8Array(ue+e.length),o=new Uint8Array(ue+e.length);for(n=0;n<ue;n++)i[n]=t[n];for(n=0;n<e.length;n++)i[n+ue]=e[n];return ae(o,i,i.length,r)>=0},e.sign.keyPair=function(){var e=new Uint8Array(ce),t=new Uint8Array(he);return re(e,t),{publicKey:e,secretKey:t}},e.sign.keyPair.fromSecretKey=function(e){if(pe(e),e.length!==he)throw new Error("bad secret key size");for(var t=new Uint8Array(ce),r=0;r<t.length;r++)t[r]=e[32+r];return{publicKey:t,secretKey:new Uint8Array(e)}},e.sign.keyPair.fromSeed=function(e){if(pe(e),32!==e.length)throw new Error("bad seed size");for(var t=new Uint8Array(ce),r=new Uint8Array(he),n=0;n<32;n++)r[n]=e[n];return re(t,r,!0),{publicKey:t,secretKey:r}},e.sign.publicKeyLength=ce,e.sign.secretKeyLength=he,e.sign.seedLength=32,e.sign.signatureLength=ue,e.hash=function(e){pe(e);var t=new Uint8Array(64);return z(t,e,e.length),t},e.hash.hashLength=64,e.verify=function(e,t){return pe(e,t),0!==e.length&&0!==t.length&&e.length===t.length&&0===E(e,0,t,0,e.length)},e.setPRNG=function(e){n=e},(fe="undefined"!=typeof self?self.crypto||self.msCrypto:null)&&fe.getRandomValues?e.setPRNG((function(e,t){var r,n=new Uint8Array(t);for(r=0;r<t;r+=65536)fe.getRandomValues(n.subarray(r,r+Math.min(t-r,65536)));for(r=0;r<t;r++)e[r]=n[r];de(n)})):(fe=r(5024))&&fe.randomBytes&&e.setPRNG((function(e,t){var r,n=fe.randomBytes(t);for(r=0;r<t;r++)e[r]=n[r];de(n)}))}(e.exports?e.exports:self.nacl=self.nacl||{})},3015:()=>{},6917:()=>{},6190:()=>{},2137:()=>{},1247:()=>{},7276:()=>{},1377:()=>{},527:()=>{},5046:()=>{},8086:()=>{},4029:()=>{},3854:()=>{},2276:()=>{},7473:()=>{},6663:()=>{},9998:()=>{},1784:()=>{},1422:()=>{},8021:()=>{},4507:()=>{},9946:()=>{},9997:()=>{},6577:()=>{},4959:()=>{},8373:()=>{},1409:()=>{},5584:()=>{},5170:()=>{},5404:()=>{},7926:()=>{},5024:()=>{},7351:()=>{},3606:()=>{}},t={};!function r(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={exports:{}};return e[n].call(o.exports,o,o.exports,r),o.exports}(3607)})();